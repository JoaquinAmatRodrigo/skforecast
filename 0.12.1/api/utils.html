
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Python library that eases using scikit-learn regressors as multi-step forecasters. It also works with any regressor compatible with the scikit-learn API (XGBoost, LightGBM, Ranger...).">
      
      
        <meta name="author" content="Joaquin Amat Rodrigo and Javier Escobar Ortiz">
      
      
        <link rel="canonical" href="https://joaquinamatrodrigo.github.io/skforecast/0.12.1/api/utils.html">
      
      
        <link rel="prev" href="plot.html">
      
      
        <link rel="next" href="datasets.html">
      
      
      <link rel="icon" href="../img/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.9">
    
    
      
        <title>utils - Skforecast Docs</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.78cf6014.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.356b1318.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,700,700i%7CUbuntu+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Open Sans";--md-code-font:"Ubuntu Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-GR8X9Z9LKL"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-GR8X9Z9LKL",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-GR8X9Z9LKL",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>
  
    <script>var consent;"undefined"==typeof __md_analytics||(consent=__md_get("__consent"))&&consent.analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="light" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#utils" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
  You're not viewing the latest version.
  <a href="../..">
    <strong>Click here to go to latest.</strong>
  </a>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),outdated=__md_get("__outdated",sessionStorage);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Skforecast Docs" class="md-header__button md-logo" aria-label="Skforecast Docs" data-md-component="logo">
      
  <img src="../img/logo-skforecast-orange-no-backgound.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Skforecast Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              utils
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="light" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/JoaquinAmatRodrigo/skforecast" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../index.html" class="md-tabs__link">
          
  
  Home

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../introduction-forecasting/introduction-forecasting.html" class="md-tabs__link">
          
  
  Introduction to forecasting

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../quick-start/quick-start-skforecast.html" class="md-tabs__link">
          
  
  Quick start

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../user_guides/user-guides.html" class="md-tabs__link">
          
  
  User Guides

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../examples/examples.html" class="md-tabs__link">
          
  
  Examples and tutorials

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="ForecasterAutoreg.html" class="md-tabs__link">
          
  
  API Reference

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../faq/faq.html" class="md-tabs__link">
          
  
  FAQ and Tips

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../releases/releases.html" class="md-tabs__link">
        
  
    
  
  Releases

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../authors/authors.html" class="md-tabs__link">
        
  
    
  
  Authors

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Skforecast Docs" class="md-nav__button md-logo" aria-label="Skforecast Docs" data-md-component="logo">
      
  <img src="../img/logo-skforecast-orange-no-backgound.png" alt="logo">

    </a>
    Skforecast Docs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/JoaquinAmatRodrigo/skforecast" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Home
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Home
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome to skforecast
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../introduction-forecasting/introduction-forecasting.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction to forecasting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../quick-start/quick-start-skforecast.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quick start
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/user-guides.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    User Guides
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../examples/examples.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Examples and tutorials
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterAutoreg.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../faq/faq.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FAQ and Tips
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../releases/releases.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Releases
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Introduction to forecasting
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Introduction to forecasting
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../introduction-forecasting/introduction-forecasting.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction to forecasting
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Quick start
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Quick start
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../quick-start/quick-start-skforecast.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quick start
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../quick-start/forecaster-parameters.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Forecaster Parameters
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../quick-start/forecaster-attributes.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Forecaster Attributes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../quick-start/how-to-install.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to install
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    User Guides
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            User Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/user-guides.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Table of contents
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/input-data.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Input data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/autoregresive-forecaster.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Recursive multi-step forecasting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/direct-multi-step-forecasting.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Direct multi-step forecasting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/independent-multi-time-series-forecasting.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Global Models : Independent multi-time series forecasting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/multi-series-with-different-length-and-different_exog.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Global Models : Series with different lengths and different exogenous variables
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/dependent-multi-series-multivariate-forecasting.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Global Models : Dependent multivariate series forecasting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/forecasting-with-deep-learning-rnn-lstm.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deep learning Recurrent Neural Networks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/forecasting-sarimax-arima.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ARIMA and SARIMAX forecasting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/forecasting-baseline.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Foreasting baseline
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/exogenous-variables.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Exogenous variables
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/custom-predictors.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Custom predictors
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/weighted-time-series-forecasting.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Weighted time series forecasting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/backtesting.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Backtesting forecaster
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/hyperparameter-tuning-and-lags-selection.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hyperparameter tuning and lags selection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/sklearn-transformers-and-pipeline.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Scikit-learn Transformers and Pipelines
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/probabilistic-forecasting.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Probabilistic forecasting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/categorical-features.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Categorical features
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/calendar-features.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Calendars features
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/feature-selection.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Feature selection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/forecasting-xgboost-lightgbm.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Forecasting with XGBoost and LightGBM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/forecaster-in-production.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Forecaster in production
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/save-load-forecaster.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Save and load forecaster
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/explainability.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Explainability
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/skforecast-in-GPU.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Skforecast in GPU
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/plot-forecaster-residuals.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Plot forecaster residuals
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/datasets.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Datasets
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Examples and tutorials
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Examples and tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../examples/examples.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Examples and tutorials
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterAutoreg.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ForecasterAutoreg
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterAutoregCustom.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ForecasterAutoregCustom
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterAutoregDirect.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ForecasterAutoregDirect
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterMultiSeries.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ForecasterMultiSeries
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterMultiSeriesCustom.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ForecasterMultiSeriesCustom
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterMultiVariate.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ForecasterMultiVariate
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterRnn.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ForecasterRnn
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterSarimax.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ForecasterSarimax
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="Sarimax.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sarimax
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterBaseline.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ForecasterBaseline
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="model_selection.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    model_selection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="model_selection_multiseries.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    model_selection_multiseries
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="model_selection_sarimax.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    model_selection_sarimax
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="preprocessing.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    preprocessing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="plot.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    plot
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    utils
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="utils.html" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    utils
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.save_forecaster" class="md-nav__link">
    <span class="md-ellipsis">
      save_forecaster()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.load_forecaster" class="md-nav__link">
    <span class="md-ellipsis">
      load_forecaster()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.initialize_lags" class="md-nav__link">
    <span class="md-ellipsis">
      initialize_lags()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.initialize_weights" class="md-nav__link">
    <span class="md-ellipsis">
      initialize_weights()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.initialize_transformer_series" class="md-nav__link">
    <span class="md-ellipsis">
      initialize_transformer_series()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.initialize_lags_grid" class="md-nav__link">
    <span class="md-ellipsis">
      initialize_lags_grid()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_select_fit_kwargs" class="md-nav__link">
    <span class="md-ellipsis">
      check_select_fit_kwargs()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_y" class="md-nav__link">
    <span class="md-ellipsis">
      check_y()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_exog" class="md-nav__link">
    <span class="md-ellipsis">
      check_exog()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.get_exog_dtypes" class="md-nav__link">
    <span class="md-ellipsis">
      get_exog_dtypes()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_exog_dtypes" class="md-nav__link">
    <span class="md-ellipsis">
      check_exog_dtypes()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_interval" class="md-nav__link">
    <span class="md-ellipsis">
      check_interval()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_predict_input" class="md-nav__link">
    <span class="md-ellipsis">
      check_predict_input()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.preprocess_y" class="md-nav__link">
    <span class="md-ellipsis">
      preprocess_y()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.preprocess_last_window" class="md-nav__link">
    <span class="md-ellipsis">
      preprocess_last_window()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.preprocess_exog" class="md-nav__link">
    <span class="md-ellipsis">
      preprocess_exog()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.cast_exog_dtypes" class="md-nav__link">
    <span class="md-ellipsis">
      cast_exog_dtypes()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.exog_to_direct" class="md-nav__link">
    <span class="md-ellipsis">
      exog_to_direct()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.exog_to_direct_numpy" class="md-nav__link">
    <span class="md-ellipsis">
      exog_to_direct_numpy()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.expand_index" class="md-nav__link">
    <span class="md-ellipsis">
      expand_index()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.transform_series" class="md-nav__link">
    <span class="md-ellipsis">
      transform_series()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.transform_dataframe" class="md-nav__link">
    <span class="md-ellipsis">
      transform_dataframe()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_optional_dependency" class="md-nav__link">
    <span class="md-ellipsis">
      check_optional_dependency()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.multivariate_time_series_corr" class="md-nav__link">
    <span class="md-ellipsis">
      multivariate_time_series_corr()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_backtesting_input" class="md-nav__link">
    <span class="md-ellipsis">
      check_backtesting_input()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.select_n_jobs_backtesting" class="md-nav__link">
    <span class="md-ellipsis">
      select_n_jobs_backtesting()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.select_n_jobs_fit_forecaster" class="md-nav__link">
    <span class="md-ellipsis">
      select_n_jobs_fit_forecaster()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_preprocess_series" class="md-nav__link">
    <span class="md-ellipsis">
      check_preprocess_series()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_preprocess_exog_multiseries" class="md-nav__link">
    <span class="md-ellipsis">
      check_preprocess_exog_multiseries()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.align_series_and_exog_multiseries" class="md-nav__link">
    <span class="md-ellipsis">
      align_series_and_exog_multiseries()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.set_skforecast_warnings" class="md-nav__link">
    <span class="md-ellipsis">
      set_skforecast_warnings()
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="datasets.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    datasets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="exceptions.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    exceptions
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="">
            
  
  <span class="md-ellipsis">
    FAQ and Tips
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            FAQ and Tips
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../faq/faq.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Table of contents
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../faq/time-series-differentiation.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Time series differentiation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../faq/non-negative-predictions.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Avoid negative predictions when forecasting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../faq/forecasting-time-series-with-missing-values.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Forecasting time series with missing values
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../faq/cyclical-features-time-series.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cyclical features in time series
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../faq/stacking-ensemble-models-forecasting.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Stacking (ensemble) machine learning models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../faq/forecasting-with-delayed-historical-data.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Forecasting with delayed historical data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../faq/time-series-aggregation.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Time series aggregation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../faq/parallelization-skforecast.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parallelization in skforecast
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../faq/profiling-skforecast.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Profiling skforecast
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../releases/releases.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Releases
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../authors/authors.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Authors
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.save_forecaster" class="md-nav__link">
    <span class="md-ellipsis">
      save_forecaster()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.load_forecaster" class="md-nav__link">
    <span class="md-ellipsis">
      load_forecaster()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.initialize_lags" class="md-nav__link">
    <span class="md-ellipsis">
      initialize_lags()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.initialize_weights" class="md-nav__link">
    <span class="md-ellipsis">
      initialize_weights()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.initialize_transformer_series" class="md-nav__link">
    <span class="md-ellipsis">
      initialize_transformer_series()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.initialize_lags_grid" class="md-nav__link">
    <span class="md-ellipsis">
      initialize_lags_grid()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_select_fit_kwargs" class="md-nav__link">
    <span class="md-ellipsis">
      check_select_fit_kwargs()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_y" class="md-nav__link">
    <span class="md-ellipsis">
      check_y()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_exog" class="md-nav__link">
    <span class="md-ellipsis">
      check_exog()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.get_exog_dtypes" class="md-nav__link">
    <span class="md-ellipsis">
      get_exog_dtypes()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_exog_dtypes" class="md-nav__link">
    <span class="md-ellipsis">
      check_exog_dtypes()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_interval" class="md-nav__link">
    <span class="md-ellipsis">
      check_interval()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_predict_input" class="md-nav__link">
    <span class="md-ellipsis">
      check_predict_input()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.preprocess_y" class="md-nav__link">
    <span class="md-ellipsis">
      preprocess_y()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.preprocess_last_window" class="md-nav__link">
    <span class="md-ellipsis">
      preprocess_last_window()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.preprocess_exog" class="md-nav__link">
    <span class="md-ellipsis">
      preprocess_exog()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.cast_exog_dtypes" class="md-nav__link">
    <span class="md-ellipsis">
      cast_exog_dtypes()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.exog_to_direct" class="md-nav__link">
    <span class="md-ellipsis">
      exog_to_direct()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.exog_to_direct_numpy" class="md-nav__link">
    <span class="md-ellipsis">
      exog_to_direct_numpy()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.expand_index" class="md-nav__link">
    <span class="md-ellipsis">
      expand_index()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.transform_series" class="md-nav__link">
    <span class="md-ellipsis">
      transform_series()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.transform_dataframe" class="md-nav__link">
    <span class="md-ellipsis">
      transform_dataframe()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_optional_dependency" class="md-nav__link">
    <span class="md-ellipsis">
      check_optional_dependency()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.multivariate_time_series_corr" class="md-nav__link">
    <span class="md-ellipsis">
      multivariate_time_series_corr()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_backtesting_input" class="md-nav__link">
    <span class="md-ellipsis">
      check_backtesting_input()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.select_n_jobs_backtesting" class="md-nav__link">
    <span class="md-ellipsis">
      select_n_jobs_backtesting()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.select_n_jobs_fit_forecaster" class="md-nav__link">
    <span class="md-ellipsis">
      select_n_jobs_fit_forecaster()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_preprocess_series" class="md-nav__link">
    <span class="md-ellipsis">
      check_preprocess_series()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.check_preprocess_exog_multiseries" class="md-nav__link">
    <span class="md-ellipsis">
      check_preprocess_exog_multiseries()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.align_series_and_exog_multiseries" class="md-nav__link">
    <span class="md-ellipsis">
      align_series_and_exog_multiseries()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.utils.utils.set_skforecast_warnings" class="md-nav__link">
    <span class="md-ellipsis">
      set_skforecast_warnings()
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="utils"><code>utils</code><a class="headerlink" href="#utils" title="Permanent link">&para;</a></h1>



<div class="doc doc-object doc-function">




<h2 id="skforecast.utils.utils.save_forecaster" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">save_forecaster</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">file_name</span><span class="p">,</span> <span class="n">save_custom_functions</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#skforecast.utils.utils.save_forecaster" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents first">
  
      <p>Save forecaster model using joblib. If custom functions are used to create
predictors or weights, they are saved as .py files.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>forecaster</code></td>
          <td>
                <code>Forecaster</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Forecaster created with skforecast library.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>file_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>File name given to the object.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>save_custom_functions</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If True, save custom functions used in the forecaster (fun_predictors and
weight_func) as .py files. Custom functions need to be available in the
environment where the forecaster is going to be loaded.</p>
            </div>
          </td>
          <td>
                <code>`True`</code>
          </td>
        </tr>
        <tr>
          <td><code>verbose</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Print summary about the forecaster saved.</p>
            </div>
          </td>
          <td>
                <code>`True`</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>None</code>
          </td>
          <td>
            <div class="doc-md-description">
              
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>skforecast\utils\utils.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">save_forecaster</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span> 
    <span class="n">file_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">save_custom_functions</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Save forecaster model using joblib. If custom functions are used to create</span>
<span class="sd">    predictors or weights, they are saved as .py files.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    forecaster : Forecaster</span>
<span class="sd">        Forecaster created with skforecast library.</span>
<span class="sd">    file_name : str</span>
<span class="sd">        File name given to the object.</span>
<span class="sd">    save_custom_functions : bool, default `True`</span>
<span class="sd">        If True, save custom functions used in the forecaster (fun_predictors and</span>
<span class="sd">        weight_func) as .py files. Custom functions need to be available in the</span>
<span class="sd">        environment where the forecaster is going to be loaded.</span>
<span class="sd">    verbose : bool, default `True`</span>
<span class="sd">        Print summary about the forecaster saved.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Save forecaster</span>
    <span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">file_name</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">save_custom_functions</span><span class="p">:</span>
        <span class="c1"># Save custom functions to create predictors</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="s1">&#39;fun_predictors&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">fun_predictors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">file_name</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">fun_predictors</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="s1">&#39;.py&#39;</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
                <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">getsource</span><span class="p">(</span><span class="n">forecaster</span><span class="o">.</span><span class="n">fun_predictors</span><span class="p">))</span>

        <span class="c1"># Save custom functions to create weights</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="s1">&#39;weight_func&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">weight_func</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">forecaster</span><span class="o">.</span><span class="n">weight_func</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">fun</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">forecaster</span><span class="o">.</span><span class="n">weight_func</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
                    <span class="n">file_name</span> <span class="o">=</span> <span class="n">fun</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="s1">&#39;.py&#39;</span>
                    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
                        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">getsource</span><span class="p">(</span><span class="n">fun</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">file_name</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">weight_func</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="s1">&#39;.py&#39;</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
                    <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">getsource</span><span class="p">(</span><span class="n">forecaster</span><span class="o">.</span><span class="n">weight_func</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">((</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="s1">&#39;fun_predictors&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">fun_predictors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span>
          <span class="ow">or</span> <span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="s1">&#39;weight_func&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">weight_func</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)):</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="p">(</span><span class="s2">&quot;Custom functions used to create predictors or weights are not saved. &quot;</span>
                 <span class="s2">&quot;To save them, set `save_custom_functions` to `True`.&quot;</span><span class="p">)</span>
            <span class="p">)</span>

    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="n">forecaster</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="skforecast.utils.utils.load_forecaster" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">load_forecaster</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#skforecast.utils.utils.load_forecaster" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents first">
  
      <p>Load forecaster model using joblib. If the forecaster was saved with custom
functions to create predictors or weights, these functions must be available
in the environment where the forecaster is going to be loaded.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>file_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Object file name.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>verbose</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Print summary about the forecaster loaded.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>forecaster</code></td>          <td>
                <code>Forecaster</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Forecaster created with skforecast library.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>skforecast\utils\utils.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">load_forecaster</span><span class="p">(</span>
    <span class="n">file_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">object</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Load forecaster model using joblib. If the forecaster was saved with custom</span>
<span class="sd">    functions to create predictors or weights, these functions must be available</span>
<span class="sd">    in the environment where the forecaster is going to be loaded.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    file_name: str</span>
<span class="sd">        Object file name.</span>
<span class="sd">    verbose: bool, default `True`</span>
<span class="sd">        Print summary about the forecaster loaded.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    forecaster: Forecaster</span>
<span class="sd">        Forecaster created with skforecast library.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">forecaster</span> <span class="o">=</span> <span class="n">joblib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">file_name</span><span class="p">)</span>

    <span class="n">skforecast_v</span> <span class="o">=</span> <span class="n">skforecast</span><span class="o">.</span><span class="n">__version__</span>
    <span class="n">forecaster_v</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">skforecast_version</span>

    <span class="k">if</span> <span class="n">forecaster_v</span> <span class="o">!=</span> <span class="n">skforecast_v</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The skforecast version installed in the environment differs &quot;</span>
             <span class="sa">f</span><span class="s2">&quot;from the version used to create the forecaster.</span><span class="se">\n</span><span class="s2">&quot;</span>
             <span class="sa">f</span><span class="s2">&quot;    Installed Version  : </span><span class="si">{</span><span class="n">skforecast_v</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
             <span class="sa">f</span><span class="s2">&quot;    Forecaster Version : </span><span class="si">{</span><span class="n">forecaster_v</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
             <span class="sa">f</span><span class="s2">&quot;This may create incompatibilities when using the library.&quot;</span><span class="p">),</span>
             <span class="n">SkforecastVersionWarning</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="n">forecaster</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">forecaster</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="skforecast.utils.utils.initialize_lags" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">initialize_lags</span><span class="p">(</span><span class="n">forecaster_name</span><span class="p">,</span> <span class="n">lags</span><span class="p">)</span></code>

<a href="#skforecast.utils.utils.initialize_lags" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents first">
  
      <p>Check lags argument input and generate the corresponding numpy ndarray.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>forecaster_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Forecaster name. ForecasterAutoreg, ForecasterAutoregCustom, 
ForecasterAutoregDirect, ForecasterAutoregMultiSeries, 
ForecasterAutoregMultiSeriesCustom, ForecasterAutoregMultiVariate.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>lags</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Lags used as predictors.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>lags</code></td>          <td>
                <code>numpy ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Lags used as predictors.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>skforecast\utils\utils.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span>
<span class="normal">98</span>
<span class="normal">99</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">initialize_lags</span><span class="p">(</span>
    <span class="n">forecaster_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">lags</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check lags argument input and generate the corresponding numpy ndarray.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    forecaster_name : str</span>
<span class="sd">        Forecaster name. ForecasterAutoreg, ForecasterAutoregCustom, </span>
<span class="sd">        ForecasterAutoregDirect, ForecasterAutoregMultiSeries, </span>
<span class="sd">        ForecasterAutoregMultiSeriesCustom, ForecasterAutoregMultiVariate.</span>
<span class="sd">    lags : Any</span>
<span class="sd">        Lags used as predictors.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    lags : numpy ndarray</span>
<span class="sd">        Lags used as predictors.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lags</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">lags</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Minimum value of lags allowed is 1.&quot;</span><span class="p">)</span>
        <span class="n">lags</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">lags</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lags</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="nb">range</span><span class="p">)):</span>
        <span class="n">lags</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">lags</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lags</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">lags</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`lags` must be a 1-dimensional array.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">lags</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Argument `lags` must contain at least one value.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">lags</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;All values in `lags` must be integers.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">lags</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Minimum value of lags allowed is 1.&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">forecaster_name</span> <span class="o">!=</span> <span class="s1">&#39;ForecasterAutoregMultiVariate&#39;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`lags` argument must be an int, 1d numpy ndarray, range, tuple or list. &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">lags</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="p">(</span><span class="s2">&quot;`lags` argument must be a dict, int, 1d numpy ndarray, range, tuple or list. &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">lags</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="p">)</span>

    <span class="k">return</span> <span class="n">lags</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="skforecast.utils.utils.initialize_weights" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">initialize_weights</span><span class="p">(</span><span class="n">forecaster_name</span><span class="p">,</span> <span class="n">regressor</span><span class="p">,</span> <span class="n">weight_func</span><span class="p">,</span> <span class="n">series_weights</span><span class="p">)</span></code>

<a href="#skforecast.utils.utils.initialize_weights" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents first">
  
      <p>Check weights arguments, <code>weight_func</code> and <code>series_weights</code> for the different 
forecasters. Create <code>source_code_weight_func</code>, source code of the custom 
function(s) used to create weights.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>forecaster_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Forecaster name. ForecasterAutoreg, ForecasterAutoregCustom, 
ForecasterAutoregDirect, ForecasterAutoregMultiSeries, 
ForecasterAutoregMultiSeriesCustom, ForecasterAutoregMultiVariate.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>regressor</code></td>
          <td>
                <code>regressor or pipeline compatible with the scikit-learn API</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Regressor of the forecaster.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>weight_func</code></td>
          <td>
                <code>(<span title="typing.Callable">Callable</span>, dict)</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Argument <code>weight_func</code> of the forecaster.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>series_weights</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Argument <code>series_weights</code> of the forecaster.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>weight_func</code></td>          <td>
                <code>(<span title="typing.Callable">Callable</span>, dict)</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Argument <code>weight_func</code> of the forecaster.</p>
            </div>
          </td>
        </tr>
        <tr>
<td><code>source_code_weight_func</code></td>          <td>
                <code>(str, dict)</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Argument <code>source_code_weight_func</code> of the forecaster.</p>
            </div>
          </td>
        </tr>
        <tr>
<td><code>series_weights</code></td>          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Argument <code>series_weights</code> of the forecaster.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>skforecast\utils\utils.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">initialize_weights</span><span class="p">(</span>
    <span class="n">forecaster_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">regressor</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
    <span class="n">weight_func</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Callable</span><span class="p">,</span> <span class="nb">dict</span><span class="p">],</span>
    <span class="n">series_weights</span><span class="p">:</span> <span class="nb">dict</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Callable</span><span class="p">,</span> <span class="nb">dict</span><span class="p">],</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">],</span> <span class="nb">dict</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check weights arguments, `weight_func` and `series_weights` for the different </span>
<span class="sd">    forecasters. Create `source_code_weight_func`, source code of the custom </span>
<span class="sd">    function(s) used to create weights.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    forecaster_name : str</span>
<span class="sd">        Forecaster name. ForecasterAutoreg, ForecasterAutoregCustom, </span>
<span class="sd">        ForecasterAutoregDirect, ForecasterAutoregMultiSeries, </span>
<span class="sd">        ForecasterAutoregMultiSeriesCustom, ForecasterAutoregMultiVariate.</span>
<span class="sd">    regressor : regressor or pipeline compatible with the scikit-learn API</span>
<span class="sd">        Regressor of the forecaster.</span>
<span class="sd">    weight_func : Callable, dict</span>
<span class="sd">        Argument `weight_func` of the forecaster.</span>
<span class="sd">    series_weights : dict</span>
<span class="sd">        Argument `series_weights` of the forecaster.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    weight_func : Callable, dict</span>
<span class="sd">        Argument `weight_func` of the forecaster.</span>
<span class="sd">    source_code_weight_func : str, dict</span>
<span class="sd">        Argument `source_code_weight_func` of the forecaster.</span>
<span class="sd">    series_weights : dict</span>
<span class="sd">        Argument `series_weights` of the forecaster.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">source_code_weight_func</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">weight_func</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ForecasterAutoregMultiSeries&#39;</span><span class="p">,</span> 
                               <span class="s1">&#39;ForecasterAutoregMultiSeriesCustom&#39;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">weight_func</span><span class="p">,</span> <span class="p">(</span><span class="n">Callable</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Argument `weight_func` must be a Callable or a dict of &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;Callables. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">weight_func</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
                <span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">weight_func</span><span class="p">,</span> <span class="n">Callable</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Argument `weight_func` must be a Callable. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">weight_func</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">weight_func</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">source_code_weight_func</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">weight_func</span><span class="p">:</span>
                <span class="n">source_code_weight_func</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getsource</span><span class="p">(</span><span class="n">weight_func</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">source_code_weight_func</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getsource</span><span class="p">(</span><span class="n">weight_func</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;sample_weight&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">regressor</span><span class="o">.</span><span class="n">fit</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Argument `weight_func` is ignored since regressor </span><span class="si">{</span><span class="n">regressor</span><span class="si">}</span><span class="s2"> &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;does not accept `sample_weight` in its `fit` method.&quot;</span><span class="p">),</span>
                 <span class="n">IgnoredArgumentWarning</span>
            <span class="p">)</span>
            <span class="n">weight_func</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">source_code_weight_func</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">series_weights</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">series_weights</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Argument `series_weights` must be a dict of floats or ints.&quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">series_weights</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;sample_weight&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">regressor</span><span class="o">.</span><span class="n">fit</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Argument `series_weights` is ignored since regressor </span><span class="si">{</span><span class="n">regressor</span><span class="si">}</span><span class="s2"> &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;does not accept `sample_weight` in its `fit` method.&quot;</span><span class="p">),</span>
                 <span class="n">IgnoredArgumentWarning</span>
            <span class="p">)</span>
            <span class="n">series_weights</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">weight_func</span><span class="p">,</span> <span class="n">source_code_weight_func</span><span class="p">,</span> <span class="n">series_weights</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="skforecast.utils.utils.initialize_transformer_series" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">initialize_transformer_series</span><span class="p">(</span><span class="n">series_col_names</span><span class="p">,</span> <span class="n">transformer_series</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#skforecast.utils.utils.initialize_transformer_series" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents first">
  
      <p>Initialize <code>transformer_series_</code> attribute for the Forecasters Multiseries.</p>
<ul>
<li>If <code>transformer_series</code> is <code>None</code>, no transformation is applied.</li>
<li>If <code>transformer_series</code> is a scikit-learn transformer (object), the same 
transformer is applied to all series (<code>series_col_names</code>).</li>
<li>If <code>transformer_series</code> is a <code>dict</code>, a different transformer can be
applied to each series. The keys of the dictionary must be the same as the
names of the series in <code>series_col_names</code>.</li>
</ul>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>series_col_names</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Names of the series (levels) used during training.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>transformer_series</code></td>
          <td>
                <code>(object, dict)</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An instance of a transformer (preprocessor) compatible with the scikit-learn
preprocessing API with methods: fit, transform, fit_transform and 
inverse_transform.</p>
            </div>
          </td>
          <td>
                <code>`None`</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>transformer_series_</code></td>          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with the transformer for each series. It is created cloning the 
objects in <code>transformer_series</code> and is used internally to avoid overwriting.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>skforecast\utils\utils.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">initialize_transformer_series</span><span class="p">(</span>
    <span class="n">series_col_names</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
    <span class="n">transformer_series</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">object</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]]</span><span class="o">=</span><span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize `transformer_series_` attribute for the Forecasters Multiseries.</span>

<span class="sd">    - If `transformer_series` is `None`, no transformation is applied.</span>
<span class="sd">    - If `transformer_series` is a scikit-learn transformer (object), the same </span>
<span class="sd">    transformer is applied to all series (`series_col_names`).</span>
<span class="sd">    - If `transformer_series` is a `dict`, a different transformer can be</span>
<span class="sd">    applied to each series. The keys of the dictionary must be the same as the</span>
<span class="sd">    names of the series in `series_col_names`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    series_col_names : list</span>
<span class="sd">        Names of the series (levels) used during training.</span>
<span class="sd">    transformer_series : object, dict, default `None`</span>
<span class="sd">        An instance of a transformer (preprocessor) compatible with the scikit-learn</span>
<span class="sd">        preprocessing API with methods: fit, transform, fit_transform and </span>
<span class="sd">        inverse_transform. </span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    transformer_series_ : dict</span>
<span class="sd">        Dictionary with the transformer for each series. It is created cloning the </span>
<span class="sd">        objects in `transformer_series` and is used internally to avoid overwriting.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">transformer_series</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">transformer_series_</span> <span class="o">=</span> <span class="p">{</span><span class="n">serie</span><span class="p">:</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">serie</span> <span class="ow">in</span> <span class="n">series_col_names</span><span class="p">}</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">transformer_series</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">transformer_series_</span> <span class="o">=</span> <span class="p">{</span><span class="n">serie</span><span class="p">:</span> <span class="n">clone</span><span class="p">(</span><span class="n">transformer_series</span><span class="p">)</span> 
                               <span class="k">for</span> <span class="n">serie</span> <span class="ow">in</span> <span class="n">series_col_names</span><span class="p">}</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">transformer_series_</span> <span class="o">=</span> <span class="p">{</span><span class="n">serie</span><span class="p">:</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">serie</span> <span class="ow">in</span> <span class="n">series_col_names</span><span class="p">}</span>
        <span class="c1"># Only elements already present in transformer_series_ are updated</span>
        <span class="n">transformer_series_</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
            <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">transformer_series</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> 
            <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">transformer_series_</span>
        <span class="p">)</span>
        <span class="n">series_not_in_transformer_series</span> <span class="o">=</span> <span class="p">(</span>
            <span class="nb">set</span><span class="p">(</span><span class="n">series_col_names</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">transformer_series</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">series_not_in_transformer_series</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">series_not_in_transformer_series</span><span class="si">}</span><span class="s2"> not present in `transformer_series`.&quot;</span>
                 <span class="sa">f</span><span class="s2">&quot; No transformation is applied to these series.&quot;</span><span class="p">),</span>
                 <span class="n">IgnoredArgumentWarning</span>
            <span class="p">)</span>

    <span class="k">return</span> <span class="n">transformer_series_</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="skforecast.utils.utils.initialize_lags_grid" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">initialize_lags_grid</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">lags_grid</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#skforecast.utils.utils.initialize_lags_grid" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents first">
  
      <p>Initialize lags grid and lags label for model selection. </p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>forecaster</code></td>
          <td>
                <code>Forecaster</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Forecaster model. ForecasterAutoreg, ForecasterAutoregCustom, 
ForecasterAutoregDirect, ForecasterAutoregMultiSeries, 
ForecasterAutoregMultiSeriesCustom, ForecasterAutoregMultiVariate.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>lags_grid</code></td>
          <td>
                <code>(list, dict)</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Lists of lags to try, containing int, lists, numpy ndarray, or range 
objects. If <code>dict</code>, the keys are used as labels in the <code>results</code> 
DataFrame, and the values are used as the lists of lags to try. Ignored 
if the forecaster is an instance of <code>ForecasterAutoregCustom</code> or 
<code>ForecasterAutoregMultiSeriesCustom</code>.</p>
            </div>
          </td>
          <td>
                <code>`None`</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>lags_grid</code></td>          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with lags configuration for each iteration.</p>
            </div>
          </td>
        </tr>
        <tr>
<td><code>lags_label</code></td>          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Label for lags representation in the results object.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>skforecast\utils\utils.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">initialize_lags_grid</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span> 
    <span class="n">lags_grid</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]]</span><span class="o">=</span><span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">dict</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize lags grid and lags label for model selection. </span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    forecaster : Forecaster</span>
<span class="sd">        Forecaster model. ForecasterAutoreg, ForecasterAutoregCustom, </span>
<span class="sd">        ForecasterAutoregDirect, ForecasterAutoregMultiSeries, </span>
<span class="sd">        ForecasterAutoregMultiSeriesCustom, ForecasterAutoregMultiVariate.</span>
<span class="sd">    lags_grid : list, dict, default `None`</span>
<span class="sd">        Lists of lags to try, containing int, lists, numpy ndarray, or range </span>
<span class="sd">        objects. If `dict`, the keys are used as labels in the `results` </span>
<span class="sd">        DataFrame, and the values are used as the lists of lags to try. Ignored </span>
<span class="sd">        if the forecaster is an instance of `ForecasterAutoregCustom` or </span>
<span class="sd">        `ForecasterAutoregMultiSeriesCustom`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    lags_grid : dict</span>
<span class="sd">        Dictionary with lags configuration for each iteration.</span>
<span class="sd">    lags_label : str</span>
<span class="sd">        Label for lags representation in the results object.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lags_grid</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`lags_grid` argument must be a list, dict or None. &quot;</span>
             <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">lags_grid</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">forecaster</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ForecasterAutoregCustom&#39;</span><span class="p">,</span> 
                                     <span class="s1">&#39;ForecasterAutoregMultiSeriesCustom&#39;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">lags_grid</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`lags_grid` ignored if forecaster is an instance of &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;`</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">forecaster</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">`.&quot;</span><span class="p">),</span>
                <span class="n">IgnoredArgumentWarning</span>
            <span class="p">)</span>
        <span class="n">lags_grid</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;custom predictors&#39;</span><span class="p">]</span>

    <span class="n">lags_label</span> <span class="o">=</span> <span class="s1">&#39;values&#39;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lags_grid</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">lags_grid</span> <span class="o">=</span> <span class="p">{</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">lags</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">:</span> <span class="n">lags</span> <span class="k">for</span> <span class="n">lags</span> <span class="ow">in</span> <span class="n">lags_grid</span><span class="p">}</span>
    <span class="k">elif</span> <span class="n">lags_grid</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">lags_grid</span> <span class="o">=</span> <span class="p">{</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">forecaster</span><span class="o">.</span><span class="n">lags</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">forecaster</span><span class="o">.</span><span class="n">lags</span><span class="p">)}</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">lags_label</span> <span class="o">=</span> <span class="s1">&#39;keys&#39;</span>

    <span class="k">return</span> <span class="n">lags_grid</span><span class="p">,</span> <span class="n">lags_label</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="skforecast.utils.utils.check_select_fit_kwargs" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">check_select_fit_kwargs</span><span class="p">(</span><span class="n">regressor</span><span class="p">,</span> <span class="n">fit_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#skforecast.utils.utils.check_select_fit_kwargs" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents first">
  
      <p>Check if <code>fit_kwargs</code> is a dict and select only the keys that are used by
the <code>fit</code> method of the regressor.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>regressor</code></td>
          <td>
                <code>object</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Regressor object.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>fit_kwargs</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with the arguments to pass to the `fit' method of the forecaster.</p>
            </div>
          </td>
          <td>
                <code>`None`</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>fit_kwargs</code></td>          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with the arguments to be passed to the <code>fit</code> method of the 
regressor after removing the unused keys.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>skforecast\utils\utils.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">check_select_fit_kwargs</span><span class="p">(</span>
    <span class="n">regressor</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
    <span class="n">fit_kwargs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check if `fit_kwargs` is a dict and select only the keys that are used by</span>
<span class="sd">    the `fit` method of the regressor.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    regressor : object</span>
<span class="sd">        Regressor object.</span>
<span class="sd">    fit_kwargs : dict, default `None`</span>
<span class="sd">        Dictionary with the arguments to pass to the `fit&#39; method of the forecaster.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fit_kwargs : dict</span>
<span class="sd">        Dictionary with the arguments to be passed to the `fit` method of the </span>
<span class="sd">        regressor after removing the unused keys.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">fit_kwargs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fit_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fit_kwargs</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Argument `fit_kwargs` must be a dict. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">fit_kwargs</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>

        <span class="c1"># Non used keys</span>
        <span class="n">non_used_keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">fit_kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
                         <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">regressor</span><span class="o">.</span><span class="n">fit</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">non_used_keys</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Argument/s </span><span class="si">{</span><span class="n">non_used_keys</span><span class="si">}</span><span class="s2"> ignored since they are not used by the &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;regressor&#39;s `fit` method.&quot;</span><span class="p">),</span>
                 <span class="n">IgnoredArgumentWarning</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;sample_weight&#39;</span> <span class="ow">in</span> <span class="n">fit_kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="p">(</span><span class="s2">&quot;The `sample_weight` argument is ignored. Use `weight_func` to pass &quot;</span>
                 <span class="s2">&quot;a function that defines the individual weights for each sample &quot;</span>
                 <span class="s2">&quot;based on its index.&quot;</span><span class="p">),</span>
                 <span class="n">IgnoredArgumentWarning</span>
            <span class="p">)</span>
            <span class="k">del</span> <span class="n">fit_kwargs</span><span class="p">[</span><span class="s1">&#39;sample_weight&#39;</span><span class="p">]</span>

        <span class="c1"># Select only the keyword arguments allowed by the regressor&#39;s `fit` method.</span>
        <span class="n">fit_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span><span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">fit_kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                      <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">regressor</span><span class="o">.</span><span class="n">fit</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span><span class="p">}</span>

    <span class="k">return</span> <span class="n">fit_kwargs</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="skforecast.utils.utils.check_y" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">check_y</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">series_id</span><span class="o">=</span><span class="s1">&#39;`y`&#39;</span><span class="p">)</span></code>

<a href="#skforecast.utils.utils.check_y" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents first">
  
      <p>Raise Exception if <code>y</code> is not pandas Series or if it has missing values.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>y</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Time series values.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>series_id</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Identifier of the series used in the warning message.</p>
            </div>
          </td>
          <td>
                <code>&#39;`y`&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>None</code>
          </td>
          <td>
            <div class="doc-md-description">
              
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>skforecast\utils\utils.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">check_y</span><span class="p">(</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
    <span class="n">series_id</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;`y`&quot;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Raise Exception if `y` is not pandas Series or if it has missing values.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    y : Any</span>
<span class="sd">        Time series values.</span>
<span class="sd">    series_id : str, default &#39;`y`&#39;</span>
<span class="sd">        Identifier of the series used in the warning message.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">series_id</span><span class="si">}</span><span class="s2"> must be a pandas Series.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">y</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">series_id</span><span class="si">}</span><span class="s2"> has missing values.&quot;</span><span class="p">)</span>

    <span class="k">return</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="skforecast.utils.utils.check_exog" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">check_exog</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="n">allow_nan</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">series_id</span><span class="o">=</span><span class="s1">&#39;`exog`&#39;</span><span class="p">)</span></code>

<a href="#skforecast.utils.utils.check_exog" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents first">
  
      <p>Raise Exception if <code>exog</code> is not pandas Series or pandas DataFrame.
If <code>allow_nan = True</code>, issue a warning if <code>exog</code> contains NaN values.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>exog</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Exogenous variable/s included as predictor/s.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>allow_nan</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If True, allows the presence of NaN values in <code>exog</code>. If False (default),
issue a warning if <code>exog</code> contains NaN values.</p>
            </div>
          </td>
          <td>
                <code>`True`</code>
          </td>
        </tr>
        <tr>
          <td><code>series_id</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Identifier of the series for which the exogenous variable/s are used
in the warning message.</p>
            </div>
          </td>
          <td>
                <code>&#39;`exog`&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>None</code>
          </td>
          <td>
            <div class="doc-md-description">
              
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>skforecast\utils\utils.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">check_exog</span><span class="p">(</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
    <span class="n">allow_nan</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">series_id</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;`exog`&quot;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Raise Exception if `exog` is not pandas Series or pandas DataFrame.</span>
<span class="sd">    If `allow_nan = True`, issue a warning if `exog` contains NaN values.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    exog : Any</span>
<span class="sd">        Exogenous variable/s included as predictor/s.</span>
<span class="sd">    allow_nan : bool, default `True`</span>
<span class="sd">        If True, allows the presence of NaN values in `exog`. If False (default),</span>
<span class="sd">        issue a warning if `exog` contains NaN values.</span>
<span class="sd">    series_id : str, default &#39;`exog`&#39;</span>
<span class="sd">        Identifier of the series for which the exogenous variable/s are used</span>
<span class="sd">        in the warning message.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">series_id</span><span class="si">}</span><span class="s2"> must be a pandas Series or DataFrame.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="ow">and</span> <span class="n">exog</span><span class="o">.</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;When </span><span class="si">{</span><span class="n">series_id</span><span class="si">}</span><span class="s2"> is a pandas Series, it must have a name.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">allow_nan</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">exog</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">series_id</span><span class="si">}</span><span class="s2"> has missing values. Most machine learning models &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;do not allow missing values. Fitting the forecaster may fail.&quot;</span><span class="p">),</span> 
                 <span class="n">MissingValuesWarning</span>
            <span class="p">)</span>

    <span class="k">return</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="skforecast.utils.utils.get_exog_dtypes" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_exog_dtypes</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span></code>

<a href="#skforecast.utils.utils.get_exog_dtypes" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents first">
  
      <p>Store dtypes of <code>exog</code>.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>exog</code></td>
          <td>
                <code>pandas DataFrame, pandas Series</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Exogenous variable/s included as predictor/s.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>exog_dtypes</code></td>          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with the dtypes in <code>exog</code>.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>skforecast\utils\utils.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_exog_dtypes</span><span class="p">(</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Store dtypes of `exog`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    exog : pandas DataFrame, pandas Series</span>
<span class="sd">        Exogenous variable/s included as predictor/s.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    exog_dtypes : dict</span>
<span class="sd">        Dictionary with the dtypes in `exog`.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
        <span class="n">exog_dtypes</span> <span class="o">=</span> <span class="p">{</span><span class="n">exog</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">exog</span><span class="o">.</span><span class="n">dtypes</span><span class="p">}</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">exog_dtypes</span> <span class="o">=</span> <span class="n">exog</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">exog_dtypes</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="skforecast.utils.utils.check_exog_dtypes" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">check_exog_dtypes</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="n">call_check_exog</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">series_id</span><span class="o">=</span><span class="s1">&#39;`exog`&#39;</span><span class="p">)</span></code>

<a href="#skforecast.utils.utils.check_exog_dtypes" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents first">
  
      <p>Raise Exception if <code>exog</code> has categorical columns with non integer values.
This is needed when using machine learning regressors that allow categorical
features.
Issue a Warning if <code>exog</code> has columns that are not <code>init</code>, <code>float</code>, or <code>category</code>.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>exog</code></td>
          <td>
                <code>pandas DataFrame, pandas Series</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Exogenous variable/s included as predictor/s.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>call_check_exog</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>True</code>, call <code>check_exog</code> function.</p>
            </div>
          </td>
          <td>
                <code>`True`</code>
          </td>
        </tr>
        <tr>
          <td><code>series_id</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Identifier of the series for which the exogenous variable/s are used
in the warning message.</p>
            </div>
          </td>
          <td>
                <code>&#39;`exog`&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>None</code>
          </td>
          <td>
            <div class="doc-md-description">
              
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>skforecast\utils\utils.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">check_exog_dtypes</span><span class="p">(</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">],</span>
    <span class="n">call_check_exog</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">series_id</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;`exog`&quot;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Raise Exception if `exog` has categorical columns with non integer values.</span>
<span class="sd">    This is needed when using machine learning regressors that allow categorical</span>
<span class="sd">    features.</span>
<span class="sd">    Issue a Warning if `exog` has columns that are not `init`, `float`, or `category`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    exog : pandas DataFrame, pandas Series</span>
<span class="sd">        Exogenous variable/s included as predictor/s.</span>
<span class="sd">    call_check_exog : bool, default `True`</span>
<span class="sd">        If `True`, call `check_exog` function.</span>
<span class="sd">    series_id : str, default &#39;`exog`&#39;</span>
<span class="sd">        Identifier of the series for which the exogenous variable/s are used</span>
<span class="sd">        in the warning message.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">call_check_exog</span><span class="p">:</span>
        <span class="n">check_exog</span><span class="p">(</span><span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span> <span class="n">allow_nan</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">series_id</span><span class="o">=</span><span class="n">series_id</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">exog</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="s1">&#39;category&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">series_id</span><span class="si">}</span><span class="s2"> may contain only `int`, `float` or `category` dtypes. &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;Most machine learning models do not allow other types of values. &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;Fitting the forecaster may fail.&quot;</span><span class="p">),</span> 
                 <span class="n">DataTypeWarning</span>
            <span class="p">)</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">exog</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s1">&#39;category&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">exog</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">categories</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="p">(</span><span class="s2">&quot;Categorical columns in exog must contain only integer values. &quot;</span>
                     <span class="s2">&quot;See skforecast docs for more info about how to include &quot;</span>
                     <span class="s2">&quot;categorical features https://skforecast.org/&quot;</span>
                     <span class="s2">&quot;latest/user_guides/categorical-features.html&quot;</span><span class="p">)</span>
                <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">exog</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="s1">&#39;int8&#39;</span><span class="p">,</span> <span class="s1">&#39;int16&#39;</span><span class="p">,</span> <span class="s1">&#39;int32&#39;</span><span class="p">,</span> <span class="s1">&#39;int64&#39;</span><span class="p">,</span> <span class="s1">&#39;float&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;float16&#39;</span><span class="p">,</span> <span class="s1">&#39;float32&#39;</span><span class="p">,</span> <span class="s1">&#39;float64&#39;</span><span class="p">,</span> <span class="s1">&#39;uint8&#39;</span><span class="p">,</span> <span class="s1">&#39;uint16&#39;</span><span class="p">,</span> <span class="s1">&#39;uint32&#39;</span><span class="p">,</span> <span class="s1">&#39;uint64&#39;</span><span class="p">,</span> <span class="s1">&#39;category&#39;</span><span class="p">]:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">series_id</span><span class="si">}</span><span class="s2"> may contain only `int`, `float` or `category` dtypes. Most &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;machine learning models do not allow other types of values. &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;Fitting the forecaster may fail.&quot;</span><span class="p">),</span> 
                 <span class="n">DataTypeWarning</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">exog</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;category&#39;</span> <span class="ow">and</span> <span class="n">exog</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">categories</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">int</span><span class="p">,</span>
        <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="p">(</span><span class="s2">&quot;If exog is of type category, it must contain only integer values. &quot;</span>
                 <span class="s2">&quot;See skforecast docs for more info about how to include &quot;</span>
                 <span class="s2">&quot;categorical features https://skforecast.org/&quot;</span>
                 <span class="s2">&quot;latest/user_guides/categorical-features.html&quot;</span><span class="p">)</span>
            <span class="p">)</span>

    <span class="k">return</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="skforecast.utils.utils.check_interval" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">check_interval</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">quantiles</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#skforecast.utils.utils.check_interval" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents first">
  
      <p>Check provided confidence interval sequence is valid.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>interval</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Confidence of the prediction interval estimated. Sequence of percentiles
to compute, which must be between 0 and 100 inclusive. For example, 
interval of 95% should be as <code>interval = [2.5, 97.5]</code>.</p>
            </div>
          </td>
          <td>
                <code>`None`</code>
          </td>
        </tr>
        <tr>
          <td><code>quantiles</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Sequence of quantiles to compute, which must be between 0 and 1 
inclusive. For example, quantiles of 0.05, 0.5 and 0.95 should be as 
<code>quantiles = [0.05, 0.5, 0.95]</code>.</p>
            </div>
          </td>
          <td>
                <code>`None`</code>
          </td>
        </tr>
        <tr>
          <td><code>alpha</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The confidence intervals used in ForecasterSarimax are (1 - alpha) %.</p>
            </div>
          </td>
          <td>
                <code>`None`</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>None</code>
          </td>
          <td>
            <div class="doc-md-description">
              
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>skforecast\utils\utils.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">check_interval</span><span class="p">(</span>
    <span class="n">interval</span><span class="p">:</span> <span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">quantiles</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check provided confidence interval sequence is valid.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    interval : list, default `None`</span>
<span class="sd">        Confidence of the prediction interval estimated. Sequence of percentiles</span>
<span class="sd">        to compute, which must be between 0 and 100 inclusive. For example, </span>
<span class="sd">        interval of 95% should be as `interval = [2.5, 97.5]`.</span>
<span class="sd">    quantiles : list, default `None`</span>
<span class="sd">        Sequence of quantiles to compute, which must be between 0 and 1 </span>
<span class="sd">        inclusive. For example, quantiles of 0.05, 0.5 and 0.95 should be as </span>
<span class="sd">        `quantiles = [0.05, 0.5, 0.95]`.</span>
<span class="sd">    alpha : float, default `None`</span>
<span class="sd">        The confidence intervals used in ForecasterSarimax are (1 - alpha) %.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">interval</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">interval</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="p">(</span><span class="s2">&quot;`interval` must be a `list`. For example, interval of 95% &quot;</span>
                 <span class="s2">&quot;should be as `interval = [2.5, 97.5]`.&quot;</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="p">(</span><span class="s2">&quot;`interval` must contain exactly 2 values, respectively the &quot;</span>
                 <span class="s2">&quot;lower and upper interval bounds. For example, interval of 95% &quot;</span>
                 <span class="s2">&quot;should be as `interval = [2.5, 97.5]`.&quot;</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">100.</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Lower interval bound (</span><span class="si">{</span><span class="n">interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">) must be &gt;= 0 and &lt; 100.&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mf">0.</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">100.</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Upper interval bound (</span><span class="si">{</span><span class="n">interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">) must be &gt; 0 and &lt;= 100.&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Lower interval bound (</span><span class="si">{</span><span class="n">interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">) must be less than the &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;upper interval bound (</span><span class="si">{</span><span class="n">interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">).&quot;</span><span class="p">)</span>
            <span class="p">)</span>

    <span class="k">if</span> <span class="n">quantiles</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">quantiles</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="p">(</span><span class="s2">&quot;`quantiles` must be a `list`. For example, quantiles 0.05, &quot;</span>
                 <span class="s2">&quot;0.5, and 0.95 should be as `quantiles = [0.05, 0.5, 0.95]`.&quot;</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">quantiles</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">q</span> <span class="o">&lt;</span> <span class="mf">0.</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">q</span> <span class="o">&gt;</span> <span class="mf">1.</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="p">(</span><span class="s2">&quot;All elements in `quantiles` must be &gt;= 0 and &lt;= 1.&quot;</span><span class="p">)</span>
                <span class="p">)</span>

    <span class="k">if</span> <span class="n">alpha</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="p">(</span><span class="s2">&quot;`alpha` must be a `float`. For example, interval of 95% &quot;</span>
                 <span class="s2">&quot;should be as `alpha = 0.05`.&quot;</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">alpha</span> <span class="o">&lt;=</span> <span class="mf">0.</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">alpha</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;`alpha` must have a value between 0 and 1. Got </span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>

    <span class="k">return</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="skforecast.utils.utils.check_predict_input" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">check_predict_input</span><span class="p">(</span><span class="n">forecaster_name</span><span class="p">,</span> <span class="n">steps</span><span class="p">,</span> <span class="n">fitted</span><span class="p">,</span> <span class="n">included_exog</span><span class="p">,</span> <span class="n">index_type</span><span class="p">,</span> <span class="n">index_freq</span><span class="p">,</span> <span class="n">window_size</span><span class="p">,</span> <span class="n">last_window</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">last_window_exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">exog_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">exog_col_names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_steps</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">levels_forecaster</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">series_col_names</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#skforecast.utils.utils.check_predict_input" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents first">
  
      <p>Check all inputs of predict method. This is a helper function to validate
that inputs used in predict method match attributes of a forecaster already
trained.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>forecaster_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Forecaster name. ForecasterAutoreg, ForecasterAutoregCustom, 
ForecasterAutoregDirect, ForecasterAutoregMultiSeries, 
ForecasterAutoregMultiSeriesCustom, ForecasterAutoregMultiVariate,
ForecasterRnn</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>steps</code></td>
          <td>
                <code>(int, list)</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of future steps predicted.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>fitted</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Tag to identify if the regressor has been fitted (trained).</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>included_exog</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If the forecaster has been trained using exogenous variable/s.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>index_type</code></td>
          <td>
                <code>type</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Type of index of the input used in training.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>index_freq</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Frequency of Index of the input used in training.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>window_size</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Size of the window needed to create the predictors. It is equal to 
<code>max_lag</code>.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>last_window</code></td>
          <td>
                <code>pandas Series, pandas DataFrame</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Values of the series used to create the predictors (lags) need in the 
first iteration of prediction (t + 1).</p>
            </div>
          </td>
          <td>
                <code>`None`</code>
          </td>
        </tr>
        <tr>
          <td><code>last_window_exog</code></td>
          <td>
                <code>pandas Series, pandas DataFrame</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Values of the exogenous variables aligned with <code>last_window</code> in 
ForecasterSarimax predictions.</p>
            </div>
          </td>
          <td>
                <code>`None`</code>
          </td>
        </tr>
        <tr>
          <td><code>exog</code></td>
          <td>
                <code>pandas Series, pandas DataFrame</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Exogenous variable/s included as predictor/s.</p>
            </div>
          </td>
          <td>
                <code>`None`</code>
          </td>
        </tr>
        <tr>
          <td><code>exog_type</code></td>
          <td>
                <code>type</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Type of exogenous variable/s used in training.</p>
            </div>
          </td>
          <td>
                <code>`None`</code>
          </td>
        </tr>
        <tr>
          <td><code>exog_col_names</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Names of the exogenous variables used during training.</p>
            </div>
          </td>
          <td>
                <code>`None`</code>
          </td>
        </tr>
        <tr>
          <td><code>interval</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Confidence of the prediction interval estimated. Sequence of percentiles
to compute, which must be between 0 and 100 inclusive. For example, 
interval of 95% should be as <code>interval = [2.5, 97.5]</code>.</p>
            </div>
          </td>
          <td>
                <code>`None`</code>
          </td>
        </tr>
        <tr>
          <td><code>alpha</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The confidence intervals used in ForecasterSarimax are (1 - alpha) %.</p>
            </div>
          </td>
          <td>
                <code>`None`</code>
          </td>
        </tr>
        <tr>
          <td><code>max_steps</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Maximum number of steps allowed (<code>ForecasterAutoregDirect</code> and 
<code>ForecasterAutoregMultiVariate</code>).</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>levels</code></td>
          <td>
                <code>(str, list)</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Time series to be predicted (<code>ForecasterAutoregMultiSeries</code>,
<code>ForecasterAutoregMultiSeriesCustom</code> and `ForecasterRnn).</p>
            </div>
          </td>
          <td>
                <code>`None`</code>
          </td>
        </tr>
        <tr>
          <td><code>levels_forecaster</code></td>
          <td>
                <code>(str, list)</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Time series used as output data of a multiseries problem in a RNN problem
(<code>ForecasterRnn</code>).</p>
            </div>
          </td>
          <td>
                <code>`None`</code>
          </td>
        </tr>
        <tr>
          <td><code>series_col_names</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Names of the columns used during fit (<code>ForecasterAutoregMultiSeries</code>, 
<code>ForecasterAutoregMultiSeriesCustom</code>, <code>ForecasterAutoregMultiVariate</code>
and <code>ForecasterRnn</code>).</p>
            </div>
          </td>
          <td>
                <code>`None`</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>None</code>
          </td>
          <td>
            <div class="doc-md-description">
              
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>skforecast\utils\utils.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 605</span>
<span class="normal"> 606</span>
<span class="normal"> 607</span>
<span class="normal"> 608</span>
<span class="normal"> 609</span>
<span class="normal"> 610</span>
<span class="normal"> 611</span>
<span class="normal"> 612</span>
<span class="normal"> 613</span>
<span class="normal"> 614</span>
<span class="normal"> 615</span>
<span class="normal"> 616</span>
<span class="normal"> 617</span>
<span class="normal"> 618</span>
<span class="normal"> 619</span>
<span class="normal"> 620</span>
<span class="normal"> 621</span>
<span class="normal"> 622</span>
<span class="normal"> 623</span>
<span class="normal"> 624</span>
<span class="normal"> 625</span>
<span class="normal"> 626</span>
<span class="normal"> 627</span>
<span class="normal"> 628</span>
<span class="normal"> 629</span>
<span class="normal"> 630</span>
<span class="normal"> 631</span>
<span class="normal"> 632</span>
<span class="normal"> 633</span>
<span class="normal"> 634</span>
<span class="normal"> 635</span>
<span class="normal"> 636</span>
<span class="normal"> 637</span>
<span class="normal"> 638</span>
<span class="normal"> 639</span>
<span class="normal"> 640</span>
<span class="normal"> 641</span>
<span class="normal"> 642</span>
<span class="normal"> 643</span>
<span class="normal"> 644</span>
<span class="normal"> 645</span>
<span class="normal"> 646</span>
<span class="normal"> 647</span>
<span class="normal"> 648</span>
<span class="normal"> 649</span>
<span class="normal"> 650</span>
<span class="normal"> 651</span>
<span class="normal"> 652</span>
<span class="normal"> 653</span>
<span class="normal"> 654</span>
<span class="normal"> 655</span>
<span class="normal"> 656</span>
<span class="normal"> 657</span>
<span class="normal"> 658</span>
<span class="normal"> 659</span>
<span class="normal"> 660</span>
<span class="normal"> 661</span>
<span class="normal"> 662</span>
<span class="normal"> 663</span>
<span class="normal"> 664</span>
<span class="normal"> 665</span>
<span class="normal"> 666</span>
<span class="normal"> 667</span>
<span class="normal"> 668</span>
<span class="normal"> 669</span>
<span class="normal"> 670</span>
<span class="normal"> 671</span>
<span class="normal"> 672</span>
<span class="normal"> 673</span>
<span class="normal"> 674</span>
<span class="normal"> 675</span>
<span class="normal"> 676</span>
<span class="normal"> 677</span>
<span class="normal"> 678</span>
<span class="normal"> 679</span>
<span class="normal"> 680</span>
<span class="normal"> 681</span>
<span class="normal"> 682</span>
<span class="normal"> 683</span>
<span class="normal"> 684</span>
<span class="normal"> 685</span>
<span class="normal"> 686</span>
<span class="normal"> 687</span>
<span class="normal"> 688</span>
<span class="normal"> 689</span>
<span class="normal"> 690</span>
<span class="normal"> 691</span>
<span class="normal"> 692</span>
<span class="normal"> 693</span>
<span class="normal"> 694</span>
<span class="normal"> 695</span>
<span class="normal"> 696</span>
<span class="normal"> 697</span>
<span class="normal"> 698</span>
<span class="normal"> 699</span>
<span class="normal"> 700</span>
<span class="normal"> 701</span>
<span class="normal"> 702</span>
<span class="normal"> 703</span>
<span class="normal"> 704</span>
<span class="normal"> 705</span>
<span class="normal"> 706</span>
<span class="normal"> 707</span>
<span class="normal"> 708</span>
<span class="normal"> 709</span>
<span class="normal"> 710</span>
<span class="normal"> 711</span>
<span class="normal"> 712</span>
<span class="normal"> 713</span>
<span class="normal"> 714</span>
<span class="normal"> 715</span>
<span class="normal"> 716</span>
<span class="normal"> 717</span>
<span class="normal"> 718</span>
<span class="normal"> 719</span>
<span class="normal"> 720</span>
<span class="normal"> 721</span>
<span class="normal"> 722</span>
<span class="normal"> 723</span>
<span class="normal"> 724</span>
<span class="normal"> 725</span>
<span class="normal"> 726</span>
<span class="normal"> 727</span>
<span class="normal"> 728</span>
<span class="normal"> 729</span>
<span class="normal"> 730</span>
<span class="normal"> 731</span>
<span class="normal"> 732</span>
<span class="normal"> 733</span>
<span class="normal"> 734</span>
<span class="normal"> 735</span>
<span class="normal"> 736</span>
<span class="normal"> 737</span>
<span class="normal"> 738</span>
<span class="normal"> 739</span>
<span class="normal"> 740</span>
<span class="normal"> 741</span>
<span class="normal"> 742</span>
<span class="normal"> 743</span>
<span class="normal"> 744</span>
<span class="normal"> 745</span>
<span class="normal"> 746</span>
<span class="normal"> 747</span>
<span class="normal"> 748</span>
<span class="normal"> 749</span>
<span class="normal"> 750</span>
<span class="normal"> 751</span>
<span class="normal"> 752</span>
<span class="normal"> 753</span>
<span class="normal"> 754</span>
<span class="normal"> 755</span>
<span class="normal"> 756</span>
<span class="normal"> 757</span>
<span class="normal"> 758</span>
<span class="normal"> 759</span>
<span class="normal"> 760</span>
<span class="normal"> 761</span>
<span class="normal"> 762</span>
<span class="normal"> 763</span>
<span class="normal"> 764</span>
<span class="normal"> 765</span>
<span class="normal"> 766</span>
<span class="normal"> 767</span>
<span class="normal"> 768</span>
<span class="normal"> 769</span>
<span class="normal"> 770</span>
<span class="normal"> 771</span>
<span class="normal"> 772</span>
<span class="normal"> 773</span>
<span class="normal"> 774</span>
<span class="normal"> 775</span>
<span class="normal"> 776</span>
<span class="normal"> 777</span>
<span class="normal"> 778</span>
<span class="normal"> 779</span>
<span class="normal"> 780</span>
<span class="normal"> 781</span>
<span class="normal"> 782</span>
<span class="normal"> 783</span>
<span class="normal"> 784</span>
<span class="normal"> 785</span>
<span class="normal"> 786</span>
<span class="normal"> 787</span>
<span class="normal"> 788</span>
<span class="normal"> 789</span>
<span class="normal"> 790</span>
<span class="normal"> 791</span>
<span class="normal"> 792</span>
<span class="normal"> 793</span>
<span class="normal"> 794</span>
<span class="normal"> 795</span>
<span class="normal"> 796</span>
<span class="normal"> 797</span>
<span class="normal"> 798</span>
<span class="normal"> 799</span>
<span class="normal"> 800</span>
<span class="normal"> 801</span>
<span class="normal"> 802</span>
<span class="normal"> 803</span>
<span class="normal"> 804</span>
<span class="normal"> 805</span>
<span class="normal"> 806</span>
<span class="normal"> 807</span>
<span class="normal"> 808</span>
<span class="normal"> 809</span>
<span class="normal"> 810</span>
<span class="normal"> 811</span>
<span class="normal"> 812</span>
<span class="normal"> 813</span>
<span class="normal"> 814</span>
<span class="normal"> 815</span>
<span class="normal"> 816</span>
<span class="normal"> 817</span>
<span class="normal"> 818</span>
<span class="normal"> 819</span>
<span class="normal"> 820</span>
<span class="normal"> 821</span>
<span class="normal"> 822</span>
<span class="normal"> 823</span>
<span class="normal"> 824</span>
<span class="normal"> 825</span>
<span class="normal"> 826</span>
<span class="normal"> 827</span>
<span class="normal"> 828</span>
<span class="normal"> 829</span>
<span class="normal"> 830</span>
<span class="normal"> 831</span>
<span class="normal"> 832</span>
<span class="normal"> 833</span>
<span class="normal"> 834</span>
<span class="normal"> 835</span>
<span class="normal"> 836</span>
<span class="normal"> 837</span>
<span class="normal"> 838</span>
<span class="normal"> 839</span>
<span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">check_predict_input</span><span class="p">(</span>
    <span class="n">forecaster_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">steps</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">],</span>
    <span class="n">fitted</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">included_exog</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">index_type</span><span class="p">:</span> <span class="nb">type</span><span class="p">,</span>
    <span class="n">index_freq</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">window_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">last_window</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">last_window_exog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">exog_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">type</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">exog_col_names</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">interval</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">alpha</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">max_steps</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">levels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">]]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">levels_forecaster</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">]]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">series_col_names</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check all inputs of predict method. This is a helper function to validate</span>
<span class="sd">    that inputs used in predict method match attributes of a forecaster already</span>
<span class="sd">    trained.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    forecaster_name : str</span>
<span class="sd">        Forecaster name. ForecasterAutoreg, ForecasterAutoregCustom, </span>
<span class="sd">        ForecasterAutoregDirect, ForecasterAutoregMultiSeries, </span>
<span class="sd">        ForecasterAutoregMultiSeriesCustom, ForecasterAutoregMultiVariate,</span>
<span class="sd">        ForecasterRnn</span>
<span class="sd">    steps : int, list</span>
<span class="sd">        Number of future steps predicted.</span>
<span class="sd">    fitted: bool</span>
<span class="sd">        Tag to identify if the regressor has been fitted (trained).</span>
<span class="sd">    included_exog : bool</span>
<span class="sd">        If the forecaster has been trained using exogenous variable/s.</span>
<span class="sd">    index_type : type</span>
<span class="sd">        Type of index of the input used in training.</span>
<span class="sd">    index_freq : str</span>
<span class="sd">        Frequency of Index of the input used in training.</span>
<span class="sd">    window_size: int</span>
<span class="sd">        Size of the window needed to create the predictors. It is equal to </span>
<span class="sd">        `max_lag`.</span>
<span class="sd">    last_window : pandas Series, pandas DataFrame, default `None`</span>
<span class="sd">        Values of the series used to create the predictors (lags) need in the </span>
<span class="sd">        first iteration of prediction (t + 1).</span>
<span class="sd">    last_window_exog : pandas Series, pandas DataFrame, default `None`</span>
<span class="sd">        Values of the exogenous variables aligned with `last_window` in </span>
<span class="sd">        ForecasterSarimax predictions.</span>
<span class="sd">    exog : pandas Series, pandas DataFrame, default `None`</span>
<span class="sd">        Exogenous variable/s included as predictor/s.</span>
<span class="sd">    exog_type : type, default `None`</span>
<span class="sd">        Type of exogenous variable/s used in training.</span>
<span class="sd">    exog_col_names : list, default `None`</span>
<span class="sd">        Names of the exogenous variables used during training.</span>
<span class="sd">    interval : list, default `None`</span>
<span class="sd">        Confidence of the prediction interval estimated. Sequence of percentiles</span>
<span class="sd">        to compute, which must be between 0 and 100 inclusive. For example, </span>
<span class="sd">        interval of 95% should be as `interval = [2.5, 97.5]`.</span>
<span class="sd">    alpha : float, default `None`</span>
<span class="sd">        The confidence intervals used in ForecasterSarimax are (1 - alpha) %.</span>
<span class="sd">    max_steps: int, default `None`</span>
<span class="sd">        Maximum number of steps allowed (`ForecasterAutoregDirect` and </span>
<span class="sd">        `ForecasterAutoregMultiVariate`).</span>
<span class="sd">    levels : str, list, default `None`</span>
<span class="sd">        Time series to be predicted (`ForecasterAutoregMultiSeries`,</span>
<span class="sd">        `ForecasterAutoregMultiSeriesCustom` and `ForecasterRnn).</span>
<span class="sd">    levels_forecaster : str, list, default `None`</span>
<span class="sd">        Time series used as output data of a multiseries problem in a RNN problem</span>
<span class="sd">        (`ForecasterRnn`).</span>
<span class="sd">    series_col_names : list, default `None`</span>
<span class="sd">        Names of the columns used during fit (`ForecasterAutoregMultiSeries`, </span>
<span class="sd">        `ForecasterAutoregMultiSeriesCustom`, `ForecasterAutoregMultiVariate`</span>
<span class="sd">        and `ForecasterRnn`).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">fitted</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">NotFittedError</span><span class="p">(</span>
            <span class="p">(</span><span class="s2">&quot;This Forecaster instance is not fitted yet. Call `fit` with &quot;</span>
             <span class="s2">&quot;appropriate arguments before using predict.&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">))</span> <span class="ow">and</span> <span class="n">steps</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;`steps` must be an integer greater than or equal to 1. Got </span><span class="si">{</span><span class="n">steps</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">min</span><span class="p">(</span><span class="n">steps</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
           <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The minimum value of `steps` must be equal to or greater than 1. &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">min</span><span class="p">(</span><span class="n">steps</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">max_steps</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">max</span><span class="p">(</span><span class="n">steps</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">max_steps</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The maximum value of `steps` must be less than or equal to &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;the value of steps defined when initializing the forecaster. &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">max</span><span class="p">(</span><span class="n">steps</span><span class="p">)</span><span class="si">}</span><span class="s2">, but the maximum is </span><span class="si">{</span><span class="n">max_steps</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="p">)</span>

    <span class="k">if</span> <span class="n">interval</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">alpha</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">check_interval</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="n">interval</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ForecasterAutoregMultiSeries&#39;</span><span class="p">,</span> 
                           <span class="s1">&#39;ForecasterAutoregMultiSeriesCustom&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;ForecasterRnn&#39;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">levels</span><span class="p">,</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="p">(</span><span class="s2">&quot;`levels` must be a `list` of column names, a `str` of a &quot;</span>
                 <span class="s2">&quot;column name or `None`.&quot;</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="n">levels_to_check</span> <span class="o">=</span> <span class="n">levels_forecaster</span> <span class="k">if</span> <span class="n">forecaster_name</span> <span class="o">==</span> <span class="s1">&#39;ForecasterRnn&#39;</span> <span class="k">else</span> <span class="n">series_col_names</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">levels</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">levels_to_check</span><span class="p">))</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`levels` names must be included in the series used during fit &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">levels_to_check</span><span class="si">}</span><span class="s2">). Got </span><span class="si">{</span><span class="n">levels</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="p">)</span>

    <span class="k">if</span> <span class="n">exog</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">included_exog</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="p">(</span><span class="s2">&quot;Forecaster trained with exogenous variable/s. &quot;</span>
             <span class="s2">&quot;Same variable/s must be provided when predicting.&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">included_exog</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="p">(</span><span class="s2">&quot;Forecaster trained without exogenous variable/s. &quot;</span>
             <span class="s2">&quot;`exog` must be `None` when predicting.&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="c1"># Checks last_window</span>
    <span class="c1"># Check last_window type (pd.Series or pd.DataFrame according to forecaster)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">last_window</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))</span> <span class="ow">and</span> <span class="n">forecaster_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span>
        <span class="s1">&#39;ForecasterAutoregMultiSeries&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;ForecasterAutoregMultiSeriesCustom&#39;</span><span class="p">,</span>
        <span class="s1">&#39;ForecasterRnn&#39;</span>
    <span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="p">(</span><span class="s2">&quot;`last_window` was not stored during training. If you don&#39;t want &quot;</span>
             <span class="s2">&quot;to retrain the Forecaster, provide `last_window` as argument.&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ForecasterAutoregMultiSeries&#39;</span><span class="p">,</span> 
                           <span class="s1">&#39;ForecasterAutoregMultiSeriesCustom&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;ForecasterAutoregMultiVariate&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;ForecasterRnn&#39;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">last_window</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;`last_window` must be a pandas DataFrame. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">last_window</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>

        <span class="n">last_window_cols</span> <span class="o">=</span> <span class="n">last_window</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ForecasterAutoregMultiSeries&#39;</span><span class="p">,</span> 
                               <span class="s1">&#39;ForecasterAutoregMultiSeriesCustom&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;ForecasterRnn&#39;</span><span class="p">]</span> <span class="ow">and</span> \
            <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">levels</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">last_window_cols</span><span class="p">))</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`last_window` must contain a column(s) named as the level(s) &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;to be predicted.</span><span class="se">\n</span><span class="s2">&quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;    `levels` : </span><span class="si">{</span><span class="n">levels</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;    `last_window` columns : </span><span class="si">{</span><span class="n">last_window_cols</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">forecaster_name</span> <span class="o">==</span> <span class="s1">&#39;ForecasterAutoregMultiVariate&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">series_col_names</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">last_window_cols</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`last_window` columns must be the same as the `series` &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;column names used to create the X_train matrix.</span><span class="se">\n</span><span class="s2">&quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;    `last_window` columns    : </span><span class="si">{</span><span class="n">last_window_cols</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;    `series` columns X train : </span><span class="si">{</span><span class="n">series_col_names</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">last_window</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;`last_window` must be a pandas Series. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">last_window</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>

    <span class="c1"># Check last_window len, nulls and index (type and freq)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">last_window</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">window_size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`last_window` must have as many values as needed to &quot;</span>
             <span class="sa">f</span><span class="s2">&quot;generate the predictors. For this forecaster it is </span><span class="si">{</span><span class="n">window_size</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="n">last_window</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">()</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="p">(</span><span class="s2">&quot;`last_window` has missing values. Most of machine learning models do &quot;</span>
             <span class="s2">&quot;not allow missing values. `predict` method may fail.&quot;</span><span class="p">),</span> 
             <span class="n">MissingValuesWarning</span>
        <span class="p">)</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">last_window_index</span> <span class="o">=</span> <span class="n">preprocess_last_window</span><span class="p">(</span>
                               <span class="n">last_window</span>   <span class="o">=</span> <span class="n">last_window</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">0</span><span class="p">],</span>
                               <span class="n">return_values</span> <span class="o">=</span> <span class="kc">False</span>
                           <span class="p">)</span> 
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">last_window_index</span><span class="p">,</span> <span class="n">index_type</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected index of type </span><span class="si">{</span><span class="n">index_type</span><span class="si">}</span><span class="s2"> for `last_window`. &quot;</span>
             <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">last_window_index</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">last_window_index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">last_window_index</span><span class="o">.</span><span class="n">freqstr</span> <span class="o">==</span> <span class="n">index_freq</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected frequency of type </span><span class="si">{</span><span class="n">index_freq</span><span class="si">}</span><span class="s2"> for `last_window`. &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="n">last_window_index</span><span class="o">.</span><span class="n">freqstr</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="p">)</span>

    <span class="c1"># Checks exog</span>
    <span class="k">if</span> <span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

        <span class="c1"># Check type, nulls and expected type</span>
        <span class="k">if</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ForecasterAutoregMultiSeries&#39;</span><span class="p">,</span> 
                               <span class="s1">&#39;ForecasterAutoregMultiSeriesCustom&#39;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;`exog` must be a pandas Series, DataFrame or dict. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
                <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="n">exog_type</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Expected type for `exog`: </span><span class="si">{</span><span class="n">exog_type</span><span class="si">}</span><span class="s2">. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">exogs_to_check</span> <span class="o">=</span> <span class="p">[(</span><span class="sa">f</span><span class="s2">&quot;`exog` for series &#39;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> 
                              <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">exog</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">exogs_to_check</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;`exog`&#39;</span><span class="p">,</span> <span class="n">exog</span><span class="p">)]</span>

        <span class="k">for</span> <span class="n">exog_name</span><span class="p">,</span> <span class="n">exog_to_check</span> <span class="ow">in</span> <span class="n">exogs_to_check</span><span class="p">:</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog_to_check</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">exog_name</span><span class="si">}</span><span class="s2"> must be a pandas Series or DataFrame. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">exog_to_check</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="n">exog_to_check</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                    <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">exog_name</span><span class="si">}</span><span class="s2"> has missing values. Most of machine learning models &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;do not allow missing values. `predict` method may fail.&quot;</span><span class="p">),</span> 
                     <span class="n">MissingValuesWarning</span>
                <span class="p">)</span>

            <span class="c1"># Check exog has many values as distance to max step predicted</span>
            <span class="n">last_step</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">steps</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">else</span> <span class="n">steps</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">exog_to_check</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">last_step</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ForecasterAutoregMultiSeries&#39;</span><span class="p">,</span> 
                                       <span class="s1">&#39;ForecasterAutoregMultiSeriesCustom&#39;</span><span class="p">]:</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                        <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">exog_name</span><span class="si">}</span><span class="s2"> doesn&#39;t have as many values as steps &quot;</span>
                         <span class="sa">f</span><span class="s2">&quot;predicted, </span><span class="si">{</span><span class="n">last_step</span><span class="si">}</span><span class="s2">. Missing values are filled &quot;</span>
                         <span class="sa">f</span><span class="s2">&quot;with NaN. Most of machine learning models do not &quot;</span>
                         <span class="sa">f</span><span class="s2">&quot;allow missing values. `predict` method may fail.&quot;</span><span class="p">),</span>
                         <span class="n">MissingValuesWarning</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span> 
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">exog_name</span><span class="si">}</span><span class="s2"> must have at least as many values as &quot;</span>
                         <span class="sa">f</span><span class="s2">&quot;steps predicted, </span><span class="si">{</span><span class="n">last_step</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
                    <span class="p">)</span>

            <span class="c1"># Check name/columns are in exog_col_names</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog_to_check</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
                <span class="n">col_missing</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">exog_col_names</span><span class="p">)</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">exog_to_check</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">col_missing</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ForecasterAutoregMultiSeries&#39;</span><span class="p">,</span> 
                                           <span class="s1">&#39;ForecasterAutoregMultiSeriesCustom&#39;</span><span class="p">]:</span>
                        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                            <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">col_missing</span><span class="si">}</span><span class="s2"> not present in </span><span class="si">{</span><span class="n">exog_name</span><span class="si">}</span><span class="s2">. All &quot;</span>
                             <span class="sa">f</span><span class="s2">&quot;values will be NaN.&quot;</span><span class="p">),</span>
                             <span class="n">MissingExogWarning</span>
                        <span class="p">)</span> 
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                            <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Missing columns in </span><span class="si">{</span><span class="n">exog_name</span><span class="si">}</span><span class="s2">. Expected </span><span class="si">{</span><span class="n">exog_col_names</span><span class="si">}</span><span class="s2">. &quot;</span>
                             <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="n">exog_to_check</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
                        <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">exog_to_check</span><span class="o">.</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;When </span><span class="si">{</span><span class="n">exog_name</span><span class="si">}</span><span class="s2"> is a pandas Series, it must have a name. Got None.&quot;</span><span class="p">)</span>
                    <span class="p">)</span>

                <span class="k">if</span> <span class="n">exog_to_check</span><span class="o">.</span><span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">exog_col_names</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ForecasterAutoregMultiSeries&#39;</span><span class="p">,</span> 
                                           <span class="s1">&#39;ForecasterAutoregMultiSeriesCustom&#39;</span><span class="p">]:</span>
                        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                            <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">exog_to_check</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; was not observed during training. &quot;</span>
                             <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">exog_name</span><span class="si">}</span><span class="s2"> is ignored. Exogenous variables must be one &quot;</span>
                             <span class="sa">f</span><span class="s2">&quot;of: </span><span class="si">{</span><span class="n">exog_col_names</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">),</span>
                             <span class="n">IgnoredArgumentWarning</span>
                        <span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                            <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">exog_to_check</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; was not observed during training. &quot;</span>
                             <span class="sa">f</span><span class="s2">&quot;Exogenous variables must be: </span><span class="si">{</span><span class="n">exog_col_names</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
                        <span class="p">)</span>

            <span class="c1"># Check index dtype and freq</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">exog_index</span> <span class="o">=</span> <span class="n">preprocess_exog</span><span class="p">(</span>
                                <span class="n">exog</span>          <span class="o">=</span> <span class="n">exog_to_check</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">0</span><span class="p">,</span> <span class="p">],</span>
                                <span class="n">return_values</span> <span class="o">=</span> <span class="kc">False</span>
                            <span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog_index</span><span class="p">,</span> <span class="n">index_type</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected index of type </span><span class="si">{</span><span class="n">index_type</span><span class="si">}</span><span class="s2"> for </span><span class="si">{</span><span class="n">exog_name</span><span class="si">}</span><span class="s2">. &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">exog_index</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="n">forecaster_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ForecasterAutoregMultiSeries&#39;</span><span class="p">,</span> 
                                       <span class="s1">&#39;ForecasterAutoregMultiSeriesCustom&#39;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog_index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">):</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">exog_index</span><span class="o">.</span><span class="n">freqstr</span> <span class="o">==</span> <span class="n">index_freq</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                            <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected frequency of type </span><span class="si">{</span><span class="n">index_freq</span><span class="si">}</span><span class="s2"> for </span><span class="si">{</span><span class="n">exog_name</span><span class="si">}</span><span class="s2">. &quot;</span>
                             <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="n">exog_index</span><span class="o">.</span><span class="n">freqstr</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
                        <span class="p">)</span>

            <span class="c1"># Check exog starts one step ahead of last_window end.</span>
            <span class="n">expected_index</span> <span class="o">=</span> <span class="n">expand_index</span><span class="p">(</span><span class="n">last_window</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">expected_index</span> <span class="o">!=</span> <span class="n">exog_to_check</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ForecasterAutoregMultiSeries&#39;</span><span class="p">,</span> 
                                       <span class="s1">&#39;ForecasterAutoregMultiSeriesCustom&#39;</span><span class="p">]:</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                        <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;To make predictions </span><span class="si">{</span><span class="n">exog_name</span><span class="si">}</span><span class="s2"> must start one step &quot;</span>
                         <span class="sa">f</span><span class="s2">&quot;ahead of `last_window`. Missing values are filled &quot;</span>
                         <span class="sa">f</span><span class="s2">&quot;with NaN.</span><span class="se">\n</span><span class="s2">&quot;</span>
                         <span class="sa">f</span><span class="s2">&quot;    `last_window` ends at : </span><span class="si">{</span><span class="n">last_window</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">.</span><span class="se">\n</span><span class="s2">&quot;</span>
                         <span class="sa">f</span><span class="s2">&quot;    </span><span class="si">{</span><span class="n">exog_name</span><span class="si">}</span><span class="s2"> starts at : </span><span class="si">{</span><span class="n">exog_to_check</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">.</span><span class="se">\n</span><span class="s2">&quot;</span>
                         <span class="sa">f</span><span class="s2">&quot;     Expected index       : </span><span class="si">{</span><span class="n">expected_index</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">),</span>
                         <span class="n">MissingValuesWarning</span>
                    <span class="p">)</span>  
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;To make predictions </span><span class="si">{</span><span class="n">exog_name</span><span class="si">}</span><span class="s2"> must start one step &quot;</span>
                         <span class="sa">f</span><span class="s2">&quot;ahead of `last_window`.</span><span class="se">\n</span><span class="s2">&quot;</span>
                         <span class="sa">f</span><span class="s2">&quot;    `last_window` ends at : </span><span class="si">{</span><span class="n">last_window</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">.</span><span class="se">\n</span><span class="s2">&quot;</span>
                         <span class="sa">f</span><span class="s2">&quot;    </span><span class="si">{</span><span class="n">exog_name</span><span class="si">}</span><span class="s2"> starts at : </span><span class="si">{</span><span class="n">exog_to_check</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">.</span><span class="se">\n</span><span class="s2">&quot;</span>
                         <span class="sa">f</span><span class="s2">&quot;     Expected index : </span><span class="si">{</span><span class="n">expected_index</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
                    <span class="p">)</span>

    <span class="c1"># Checks ForecasterSarimax</span>
    <span class="k">if</span> <span class="n">forecaster_name</span> <span class="o">==</span> <span class="s1">&#39;ForecasterSarimax&#39;</span><span class="p">:</span>
        <span class="c1"># Check last_window_exog type, len, nulls and index (type and freq)</span>
        <span class="k">if</span> <span class="n">last_window_exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">included_exog</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="p">(</span><span class="s2">&quot;Forecaster trained without exogenous variable/s. &quot;</span>
                     <span class="s2">&quot;`last_window_exog` must be `None` when predicting.&quot;</span><span class="p">)</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">last_window_exog</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`last_window_exog` must be a pandas Series or a &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;pandas DataFrame. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">last_window_exog</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">last_window_exog</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">window_size</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`last_window_exog` must have as many values as needed to &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;generate the predictors. For this forecaster it is </span><span class="si">{</span><span class="n">window_size</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="n">last_window_exog</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">()</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="p">(</span><span class="s2">&quot;`last_window_exog` has missing values. Most of machine learning &quot;</span>
                 <span class="s2">&quot;models do not allow missing values. `predict` method may fail.&quot;</span><span class="p">),</span>
                <span class="n">MissingValuesWarning</span>
            <span class="p">)</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">last_window_exog_index</span> <span class="o">=</span> <span class="n">preprocess_last_window</span><span class="p">(</span>
                                            <span class="n">last_window</span>   <span class="o">=</span> <span class="n">last_window_exog</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">0</span><span class="p">],</span>
                                            <span class="n">return_values</span> <span class="o">=</span> <span class="kc">False</span>
                                        <span class="p">)</span> 
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">last_window_exog_index</span><span class="p">,</span> <span class="n">index_type</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected index of type </span><span class="si">{</span><span class="n">index_type</span><span class="si">}</span><span class="s2"> for `last_window_exog`. &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">last_window_exog_index</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">last_window_exog_index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">last_window_exog_index</span><span class="o">.</span><span class="n">freqstr</span> <span class="o">==</span> <span class="n">index_freq</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                        <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected frequency of type </span><span class="si">{</span><span class="n">index_freq</span><span class="si">}</span><span class="s2"> for &quot;</span>
                         <span class="sa">f</span><span class="s2">&quot;`last_window_exog`. Got </span><span class="si">{</span><span class="n">last_window_exog_index</span><span class="o">.</span><span class="n">freqstr</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
                    <span class="p">)</span>

            <span class="c1"># Check all columns are in the pd.DataFrame, last_window_exog</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">last_window_exog</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
                <span class="n">col_missing</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">exog_col_names</span><span class="p">)</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">last_window_exog</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">col_missing</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Missing columns in `last_window_exog`. Expected </span><span class="si">{</span><span class="n">exog_col_names</span><span class="si">}</span><span class="s2">. &quot;</span>
                         <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="n">last_window_exog</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span> 
                    <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">last_window_exog</span><span class="o">.</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="p">(</span>
                            <span class="s2">&quot;When `last_window_exog` is a pandas Series, it must have a &quot;</span>
                            <span class="s2">&quot;name. Got None.&quot;</span>
                        <span class="p">)</span>
                    <span class="p">)</span>

                <span class="k">if</span> <span class="n">last_window_exog</span><span class="o">.</span><span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">exog_col_names</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">last_window_exog</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; was not observed during training. &quot;</span>
                         <span class="sa">f</span><span class="s2">&quot;Exogenous variables must be: </span><span class="si">{</span><span class="n">exog_col_names</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
                    <span class="p">)</span>

    <span class="k">return</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="skforecast.utils.utils.preprocess_y" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">preprocess_y</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">return_values</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#skforecast.utils.utils.preprocess_y" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents first">
  
      <p>Return values and index of series separately. Index is overwritten 
according to the next rules:</p>
<ul>
<li>If index is of type <code>DatetimeIndex</code> and has frequency, nothing is 
changed.</li>
<li>If index is of type <code>RangeIndex</code>, nothing is changed.</li>
<li>If index is of type <code>DatetimeIndex</code> but has no frequency, a 
<code>RangeIndex</code> is created.</li>
<li>If index is not of type <code>DatetimeIndex</code>, a <code>RangeIndex</code> is created.</li>
</ul>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>y</code></td>
          <td>
                <code>pandas Series, pandas DataFrame</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Time series.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>return_values</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>True</code> return the values of <code>y</code> as numpy ndarray. This option is 
intended to avoid copying data when it is not necessary.</p>
            </div>
          </td>
          <td>
                <code>`True`</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>y_values</code></td>          <td>
                <code>None, numpy ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Numpy array with values of <code>y</code>.</p>
            </div>
          </td>
        </tr>
        <tr>
<td><code>y_index</code></td>          <td>
                <code>pandas Index</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Index of <code>y</code> modified according to the rules.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>skforecast\utils\utils.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">preprocess_y</span><span class="p">(</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span>
    <span class="n">return_values</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return values and index of series separately. Index is overwritten </span>
<span class="sd">    according to the next rules:</span>

<span class="sd">    - If index is of type `DatetimeIndex` and has frequency, nothing is </span>
<span class="sd">    changed.</span>
<span class="sd">    - If index is of type `RangeIndex`, nothing is changed.</span>
<span class="sd">    - If index is of type `DatetimeIndex` but has no frequency, a </span>
<span class="sd">    `RangeIndex` is created.</span>
<span class="sd">    - If index is not of type `DatetimeIndex`, a `RangeIndex` is created.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    y : pandas Series, pandas DataFrame</span>
<span class="sd">        Time series.</span>
<span class="sd">    return_values : bool, default `True`</span>
<span class="sd">        If `True` return the values of `y` as numpy ndarray. This option is </span>
<span class="sd">        intended to avoid copying data when it is not necessary.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    y_values : None, numpy ndarray</span>
<span class="sd">        Numpy array with values of `y`.</span>
<span class="sd">    y_index : pandas Index</span>
<span class="sd">        Index of `y` modified according to the rules.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">)</span> <span class="ow">and</span> <span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">freq</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">y_index</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">index</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">RangeIndex</span><span class="p">):</span>
        <span class="n">y_index</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">index</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">)</span> <span class="ow">and</span> <span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">freq</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="p">(</span><span class="s2">&quot;Series has DatetimeIndex index but no frequency. &quot;</span>
             <span class="s2">&quot;Index is overwritten with a RangeIndex of step 1.&quot;</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">y_index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">RangeIndex</span><span class="p">(</span>
                      <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                      <span class="n">stop</span>  <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">),</span>
                      <span class="n">step</span>  <span class="o">=</span> <span class="mi">1</span>
                  <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="p">(</span><span class="s2">&quot;Series has no DatetimeIndex nor RangeIndex index. &quot;</span>
             <span class="s2">&quot;Index is overwritten with a RangeIndex.&quot;</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">y_index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">RangeIndex</span><span class="p">(</span>
                      <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                      <span class="n">stop</span>  <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">),</span>
                      <span class="n">step</span>  <span class="o">=</span> <span class="mi">1</span>
                  <span class="p">)</span>

    <span class="n">y_values</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(</span><span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">if</span> <span class="n">return_values</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">y_values</span><span class="p">,</span> <span class="n">y_index</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="skforecast.utils.utils.preprocess_last_window" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">preprocess_last_window</span><span class="p">(</span><span class="n">last_window</span><span class="p">,</span> <span class="n">return_values</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#skforecast.utils.utils.preprocess_last_window" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents first">
  
      <p>Return values and index of series separately. Index is overwritten 
according to the next rules:</p>
<ul>
<li>If index is of type <code>DatetimeIndex</code> and has frequency, nothing is 
changed.</li>
<li>If index is of type <code>RangeIndex</code>, nothing is changed.</li>
<li>If index is of type <code>DatetimeIndex</code> but has no frequency, a 
<code>RangeIndex</code> is created.</li>
<li>If index is not of type <code>DatetimeIndex</code>, a <code>RangeIndex</code> is created.</li>
</ul>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>last_window</code></td>
          <td>
                <code>pandas Series, pandas DataFrame</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Time series values.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>return_values</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>True</code> return the values of <code>last_window</code> as numpy ndarray. This option 
is intended to avoid copying data when it is not necessary.</p>
            </div>
          </td>
          <td>
                <code>`True`</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>last_window_values</code></td>          <td>
                <code>numpy ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Numpy array with values of <code>last_window</code>.</p>
            </div>
          </td>
        </tr>
        <tr>
<td><code>last_window_index</code></td>          <td>
                <code>pandas Index</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Index of <code>last_window</code> modified according to the rules.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>skforecast\utils\utils.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">preprocess_last_window</span><span class="p">(</span>
    <span class="n">last_window</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span>
    <span class="n">return_values</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span>
 <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return values and index of series separately. Index is overwritten </span>
<span class="sd">    according to the next rules:</span>

<span class="sd">    - If index is of type `DatetimeIndex` and has frequency, nothing is </span>
<span class="sd">    changed.</span>
<span class="sd">    - If index is of type `RangeIndex`, nothing is changed.</span>
<span class="sd">    - If index is of type `DatetimeIndex` but has no frequency, a </span>
<span class="sd">    `RangeIndex` is created.</span>
<span class="sd">    - If index is not of type `DatetimeIndex`, a `RangeIndex` is created.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    last_window : pandas Series, pandas DataFrame</span>
<span class="sd">        Time series values.</span>
<span class="sd">    return_values : bool, default `True`</span>
<span class="sd">        If `True` return the values of `last_window` as numpy ndarray. This option </span>
<span class="sd">        is intended to avoid copying data when it is not necessary.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    last_window_values : numpy ndarray</span>
<span class="sd">        Numpy array with values of `last_window`.</span>
<span class="sd">    last_window_index : pandas Index</span>
<span class="sd">        Index of `last_window` modified according to the rules.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">last_window</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">)</span> <span class="ow">and</span> <span class="n">last_window</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">freq</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">last_window_index</span> <span class="o">=</span> <span class="n">last_window</span><span class="o">.</span><span class="n">index</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">last_window</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">RangeIndex</span><span class="p">):</span>
        <span class="n">last_window_index</span> <span class="o">=</span> <span class="n">last_window</span><span class="o">.</span><span class="n">index</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">last_window</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">)</span> <span class="ow">and</span> <span class="n">last_window</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">freq</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="p">(</span><span class="s2">&quot;`last_window` has DatetimeIndex index but no frequency. &quot;</span>
             <span class="s2">&quot;Index is overwritten with a RangeIndex of step 1.&quot;</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">last_window_index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">RangeIndex</span><span class="p">(</span>
                                <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                                <span class="n">stop</span>  <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">last_window</span><span class="p">),</span>
                                <span class="n">step</span>  <span class="o">=</span> <span class="mi">1</span>
                            <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="p">(</span><span class="s2">&quot;`last_window` has no DatetimeIndex nor RangeIndex index. &quot;</span>
             <span class="s2">&quot;Index is overwritten with a RangeIndex.&quot;</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">last_window_index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">RangeIndex</span><span class="p">(</span>
                                <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                                <span class="n">stop</span>  <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">last_window</span><span class="p">),</span>
                                <span class="n">step</span>  <span class="o">=</span> <span class="mi">1</span>
                            <span class="p">)</span>

    <span class="n">last_window_values</span> <span class="o">=</span> <span class="n">last_window</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(</span><span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">if</span> <span class="n">return_values</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">last_window_values</span><span class="p">,</span> <span class="n">last_window_index</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="skforecast.utils.utils.preprocess_exog" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">preprocess_exog</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="n">return_values</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#skforecast.utils.utils.preprocess_exog" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents first">
  
      <p>Return values and index of series or data frame separately. Index is
overwritten  according to the next rules:</p>
<ul>
<li>If index is of type <code>DatetimeIndex</code> and has frequency, nothing is 
changed.</li>
<li>If index is of type <code>RangeIndex</code>, nothing is changed.</li>
<li>If index is of type <code>DatetimeIndex</code> but has no frequency, a 
<code>RangeIndex</code> is created.</li>
<li>If index is not of type <code>DatetimeIndex</code>, a <code>RangeIndex</code> is created.</li>
</ul>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>exog</code></td>
          <td>
                <code>pandas Series, pandas DataFrame</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Exogenous variables.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>return_values</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>True</code> return the values of <code>exog</code> as numpy ndarray. This option is 
intended to avoid copying data when it is not necessary.</p>
            </div>
          </td>
          <td>
                <code>`True`</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>exog_values</code></td>          <td>
                <code>None, numpy ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Numpy array with values of <code>exog</code>.</p>
            </div>
          </td>
        </tr>
        <tr>
<td><code>exog_index</code></td>          <td>
                <code>pandas Index</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Index of <code>exog</code> modified according to the rules.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>skforecast\utils\utils.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">preprocess_exog</span><span class="p">(</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span>
    <span class="n">return_values</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return values and index of series or data frame separately. Index is</span>
<span class="sd">    overwritten  according to the next rules:</span>

<span class="sd">    - If index is of type `DatetimeIndex` and has frequency, nothing is </span>
<span class="sd">    changed.</span>
<span class="sd">    - If index is of type `RangeIndex`, nothing is changed.</span>
<span class="sd">    - If index is of type `DatetimeIndex` but has no frequency, a </span>
<span class="sd">    `RangeIndex` is created.</span>
<span class="sd">    - If index is not of type `DatetimeIndex`, a `RangeIndex` is created.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    exog : pandas Series, pandas DataFrame</span>
<span class="sd">        Exogenous variables.</span>
<span class="sd">    return_values : bool, default `True`</span>
<span class="sd">        If `True` return the values of `exog` as numpy ndarray. This option is </span>
<span class="sd">        intended to avoid copying data when it is not necessary.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    exog_values : None, numpy ndarray</span>
<span class="sd">        Numpy array with values of `exog`.</span>
<span class="sd">    exog_index : pandas Index</span>
<span class="sd">        Index of `exog` modified according to the rules.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">)</span> <span class="ow">and</span> <span class="n">exog</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">freq</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">exog_index</span> <span class="o">=</span> <span class="n">exog</span><span class="o">.</span><span class="n">index</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">RangeIndex</span><span class="p">):</span>
        <span class="n">exog_index</span> <span class="o">=</span> <span class="n">exog</span><span class="o">.</span><span class="n">index</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">)</span> <span class="ow">and</span> <span class="n">exog</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">freq</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="p">(</span><span class="s2">&quot;`exog` has DatetimeIndex index but no frequency. &quot;</span>
             <span class="s2">&quot;Index is overwritten with a RangeIndex of step 1.&quot;</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">exog_index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">RangeIndex</span><span class="p">(</span>
                         <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                         <span class="n">stop</span>  <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">exog</span><span class="p">),</span>
                         <span class="n">step</span>  <span class="o">=</span> <span class="mi">1</span>
                     <span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="p">(</span><span class="s2">&quot;`exog` has no DatetimeIndex nor RangeIndex index. &quot;</span>
             <span class="s2">&quot;Index is overwritten with a RangeIndex.&quot;</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">exog_index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">RangeIndex</span><span class="p">(</span>
                         <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                         <span class="n">stop</span>  <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">exog</span><span class="p">),</span>
                         <span class="n">step</span>  <span class="o">=</span> <span class="mi">1</span>
                     <span class="p">)</span>

    <span class="n">exog_values</span> <span class="o">=</span> <span class="n">exog</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(</span><span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">if</span> <span class="n">return_values</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">exog_values</span><span class="p">,</span> <span class="n">exog_index</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="skforecast.utils.utils.cast_exog_dtypes" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">cast_exog_dtypes</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="n">exog_dtypes</span><span class="p">)</span></code>

<a href="#skforecast.utils.utils.cast_exog_dtypes" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents first">
  
      <p>Cast <code>exog</code> to a specified types. This is done because, for a forecaster to 
accept a categorical exog, it must contain only integer values. Due to the 
internal modifications of numpy, the values may be casted to <code>float</code>, so 
they have to be re-converted to <code>int</code>.</p>
<ul>
<li>If <code>exog</code> is a pandas Series, <code>exog_dtypes</code> must be a dict with a 
single value.</li>
<li>If <code>exog_dtypes</code> is <code>category</code> but the current type of <code>exog</code> is <code>float</code>, 
then the type is cast to <code>int</code> and then to <code>category</code>. </li>
</ul>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>exog</code></td>
          <td>
                <code>pandas Series, pandas DataFrame</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Exogenous variables.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>exog_dtypes</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with name and type of the series or data frame columns.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>exog</code></td>          <td>
                <code>pandas Series, pandas DataFrame</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Exogenous variables casted to the indicated dtypes.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>skforecast\utils\utils.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">cast_exog_dtypes</span><span class="p">(</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span>
    <span class="n">exog_dtypes</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span> <span class="c1"># pragma: no cover</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Cast `exog` to a specified types. This is done because, for a forecaster to </span>
<span class="sd">    accept a categorical exog, it must contain only integer values. Due to the </span>
<span class="sd">    internal modifications of numpy, the values may be casted to `float`, so </span>
<span class="sd">    they have to be re-converted to `int`.</span>

<span class="sd">    - If `exog` is a pandas Series, `exog_dtypes` must be a dict with a </span>
<span class="sd">    single value.</span>
<span class="sd">    - If `exog_dtypes` is `category` but the current type of `exog` is `float`, </span>
<span class="sd">    then the type is cast to `int` and then to `category`. </span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    exog : pandas Series, pandas DataFrame</span>
<span class="sd">        Exogenous variables.</span>
<span class="sd">    exog_dtypes: dict</span>
<span class="sd">        Dictionary with name and type of the series or data frame columns.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    exog : pandas Series, pandas DataFrame</span>
<span class="sd">        Exogenous variables casted to the indicated dtypes.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Remove keys from exog_dtypes not in exog.columns</span>
    <span class="n">exog_dtypes</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span><span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">exog_dtypes</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">exog</span><span class="o">.</span><span class="n">columns</span><span class="p">}</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="ow">and</span> <span class="n">exog</span><span class="o">.</span><span class="n">dtypes</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">(</span><span class="n">exog_dtypes</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="n">exog</span> <span class="o">=</span> <span class="n">exog</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">exog_dtypes</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">initial_dtype</span> <span class="ow">in</span> <span class="n">exog_dtypes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">exog</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dtypes</span> <span class="o">!=</span> <span class="n">initial_dtype</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">initial_dtype</span> <span class="o">==</span> <span class="s2">&quot;category&quot;</span> <span class="ow">and</span> <span class="n">exog</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dtypes</span><span class="o">==</span><span class="nb">float</span><span class="p">:</span>
                    <span class="n">exog</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">exog</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;category&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">exog</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">exog</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">initial_dtype</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">exog</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="skforecast.utils.utils.exog_to_direct" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">exog_to_direct</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="n">steps</span><span class="p">)</span></code>

<a href="#skforecast.utils.utils.exog_to_direct" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents first">
  
      <p>Transforms <code>exog</code> to a pandas DataFrame with the shape needed for Direct
forecasting.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>exog</code></td>
          <td>
                <code>pandas Series, pandas DataFrame</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Exogenous variables.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>steps</code></td>
          <td>
                <code>int.</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of steps that will be predicted using exog.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>exog_transformed</code></td>          <td>
                <code>pandas DataFrame</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Exogenous variables transformed.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>skforecast\utils\utils.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">exog_to_direct</span><span class="p">(</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span>
    <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span>
<span class="p">)</span><span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Transforms `exog` to a pandas DataFrame with the shape needed for Direct</span>
<span class="sd">    forecasting.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    exog : pandas Series, pandas DataFrame</span>
<span class="sd">        Exogenous variables.</span>
<span class="sd">    steps : int.</span>
<span class="sd">        Number of steps that will be predicted using exog.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    exog_transformed : pandas DataFrame</span>
<span class="sd">        Exogenous variables transformed.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`exog` must be a pandas Series or DataFrame. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
        <span class="n">exog</span> <span class="o">=</span> <span class="n">exog</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span>

    <span class="n">n_rows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span>
    <span class="n">exog_idx</span> <span class="o">=</span> <span class="n">exog</span><span class="o">.</span><span class="n">index</span>
    <span class="n">exog_transformed</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
        <span class="n">exog_column_transformed</span> <span class="o">=</span> <span class="n">exog</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span> <span class="p">:</span> <span class="n">n_rows</span> <span class="o">-</span> <span class="p">(</span><span class="n">steps</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">i</span><span class="p">),</span> <span class="p">]</span>
        <span class="n">exog_column_transformed</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">RangeIndex</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">exog_column_transformed</span><span class="p">))</span>
        <span class="n">exog_column_transformed</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">_step_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span> 
                                           <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">exog_column_transformed</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
        <span class="n">exog_transformed</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">exog_column_transformed</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">exog_transformed</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">exog_transformed</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">exog_transformed</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">exog_transformed</span> <span class="o">=</span> <span class="n">exog_column_transformed</span>

    <span class="n">exog_transformed</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">exog_idx</span><span class="p">[</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">exog_transformed</span><span class="p">):]</span>

    <span class="k">return</span> <span class="n">exog_transformed</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="skforecast.utils.utils.exog_to_direct_numpy" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">exog_to_direct_numpy</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="n">steps</span><span class="p">)</span></code>

<a href="#skforecast.utils.utils.exog_to_direct_numpy" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents first">
  
      <p>Transforms <code>exog</code> to numpy ndarray with the shape needed for Direct
forecasting.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>exog</code></td>
          <td>
                <code>numpy ndarray, shape(samples,)</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Exogenous variables.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>steps</code></td>
          <td>
                <code>int.</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of steps that will be predicted using exog.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>exog_transformed</code></td>          <td>
                <code>numpy ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Exogenous variables transformed.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>skforecast\utils\utils.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">exog_to_direct_numpy</span><span class="p">(</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span>
<span class="p">)</span><span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Transforms `exog` to numpy ndarray with the shape needed for Direct</span>
<span class="sd">    forecasting.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    exog : numpy ndarray, shape(samples,)</span>
<span class="sd">        Exogenous variables.</span>
<span class="sd">    steps : int.</span>
<span class="sd">        Number of steps that will be predicted using exog.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    exog_transformed : numpy ndarray</span>
<span class="sd">        Exogenous variables transformed.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`exog` must be a numpy ndarray. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">exog</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">exog</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">n_rows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span>
    <span class="n">exog_transformed</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
        <span class="n">exog_column_transformed</span> <span class="o">=</span> <span class="n">exog</span><span class="p">[</span><span class="n">i</span> <span class="p">:</span> <span class="n">n_rows</span> <span class="o">-</span> <span class="p">(</span><span class="n">steps</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">i</span><span class="p">)]</span>
        <span class="n">exog_transformed</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">exog_column_transformed</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">exog_transformed</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">exog_transformed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">exog_transformed</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">exog_transformed</span> <span class="o">=</span> <span class="n">exog_column_transformed</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">exog_transformed</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="skforecast.utils.utils.expand_index" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">expand_index</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">steps</span><span class="p">)</span></code>

<a href="#skforecast.utils.utils.expand_index" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents first">
  
      <p>Create a new index of length <code>steps</code> starting at the end of the index.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>index</code></td>
          <td>
                <code>pandas Index, None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Original index.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>steps</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of steps to expand.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>new_index</code></td>          <td>
                <code>pandas Index</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>New index.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>skforecast\utils\utils.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">expand_index</span><span class="p">(</span>
    <span class="n">index</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span> 
    <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a new index of length `steps` starting at the end of the index.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    index : pandas Index, None</span>
<span class="sd">        Original index.</span>
<span class="sd">    steps : int</span>
<span class="sd">        Number of steps to expand.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    new_index : pandas Index</span>
<span class="sd">        New index.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">):</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">):</span>
            <span class="n">new_index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span>
                            <span class="n">start</span>   <span class="o">=</span> <span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">index</span><span class="o">.</span><span class="n">freq</span><span class="p">,</span>
                            <span class="n">periods</span> <span class="o">=</span> <span class="n">steps</span><span class="p">,</span>
                            <span class="n">freq</span>    <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">freq</span>
                        <span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">RangeIndex</span><span class="p">):</span>
            <span class="n">new_index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">RangeIndex</span><span class="p">(</span>
                            <span class="n">start</span> <span class="o">=</span> <span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                            <span class="n">stop</span>  <span class="o">=</span> <span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">steps</span>
                        <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="s2">&quot;Argument `index` must be a pandas DatetimeIndex or RangeIndex.&quot;</span>
            <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">new_index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">RangeIndex</span><span class="p">(</span>
                        <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="n">stop</span>  <span class="o">=</span> <span class="n">steps</span>
                    <span class="p">)</span>

    <span class="k">return</span> <span class="n">new_index</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="skforecast.utils.utils.transform_series" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">transform_series</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="n">transformer</span><span class="p">,</span> <span class="n">fit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inverse_transform</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#skforecast.utils.utils.transform_series" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents first">
  
      <p>Transform raw values of pandas Series with a scikit-learn alike transformer
(preprocessor). The transformer used must have the following methods: fit, 
transform, fit_transform and inverse_transform. ColumnTransformers are not 
allowed since they do not have inverse_transform method.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>series</code></td>
          <td>
                <code>pandas Series</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Series to be transformed.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>transformer</code></td>
          <td>
                <code>scikit-learn alike transformer (preprocessor).</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>scikit-learn alike transformer (preprocessor) with methods: fit, transform,
fit_transform and inverse_transform. ColumnTransformers are not allowed 
since they do not have inverse_transform method.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>fit</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Train the transformer before applying it.</p>
            </div>
          </td>
          <td>
                <code>`False`</code>
          </td>
        </tr>
        <tr>
          <td><code>inverse_transform</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Transform back the data to the original representation.</p>
            </div>
          </td>
          <td>
                <code>`False`</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>series_transformed</code></td>          <td>
                <code>pandas Series, pandas DataFrame</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Transformed Series. Depending on the transformer used, the output may 
be a Series or a DataFrame.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>skforecast\utils\utils.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">transform_series</span><span class="p">(</span>
    <span class="n">series</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
    <span class="n">transformer</span><span class="p">,</span>
    <span class="n">fit</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">inverse_transform</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;      </span>
<span class="sd">    Transform raw values of pandas Series with a scikit-learn alike transformer</span>
<span class="sd">    (preprocessor). The transformer used must have the following methods: fit, </span>
<span class="sd">    transform, fit_transform and inverse_transform. ColumnTransformers are not </span>
<span class="sd">    allowed since they do not have inverse_transform method.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    series : pandas Series</span>
<span class="sd">        Series to be transformed.</span>
<span class="sd">    transformer : scikit-learn alike transformer (preprocessor).</span>
<span class="sd">        scikit-learn alike transformer (preprocessor) with methods: fit, transform,</span>
<span class="sd">        fit_transform and inverse_transform. ColumnTransformers are not allowed </span>
<span class="sd">        since they do not have inverse_transform method.</span>
<span class="sd">    fit : bool, default `False`</span>
<span class="sd">        Train the transformer before applying it.</span>
<span class="sd">    inverse_transform : bool, default `False`</span>
<span class="sd">        Transform back the data to the original representation.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    series_transformed : pandas Series, pandas DataFrame</span>
<span class="sd">        Transformed Series. Depending on the transformer used, the output may </span>
<span class="sd">        be a Series or a DataFrame.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`series` argument must be a pandas Series. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">series</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">transformer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">series</span>

    <span class="k">if</span> <span class="n">series</span><span class="o">.</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">series</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;no_name&#39;</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">fit</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">transformer</span><span class="p">,</span> <span class="s1">&#39;fit&#39;</span><span class="p">):</span>
        <span class="n">transformer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="c1"># If argument feature_names_in_ exits, is overwritten to allow using the </span>
    <span class="c1"># transformer on other series than those that were passed during fit.</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">transformer</span><span class="p">,</span> <span class="s1">&#39;feature_names_in_&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">transformer</span><span class="o">.</span><span class="n">feature_names_in_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="n">transformer</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">transformer</span><span class="p">)</span>
        <span class="n">transformer</span><span class="o">.</span><span class="n">feature_names_in_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">inverse_transform</span><span class="p">:</span>
        <span class="n">values_transformed</span> <span class="o">=</span> <span class="n">transformer</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">values_transformed</span> <span class="o">=</span> <span class="n">transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>   

    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">values_transformed</span><span class="p">,</span> <span class="s1">&#39;toarray&#39;</span><span class="p">):</span>
        <span class="c1"># If the returned values are in sparse matrix format, it is converted to dense array.</span>
        <span class="n">values_transformed</span> <span class="o">=</span> <span class="n">values_transformed</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values_transformed</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="ow">and</span> <span class="n">values_transformed</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">series_transformed</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span>
                                 <span class="n">data</span>  <span class="o">=</span> <span class="n">values_transformed</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
                                 <span class="n">index</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                                 <span class="n">name</span>  <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                             <span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values_transformed</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="ow">and</span> <span class="n">values_transformed</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">series_transformed</span> <span class="o">=</span> <span class="n">values_transformed</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">series_transformed</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
                                 <span class="n">data</span>    <span class="o">=</span> <span class="n">values_transformed</span><span class="p">,</span>
                                 <span class="n">index</span>   <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                                 <span class="n">columns</span> <span class="o">=</span> <span class="n">transformer</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">()</span>
                             <span class="p">)</span>

    <span class="k">return</span> <span class="n">series_transformed</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="skforecast.utils.utils.transform_dataframe" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">transform_dataframe</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">transformer</span><span class="p">,</span> <span class="n">fit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inverse_transform</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#skforecast.utils.utils.transform_dataframe" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents first">
  
      <p>Transform raw values of pandas DataFrame with a scikit-learn alike
transformer, preprocessor or ColumnTransformer. <code>inverse_transform</code> is not 
available when using ColumnTransformers.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>df</code></td>
          <td>
                <code>pandas DataFrame</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>DataFrame to be transformed.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>transformer</code></td>
          <td>
                <code>scikit-learn alike transformer, preprocessor or ColumnTransformer.</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>scikit-learn alike transformer, preprocessor or ColumnTransformer.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>fit</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Train the transformer before applying it.</p>
            </div>
          </td>
          <td>
                <code>`False`</code>
          </td>
        </tr>
        <tr>
          <td><code>inverse_transform</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Transform back the data to the original representation. This is not available
when using transformers of class scikit-learn ColumnTransformers.</p>
            </div>
          </td>
          <td>
                <code>`False`</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>df_transformed</code></td>          <td>
                <code>pandas DataFrame</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Transformed DataFrame.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>skforecast\utils\utils.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">transform_dataframe</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">transformer</span><span class="p">,</span>
    <span class="n">fit</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">inverse_transform</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;      </span>
<span class="sd">    Transform raw values of pandas DataFrame with a scikit-learn alike</span>
<span class="sd">    transformer, preprocessor or ColumnTransformer. `inverse_transform` is not </span>
<span class="sd">    available when using ColumnTransformers.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    df : pandas DataFrame</span>
<span class="sd">        DataFrame to be transformed.</span>
<span class="sd">    transformer : scikit-learn alike transformer, preprocessor or ColumnTransformer.</span>
<span class="sd">        scikit-learn alike transformer, preprocessor or ColumnTransformer.</span>
<span class="sd">    fit : bool, default `False`</span>
<span class="sd">        Train the transformer before applying it.</span>
<span class="sd">    inverse_transform : bool, default `False`</span>
<span class="sd">        Transform back the data to the original representation. This is not available</span>
<span class="sd">        when using transformers of class scikit-learn ColumnTransformers.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    df_transformed : pandas DataFrame</span>
<span class="sd">        Transformed DataFrame.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;`df` argument must be a pandas DataFrame. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">transformer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">df</span>

    <span class="k">if</span> <span class="n">inverse_transform</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">transformer</span><span class="p">,</span> <span class="n">ColumnTransformer</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
            <span class="s2">&quot;`inverse_transform` is not available when using ColumnTransformers.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">inverse_transform</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">fit</span><span class="p">:</span>
            <span class="n">values_transformed</span> <span class="o">=</span> <span class="n">transformer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">values_transformed</span> <span class="o">=</span> <span class="n">transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">values_transformed</span> <span class="o">=</span> <span class="n">transformer</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">values_transformed</span><span class="p">,</span> <span class="s1">&#39;toarray&#39;</span><span class="p">):</span>
        <span class="c1"># If the returned values are in sparse matrix format, it is converted to dense</span>
        <span class="n">values_transformed</span> <span class="o">=</span> <span class="n">values_transformed</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>

    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">transformer</span><span class="p">,</span> <span class="s1">&#39;get_feature_names_out&#39;</span><span class="p">):</span>
        <span class="n">feature_names_out</span> <span class="o">=</span> <span class="n">transformer</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">()</span>
    <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">transformer</span><span class="p">,</span> <span class="s1">&#39;categories_&#39;</span><span class="p">):</span>   
        <span class="n">feature_names_out</span> <span class="o">=</span> <span class="n">transformer</span><span class="o">.</span><span class="n">categories_</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">feature_names_out</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span>

    <span class="n">df_transformed</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
                         <span class="n">data</span>    <span class="o">=</span> <span class="n">values_transformed</span><span class="p">,</span>
                         <span class="n">index</span>   <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                         <span class="n">columns</span> <span class="o">=</span> <span class="n">feature_names_out</span>
                     <span class="p">)</span>

    <span class="k">return</span> <span class="n">df_transformed</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="skforecast.utils.utils.check_optional_dependency" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">check_optional_dependency</span><span class="p">(</span><span class="n">package_name</span><span class="p">)</span></code>

<a href="#skforecast.utils.utils.check_optional_dependency" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents first">
  
      <p>Check if an optional dependency is installed, if not raise an ImportError<br />
with installation instructions.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>package_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of the package to check.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>None</code>
          </td>
          <td>
            <div class="doc-md-description">
              
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>skforecast\utils\utils.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span>
<span class="normal">1698</span>
<span class="normal">1699</span>
<span class="normal">1700</span>
<span class="normal">1701</span>
<span class="normal">1702</span>
<span class="normal">1703</span>
<span class="normal">1704</span>
<span class="normal">1705</span>
<span class="normal">1706</span>
<span class="normal">1707</span>
<span class="normal">1708</span>
<span class="normal">1709</span>
<span class="normal">1710</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">check_optional_dependency</span><span class="p">(</span>
    <span class="n">package_name</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check if an optional dependency is installed, if not raise an ImportError  </span>
<span class="sd">    with installation instructions.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    package_name : str</span>
<span class="sd">        Name of the package to check.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">importlib</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">find_spec</span><span class="p">(</span><span class="n">package_name</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">extra</span><span class="p">,</span> <span class="n">package_version</span> <span class="o">=</span> <span class="n">_find_optional_dependency</span><span class="p">(</span><span class="n">package_name</span><span class="o">=</span><span class="n">package_name</span><span class="p">)</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&#39;</span><span class="si">{</span><span class="n">package_name</span><span class="si">}</span><span class="s2">&#39; is an optional dependency not included in the default &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;skforecast installation. Please run: `pip install </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">package_version</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">` to install it.&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Alternately, you can install it by running `pip install skforecast[</span><span class="si">{</span><span class="n">extra</span><span class="si">}</span><span class="s2">]`&quot;</span>
            <span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&#39;</span><span class="si">{</span><span class="n">package_name</span><span class="si">}</span><span class="s2">&#39; is needed but not installed. Please install it.&quot;</span>

        <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="skforecast.utils.utils.multivariate_time_series_corr" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">multivariate_time_series_corr</span><span class="p">(</span><span class="n">time_series</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">lags</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;pearson&#39;</span><span class="p">)</span></code>

<a href="#skforecast.utils.utils.multivariate_time_series_corr" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents first">
  
      <p>Compute correlation between a time_series and the lagged values of other 
time series. </p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>time_series</code></td>
          <td>
                <code>pandas Series</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Target time series.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>other</code></td>
          <td>
                <code>pandas DataFrame</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Time series whose lagged values are correlated to <code>time_series</code>.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>lags</code></td>
          <td>
                <code>int, list, numpy ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Lags to be included in the correlation analysis.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>method</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <ul>
<li>'pearson': standard correlation coefficient.</li>
<li>'kendall': Kendall Tau correlation coefficient.</li>
<li>'spearman': Spearman rank correlation.</li>
</ul>
            </div>
          </td>
          <td>
                <code>&#39;pearson&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>corr</code></td>          <td>
                <code>pandas DataFrame</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Correlation values.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>skforecast\utils\utils.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1713</span>
<span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span>
<span class="normal">1717</span>
<span class="normal">1718</span>
<span class="normal">1719</span>
<span class="normal">1720</span>
<span class="normal">1721</span>
<span class="normal">1722</span>
<span class="normal">1723</span>
<span class="normal">1724</span>
<span class="normal">1725</span>
<span class="normal">1726</span>
<span class="normal">1727</span>
<span class="normal">1728</span>
<span class="normal">1729</span>
<span class="normal">1730</span>
<span class="normal">1731</span>
<span class="normal">1732</span>
<span class="normal">1733</span>
<span class="normal">1734</span>
<span class="normal">1735</span>
<span class="normal">1736</span>
<span class="normal">1737</span>
<span class="normal">1738</span>
<span class="normal">1739</span>
<span class="normal">1740</span>
<span class="normal">1741</span>
<span class="normal">1742</span>
<span class="normal">1743</span>
<span class="normal">1744</span>
<span class="normal">1745</span>
<span class="normal">1746</span>
<span class="normal">1747</span>
<span class="normal">1748</span>
<span class="normal">1749</span>
<span class="normal">1750</span>
<span class="normal">1751</span>
<span class="normal">1752</span>
<span class="normal">1753</span>
<span class="normal">1754</span>
<span class="normal">1755</span>
<span class="normal">1756</span>
<span class="normal">1757</span>
<span class="normal">1758</span>
<span class="normal">1759</span>
<span class="normal">1760</span>
<span class="normal">1761</span>
<span class="normal">1762</span>
<span class="normal">1763</span>
<span class="normal">1764</span>
<span class="normal">1765</span>
<span class="normal">1766</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">multivariate_time_series_corr</span><span class="p">(</span>
    <span class="n">time_series</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
    <span class="n">other</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">lags</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">],</span>
    <span class="n">method</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s1">&#39;pearson&#39;</span>
<span class="p">)</span><span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute correlation between a time_series and the lagged values of other </span>
<span class="sd">    time series. </span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    time_series : pandas Series</span>
<span class="sd">        Target time series.</span>
<span class="sd">    other : pandas DataFrame</span>
<span class="sd">        Time series whose lagged values are correlated to `time_series`.</span>
<span class="sd">    lags : int, list, numpy ndarray</span>
<span class="sd">        Lags to be included in the correlation analysis.</span>
<span class="sd">    method : str, default &#39;pearson&#39;</span>
<span class="sd">        - &#39;pearson&#39;: standard correlation coefficient.</span>
<span class="sd">        - &#39;kendall&#39;: Kendall Tau correlation coefficient.</span>
<span class="sd">        - &#39;spearman&#39;: Spearman rank correlation.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    corr : pandas DataFrame</span>
<span class="sd">        Correlation values.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">time_series</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`time_series` and `other` must have the same length.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">time_series</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`time_series` and `other` must have the same index.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lags</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="n">lags</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">lags</span><span class="p">)</span>

    <span class="n">corr</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">lag_values</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">lag</span> <span class="ow">in</span> <span class="n">lags</span><span class="p">:</span>
            <span class="n">lag_values</span><span class="p">[</span><span class="n">lag</span><span class="p">]</span> <span class="o">=</span> <span class="n">other</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">lag</span><span class="p">)</span>

        <span class="n">lag_values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">lag_values</span><span class="p">)</span>
        <span class="n">lag_values</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">time_series</span><span class="p">)</span>
        <span class="n">corr</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">lag_values</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">0</span><span class="p">]</span>

    <span class="n">corr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">corr</span><span class="p">)</span>
    <span class="n">corr</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">corr</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int64&#39;</span><span class="p">)</span>
    <span class="n">corr</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;lag&quot;</span>

    <span class="k">return</span> <span class="n">corr</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="skforecast.utils.utils.check_backtesting_input" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">check_backtesting_input</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">steps</span><span class="p">,</span> <span class="n">metric</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">series</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">initial_train_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fixed_train_size</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">gap</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">allow_incomplete_fold</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">refit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_boot</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span> <span class="n">in_sample_residuals</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">suppress_warnings</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#skforecast.utils.utils.check_backtesting_input" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents first">
  
      <p>This is a helper function to check most inputs of backtesting functions in 
modules <code>model_selection</code>, <code>model_selection_multiseries</code> and 
<code>model_selection_sarimax</code>.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>forecaster</code></td>
          <td>
                <code>Forecaster</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Forecaster model.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>steps</code></td>
          <td>
                <code>(int, list)</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of future steps predicted.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>metric</code></td>
          <td>
                <code>(str, <span title="typing.Callable">Callable</span>, list)</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Metric used to quantify the goodness of fit of the model.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>y</code></td>
          <td>
                <code>pandas Series</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Training time series for uni-series forecasters.</p>
            </div>
          </td>
          <td>
                <code>`None`</code>
          </td>
        </tr>
        <tr>
          <td><code>series</code></td>
          <td>
                <code>pandas DataFrame, dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Training time series for multi-series forecasters.</p>
            </div>
          </td>
          <td>
                <code>`None`</code>
          </td>
        </tr>
        <tr>
          <td><code>exog</code></td>
          <td>
                <code>pandas Series, pandas DataFrame, dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Exogenous variables.</p>
            </div>
          </td>
          <td>
                <code>`None`</code>
          </td>
        </tr>
        <tr>
          <td><code>initial_train_size</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of samples in the initial train split. If <code>None</code> and <code>forecaster</code> 
is already trained, no initial train is done and all data is used to 
evaluate the model.</p>
            </div>
          </td>
          <td>
                <code>`None`</code>
          </td>
        </tr>
        <tr>
          <td><code>fixed_train_size</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If True, train size doesn't increase but moves by <code>steps</code> in each iteration.</p>
            </div>
          </td>
          <td>
                <code>`True`</code>
          </td>
        </tr>
        <tr>
          <td><code>gap</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of samples to be excluded after the end of each training set and 
before the test set.</p>
            </div>
          </td>
          <td>
                <code>`0`</code>
          </td>
        </tr>
        <tr>
          <td><code>allow_incomplete_fold</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Last fold is allowed to have a smaller number of samples than the 
<code>test_size</code>. If <code>False</code>, the last fold is excluded.</p>
            </div>
          </td>
          <td>
                <code>`True`</code>
          </td>
        </tr>
        <tr>
          <td><code>refit</code></td>
          <td>
                <code>(bool, int)</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to re-fit the forecaster in each iteration. If <code>refit</code> is an 
integer, the Forecaster will be trained every that number of iterations.</p>
            </div>
          </td>
          <td>
                <code>`False`</code>
          </td>
        </tr>
        <tr>
          <td><code>interval</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Confidence of the prediction interval estimated. Sequence of percentiles
to compute, which must be between 0 and 100 inclusive.</p>
            </div>
          </td>
          <td>
                <code>`None`</code>
          </td>
        </tr>
        <tr>
          <td><code>alpha</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The confidence intervals used in ForecasterSarimax are (1 - alpha) %.</p>
            </div>
          </td>
          <td>
                <code>`None`</code>
          </td>
        </tr>
        <tr>
          <td><code>n_boot</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of bootstrapping iterations used to estimate prediction
intervals.</p>
            </div>
          </td>
          <td>
                <code>`500`</code>
          </td>
        </tr>
        <tr>
          <td><code>random_state</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Sets a seed to the random generator, so that boot intervals are always 
deterministic.</p>
            </div>
          </td>
          <td>
                <code>`123`</code>
          </td>
        </tr>
        <tr>
          <td><code>in_sample_residuals</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>True</code>, residuals from the training data are used as proxy of prediction 
error to create prediction intervals.  If <code>False</code>, out_sample_residuals 
are used if they are already stored inside the forecaster.</p>
            </div>
          </td>
          <td>
                <code>`True`</code>
          </td>
        </tr>
        <tr>
          <td><code>n_jobs</code></td>
          <td>
                <code>(int, auto)</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The number of jobs to run in parallel. If <code>-1</code>, then the number of jobs is 
set to the number of cores. If 'auto', <code>n_jobs</code> is set using the fuction
skforecast.utils.select_n_jobs_fit_forecaster.
<strong>New in version 0.9.0</strong></p>
            </div>
          </td>
          <td>
                <code>`&#39;auto&#39;`</code>
          </td>
        </tr>
        <tr>
          <td><code>verbose</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Print number of folds and index of training and validation sets used 
for backtesting.</p>
            </div>
          </td>
          <td>
                <code>`False`</code>
          </td>
        </tr>
        <tr>
          <td><code>show_progress</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to show a progress bar.</p>
            </div>
          </td>
          <td>
                <code>`True`</code>
          </td>
        </tr>
        <tr>
          <td><code>suppress_warnings</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>True</code>, skforecast warnings will be suppressed during the backtesting 
process. See skforecast.exceptions.warn_skforecast_categories for more
information.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>None</code>
          </td>
          <td>
            <div class="doc-md-description">
              
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>skforecast\utils\utils.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1769</span>
<span class="normal">1770</span>
<span class="normal">1771</span>
<span class="normal">1772</span>
<span class="normal">1773</span>
<span class="normal">1774</span>
<span class="normal">1775</span>
<span class="normal">1776</span>
<span class="normal">1777</span>
<span class="normal">1778</span>
<span class="normal">1779</span>
<span class="normal">1780</span>
<span class="normal">1781</span>
<span class="normal">1782</span>
<span class="normal">1783</span>
<span class="normal">1784</span>
<span class="normal">1785</span>
<span class="normal">1786</span>
<span class="normal">1787</span>
<span class="normal">1788</span>
<span class="normal">1789</span>
<span class="normal">1790</span>
<span class="normal">1791</span>
<span class="normal">1792</span>
<span class="normal">1793</span>
<span class="normal">1794</span>
<span class="normal">1795</span>
<span class="normal">1796</span>
<span class="normal">1797</span>
<span class="normal">1798</span>
<span class="normal">1799</span>
<span class="normal">1800</span>
<span class="normal">1801</span>
<span class="normal">1802</span>
<span class="normal">1803</span>
<span class="normal">1804</span>
<span class="normal">1805</span>
<span class="normal">1806</span>
<span class="normal">1807</span>
<span class="normal">1808</span>
<span class="normal">1809</span>
<span class="normal">1810</span>
<span class="normal">1811</span>
<span class="normal">1812</span>
<span class="normal">1813</span>
<span class="normal">1814</span>
<span class="normal">1815</span>
<span class="normal">1816</span>
<span class="normal">1817</span>
<span class="normal">1818</span>
<span class="normal">1819</span>
<span class="normal">1820</span>
<span class="normal">1821</span>
<span class="normal">1822</span>
<span class="normal">1823</span>
<span class="normal">1824</span>
<span class="normal">1825</span>
<span class="normal">1826</span>
<span class="normal">1827</span>
<span class="normal">1828</span>
<span class="normal">1829</span>
<span class="normal">1830</span>
<span class="normal">1831</span>
<span class="normal">1832</span>
<span class="normal">1833</span>
<span class="normal">1834</span>
<span class="normal">1835</span>
<span class="normal">1836</span>
<span class="normal">1837</span>
<span class="normal">1838</span>
<span class="normal">1839</span>
<span class="normal">1840</span>
<span class="normal">1841</span>
<span class="normal">1842</span>
<span class="normal">1843</span>
<span class="normal">1844</span>
<span class="normal">1845</span>
<span class="normal">1846</span>
<span class="normal">1847</span>
<span class="normal">1848</span>
<span class="normal">1849</span>
<span class="normal">1850</span>
<span class="normal">1851</span>
<span class="normal">1852</span>
<span class="normal">1853</span>
<span class="normal">1854</span>
<span class="normal">1855</span>
<span class="normal">1856</span>
<span class="normal">1857</span>
<span class="normal">1858</span>
<span class="normal">1859</span>
<span class="normal">1860</span>
<span class="normal">1861</span>
<span class="normal">1862</span>
<span class="normal">1863</span>
<span class="normal">1864</span>
<span class="normal">1865</span>
<span class="normal">1866</span>
<span class="normal">1867</span>
<span class="normal">1868</span>
<span class="normal">1869</span>
<span class="normal">1870</span>
<span class="normal">1871</span>
<span class="normal">1872</span>
<span class="normal">1873</span>
<span class="normal">1874</span>
<span class="normal">1875</span>
<span class="normal">1876</span>
<span class="normal">1877</span>
<span class="normal">1878</span>
<span class="normal">1879</span>
<span class="normal">1880</span>
<span class="normal">1881</span>
<span class="normal">1882</span>
<span class="normal">1883</span>
<span class="normal">1884</span>
<span class="normal">1885</span>
<span class="normal">1886</span>
<span class="normal">1887</span>
<span class="normal">1888</span>
<span class="normal">1889</span>
<span class="normal">1890</span>
<span class="normal">1891</span>
<span class="normal">1892</span>
<span class="normal">1893</span>
<span class="normal">1894</span>
<span class="normal">1895</span>
<span class="normal">1896</span>
<span class="normal">1897</span>
<span class="normal">1898</span>
<span class="normal">1899</span>
<span class="normal">1900</span>
<span class="normal">1901</span>
<span class="normal">1902</span>
<span class="normal">1903</span>
<span class="normal">1904</span>
<span class="normal">1905</span>
<span class="normal">1906</span>
<span class="normal">1907</span>
<span class="normal">1908</span>
<span class="normal">1909</span>
<span class="normal">1910</span>
<span class="normal">1911</span>
<span class="normal">1912</span>
<span class="normal">1913</span>
<span class="normal">1914</span>
<span class="normal">1915</span>
<span class="normal">1916</span>
<span class="normal">1917</span>
<span class="normal">1918</span>
<span class="normal">1919</span>
<span class="normal">1920</span>
<span class="normal">1921</span>
<span class="normal">1922</span>
<span class="normal">1923</span>
<span class="normal">1924</span>
<span class="normal">1925</span>
<span class="normal">1926</span>
<span class="normal">1927</span>
<span class="normal">1928</span>
<span class="normal">1929</span>
<span class="normal">1930</span>
<span class="normal">1931</span>
<span class="normal">1932</span>
<span class="normal">1933</span>
<span class="normal">1934</span>
<span class="normal">1935</span>
<span class="normal">1936</span>
<span class="normal">1937</span>
<span class="normal">1938</span>
<span class="normal">1939</span>
<span class="normal">1940</span>
<span class="normal">1941</span>
<span class="normal">1942</span>
<span class="normal">1943</span>
<span class="normal">1944</span>
<span class="normal">1945</span>
<span class="normal">1946</span>
<span class="normal">1947</span>
<span class="normal">1948</span>
<span class="normal">1949</span>
<span class="normal">1950</span>
<span class="normal">1951</span>
<span class="normal">1952</span>
<span class="normal">1953</span>
<span class="normal">1954</span>
<span class="normal">1955</span>
<span class="normal">1956</span>
<span class="normal">1957</span>
<span class="normal">1958</span>
<span class="normal">1959</span>
<span class="normal">1960</span>
<span class="normal">1961</span>
<span class="normal">1962</span>
<span class="normal">1963</span>
<span class="normal">1964</span>
<span class="normal">1965</span>
<span class="normal">1966</span>
<span class="normal">1967</span>
<span class="normal">1968</span>
<span class="normal">1969</span>
<span class="normal">1970</span>
<span class="normal">1971</span>
<span class="normal">1972</span>
<span class="normal">1973</span>
<span class="normal">1974</span>
<span class="normal">1975</span>
<span class="normal">1976</span>
<span class="normal">1977</span>
<span class="normal">1978</span>
<span class="normal">1979</span>
<span class="normal">1980</span>
<span class="normal">1981</span>
<span class="normal">1982</span>
<span class="normal">1983</span>
<span class="normal">1984</span>
<span class="normal">1985</span>
<span class="normal">1986</span>
<span class="normal">1987</span>
<span class="normal">1988</span>
<span class="normal">1989</span>
<span class="normal">1990</span>
<span class="normal">1991</span>
<span class="normal">1992</span>
<span class="normal">1993</span>
<span class="normal">1994</span>
<span class="normal">1995</span>
<span class="normal">1996</span>
<span class="normal">1997</span>
<span class="normal">1998</span>
<span class="normal">1999</span>
<span class="normal">2000</span>
<span class="normal">2001</span>
<span class="normal">2002</span>
<span class="normal">2003</span>
<span class="normal">2004</span>
<span class="normal">2005</span>
<span class="normal">2006</span>
<span class="normal">2007</span>
<span class="normal">2008</span>
<span class="normal">2009</span>
<span class="normal">2010</span>
<span class="normal">2011</span>
<span class="normal">2012</span>
<span class="normal">2013</span>
<span class="normal">2014</span>
<span class="normal">2015</span>
<span class="normal">2016</span>
<span class="normal">2017</span>
<span class="normal">2018</span>
<span class="normal">2019</span>
<span class="normal">2020</span>
<span class="normal">2021</span>
<span class="normal">2022</span>
<span class="normal">2023</span>
<span class="normal">2024</span>
<span class="normal">2025</span>
<span class="normal">2026</span>
<span class="normal">2027</span>
<span class="normal">2028</span>
<span class="normal">2029</span>
<span class="normal">2030</span>
<span class="normal">2031</span>
<span class="normal">2032</span>
<span class="normal">2033</span>
<span class="normal">2034</span>
<span class="normal">2035</span>
<span class="normal">2036</span>
<span class="normal">2037</span>
<span class="normal">2038</span>
<span class="normal">2039</span>
<span class="normal">2040</span>
<span class="normal">2041</span>
<span class="normal">2042</span>
<span class="normal">2043</span>
<span class="normal">2044</span>
<span class="normal">2045</span>
<span class="normal">2046</span>
<span class="normal">2047</span>
<span class="normal">2048</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">check_backtesting_input</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
    <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="nb">list</span><span class="p">],</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">series</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">initial_train_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">fixed_train_size</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">gap</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">allow_incomplete_fold</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">refit</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">interval</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">alpha</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">n_boot</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
    <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
    <span class="n">in_sample_residuals</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">suppress_warnings</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This is a helper function to check most inputs of backtesting functions in </span>
<span class="sd">    modules `model_selection`, `model_selection_multiseries` and </span>
<span class="sd">    `model_selection_sarimax`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    forecaster : Forecaster</span>
<span class="sd">        Forecaster model.</span>
<span class="sd">    steps : int, list</span>
<span class="sd">        Number of future steps predicted.</span>
<span class="sd">    metric : str, Callable, list</span>
<span class="sd">        Metric used to quantify the goodness of fit of the model.</span>
<span class="sd">    y : pandas Series, default `None`</span>
<span class="sd">        Training time series for uni-series forecasters.</span>
<span class="sd">    series : pandas DataFrame, dict, default `None`</span>
<span class="sd">        Training time series for multi-series forecasters.</span>
<span class="sd">    exog : pandas Series, pandas DataFrame, dict, default `None`</span>
<span class="sd">        Exogenous variables.</span>
<span class="sd">    initial_train_size : int, default `None`</span>
<span class="sd">        Number of samples in the initial train split. If `None` and `forecaster` </span>
<span class="sd">        is already trained, no initial train is done and all data is used to </span>
<span class="sd">        evaluate the model.</span>
<span class="sd">    fixed_train_size : bool, default `True`</span>
<span class="sd">        If True, train size doesn&#39;t increase but moves by `steps` in each iteration.</span>
<span class="sd">    gap : int, default `0`</span>
<span class="sd">        Number of samples to be excluded after the end of each training set and </span>
<span class="sd">        before the test set.</span>
<span class="sd">    allow_incomplete_fold : bool, default `True`</span>
<span class="sd">        Last fold is allowed to have a smaller number of samples than the </span>
<span class="sd">        `test_size`. If `False`, the last fold is excluded.</span>
<span class="sd">    refit : bool, int, default `False`</span>
<span class="sd">        Whether to re-fit the forecaster in each iteration. If `refit` is an </span>
<span class="sd">        integer, the Forecaster will be trained every that number of iterations.</span>
<span class="sd">    interval : list, default `None`</span>
<span class="sd">        Confidence of the prediction interval estimated. Sequence of percentiles</span>
<span class="sd">        to compute, which must be between 0 and 100 inclusive.</span>
<span class="sd">    alpha : float, default `None`</span>
<span class="sd">        The confidence intervals used in ForecasterSarimax are (1 - alpha) %. </span>
<span class="sd">    n_boot : int, default `500`</span>
<span class="sd">        Number of bootstrapping iterations used to estimate prediction</span>
<span class="sd">        intervals.</span>
<span class="sd">    random_state : int, default `123`</span>
<span class="sd">        Sets a seed to the random generator, so that boot intervals are always </span>
<span class="sd">        deterministic.</span>
<span class="sd">    in_sample_residuals : bool, default `True`</span>
<span class="sd">        If `True`, residuals from the training data are used as proxy of prediction </span>
<span class="sd">        error to create prediction intervals.  If `False`, out_sample_residuals </span>
<span class="sd">        are used if they are already stored inside the forecaster.</span>
<span class="sd">    n_jobs : int, &#39;auto&#39;, default `&#39;auto&#39;`</span>
<span class="sd">        The number of jobs to run in parallel. If `-1`, then the number of jobs is </span>
<span class="sd">        set to the number of cores. If &#39;auto&#39;, `n_jobs` is set using the fuction</span>
<span class="sd">        skforecast.utils.select_n_jobs_fit_forecaster.</span>
<span class="sd">        **New in version 0.9.0**</span>
<span class="sd">    verbose : bool, default `False`</span>
<span class="sd">        Print number of folds and index of training and validation sets used </span>
<span class="sd">        for backtesting.</span>
<span class="sd">    show_progress : bool, default `True`</span>
<span class="sd">        Whether to show a progress bar.</span>
<span class="sd">    suppress_warnings: bool, default `False`</span>
<span class="sd">        If `True`, skforecast warnings will be suppressed during the backtesting </span>
<span class="sd">        process. See skforecast.exceptions.warn_skforecast_categories for more</span>
<span class="sd">        information.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">forecasters_uni</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;ForecasterAutoreg&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ForecasterAutoregCustom&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ForecasterAutoregDirect&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ForecasterSarimax&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ForecasterEquivalentDate&quot;</span><span class="p">,</span>
    <span class="p">]</span>
    <span class="n">forecasters_multi</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;ForecasterAutoregMultiVariate&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ForecasterRnn&quot;</span><span class="p">,</span>
    <span class="p">]</span>
    <span class="n">forecasters_multi_dict</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;ForecasterAutoregMultiSeries&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ForecasterAutoregMultiSeriesCustom&quot;</span><span class="p">,</span>
    <span class="p">]</span>

    <span class="n">forecaster_name</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">forecaster</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>

    <span class="k">if</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="n">forecasters_uni</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;`y` must be a pandas Series.&quot;</span><span class="p">)</span>
        <span class="n">data_name</span> <span class="o">=</span> <span class="s1">&#39;y&#39;</span>
        <span class="n">data_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="n">forecasters_multi</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;`series` must be a pandas DataFrame.&quot;</span><span class="p">)</span>
        <span class="n">data_name</span> <span class="o">=</span> <span class="s1">&#39;series&#39;</span>
        <span class="n">data_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">series</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="n">forecasters_multi_dict</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`series` must be a pandas DataFrame or a dict of DataFrames or Series. &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">series</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="n">data_name</span> <span class="o">=</span> <span class="s1">&#39;series&#39;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">not_valid_series</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">k</span> 
                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">series</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">))</span>
            <span class="p">]</span>
            <span class="k">if</span> <span class="n">not_valid_series</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;If `series` is a dictionary, all series must be a named &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;pandas Series or a pandas DataFrame with a single column. &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;Review series: </span><span class="si">{</span><span class="n">not_valid_series</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="n">not_valid_index</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">k</span> 
                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">series</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="k">if</span> <span class="n">not_valid_index</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;If `series` is a dictionary, all series must have a Pandas &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;DatetimeIndex as index with the same frequency. &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;Review series: </span><span class="si">{</span><span class="n">not_valid_index</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="p">)</span>

            <span class="n">indexes_freq</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">v</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">freq</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">series</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
            <span class="n">indexes_freq</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">indexes_freq</span><span class="p">))</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">indexes_freq</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;If `series` is a dictionary, all series must have a Pandas &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;DatetimeIndex as index with the same frequency. &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;Found frequencies: </span><span class="si">{</span><span class="n">indexes_freq</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="n">data_length</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">series</span><span class="p">[</span><span class="n">serie</span><span class="p">])</span> <span class="k">for</span> <span class="n">serie</span> <span class="ow">in</span> <span class="n">series</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">series</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="n">forecasters_multi_dict</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`exog` must be a pandas Series, DataFrame, dictionary of pandas &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;Series/DataFrames or None. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="n">not_valid_exog</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">k</span> 
                    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">exog</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)))</span>
                <span class="p">]</span>
                <span class="k">if</span> <span class="n">not_valid_exog</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                        <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;If `exog` is a dictionary, All exog must be a named pandas &quot;</span>
                         <span class="sa">f</span><span class="s2">&quot;Series, a pandas DataFrame or None. Review exog: </span><span class="si">{</span><span class="n">not_valid_exog</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`exog` must be a pandas Series, DataFrame or None. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
                <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">))</span> <span class="ow">or</span> <span class="n">steps</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;`steps` must be an integer greater than or equal to 1. Got </span><span class="si">{</span><span class="n">steps</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">gap</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">))</span> <span class="ow">or</span> <span class="n">gap</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;`gap` must be an integer greater than or equal to 0. Got </span><span class="si">{</span><span class="n">gap</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">metric</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`metric` must be a string, a callable function, or a list containing &quot;</span>
             <span class="sa">f</span><span class="s2">&quot;multiple strings and/or callables. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">metric</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">forecaster_name</span> <span class="o">==</span> <span class="s2">&quot;ForecasterEquivalentDate&quot;</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span>
        <span class="n">forecaster</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">tseries</span><span class="o">.</span><span class="n">offsets</span><span class="o">.</span><span class="n">DateOffset</span>
    <span class="p">):</span>
        <span class="k">pass</span>
    <span class="k">elif</span> <span class="n">initial_train_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">initial_train_size</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;If used, `initial_train_size` must be an integer greater than the &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;window_size of the forecaster. Got type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">initial_train_size</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">initial_train_size</span> <span class="o">&gt;=</span> <span class="n">data_length</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;If used, `initial_train_size` must be an integer smaller &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;than the length of `</span><span class="si">{</span><span class="n">data_name</span><span class="si">}</span><span class="s2">` (</span><span class="si">{</span><span class="n">data_length</span><span class="si">}</span><span class="s2">).&quot;</span><span class="p">)</span>
            <span class="p">)</span>    
        <span class="k">if</span> <span class="n">initial_train_size</span> <span class="o">&lt;</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">window_size</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;If used, `initial_train_size` must be an integer greater than &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;the window_size of the forecaster (</span><span class="si">{</span><span class="n">forecaster</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2">).&quot;</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">initial_train_size</span> <span class="o">+</span> <span class="n">gap</span> <span class="o">&gt;=</span> <span class="n">data_length</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The combination of initial_train_size </span><span class="si">{</span><span class="n">initial_train_size</span><span class="si">}</span><span class="s2"> and &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;gap </span><span class="si">{</span><span class="n">gap</span><span class="si">}</span><span class="s2"> cannot be greater than the length of `</span><span class="si">{</span><span class="n">data_name</span><span class="si">}</span><span class="s2">` &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">data_length</span><span class="si">}</span><span class="s2">).&quot;</span><span class="p">)</span>
            <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">forecaster_name</span> <span class="o">==</span> <span class="s1">&#39;ForecasterSarimax&#39;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`initial_train_size` must be an integer smaller than the &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;length of `</span><span class="si">{</span><span class="n">data_name</span><span class="si">}</span><span class="s2">` (</span><span class="si">{</span><span class="n">data_length</span><span class="si">}</span><span class="s2">).&quot;</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">fitted</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">NotFittedError</span><span class="p">(</span>
                    <span class="p">(</span><span class="s2">&quot;`forecaster` must be already trained if no `initial_train_size` &quot;</span>
                     <span class="s2">&quot;is provided.&quot;</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="n">refit</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;`refit` is only allowed when `initial_train_size` is not `None`.&quot;</span>
                <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fixed_train_size</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;`fixed_train_size` must be a boolean: `True`, `False`.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">allow_incomplete_fold</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;`allow_incomplete_fold` must be a boolean: `True`, `False`.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">refit</span><span class="p">,</span> <span class="p">(</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">))</span> <span class="ow">or</span> <span class="n">refit</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`refit` must be a boolean or an integer greater than 0. Got </span><span class="si">{</span><span class="n">refit</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n_boot</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">))</span> <span class="ow">or</span> <span class="n">n_boot</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`n_boot` must be an integer greater than 0. Got </span><span class="si">{</span><span class="n">n_boot</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">random_state</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">))</span> <span class="ow">or</span> <span class="n">random_state</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`random_state` must be an integer greater than 0. Got </span><span class="si">{</span><span class="n">random_state</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">in_sample_residuals</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;`in_sample_residuals` must be a boolean: `True`, `False`.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n_jobs</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="n">n_jobs</span> <span class="o">!=</span> <span class="s1">&#39;auto&#39;</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`n_jobs` must be an integer or `&#39;auto&#39;`. Got </span><span class="si">{</span><span class="n">n_jobs</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">verbose</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;`verbose` must be a boolean: `True`, `False`.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">show_progress</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;`show_progress` must be a boolean: `True`, `False`.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">suppress_warnings</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;`suppress_warnings` must be a boolean: `True`, `False`.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">interval</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">alpha</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">check_interval</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="n">interval</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">allow_incomplete_fold</span> <span class="ow">and</span> <span class="n">data_length</span> <span class="o">-</span> <span class="p">(</span><span class="n">initial_train_size</span> <span class="o">+</span> <span class="n">gap</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">steps</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;There is not enough data to evaluate </span><span class="si">{</span><span class="n">steps</span><span class="si">}</span><span class="s2"> steps in a single &quot;</span>
             <span class="sa">f</span><span class="s2">&quot;fold. Set `allow_incomplete_fold` to `True` to allow incomplete folds.</span><span class="se">\n</span><span class="s2">&quot;</span>
             <span class="sa">f</span><span class="s2">&quot;    Data available for test : </span><span class="si">{</span><span class="n">data_length</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">initial_train_size</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gap</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
             <span class="sa">f</span><span class="s2">&quot;    Steps                   : </span><span class="si">{</span><span class="n">steps</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">return</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="skforecast.utils.utils.select_n_jobs_backtesting" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">select_n_jobs_backtesting</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">refit</span><span class="p">)</span></code>

<a href="#skforecast.utils.utils.select_n_jobs_backtesting" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents first">
  
      <p>Select the optimal number of jobs to use in the backtesting process. This
selection is based on heuristics and is not guaranteed to be optimal.</p>
<p>The number of jobs is chosen as follows:</p>
<ul>
<li>If <code>refit</code> is an integer, then n_jobs=1. This is because parallelization doesn't 
work with intermittent refit.</li>
<li>If forecaster is 'ForecasterAutoreg' or 'ForecasterAutoregCustom' and
regressor is a linear regressor, then n_jobs=1.</li>
<li>If forecaster is 'ForecasterAutoreg' or 'ForecasterAutoregCustom',
regressor is not a linear regressor and refit=<code>True</code>, then
n_jobs=cpu_count().</li>
<li>If forecaster is 'ForecasterAutoreg' or 'ForecasterAutoregCustom',
regressor is not a linear regressor and refit=<code>False</code>, then
n_jobs=1.</li>
<li>If forecaster is 'ForecasterAutoregDirect' or 'ForecasterAutoregMultiVariate'
and refit=<code>True</code>, then n_jobs=cpu_count().</li>
<li>If forecaster is 'ForecasterAutoregDirect' or 'ForecasterAutoregMultiVariate'
and refit=<code>False</code>, then n_jobs=1.</li>
<li>If forecaster is 'ForecasterAutoregMultiSeries' or 
'ForecasterAutoregMultiSeriesCustom', then n_jobs=cpu_count().</li>
<li>If forecaster is 'ForecasterSarimax' or 'ForecasterEquivalentDate', 
then n_jobs=1.</li>
</ul>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>forecaster</code></td>
          <td>
                <code>Forecaster</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Forecaster model. ForecasterAutoreg, ForecasterAutoregCustom, 
ForecasterAutoregDirect, ForecasterAutoregMultiSeries, 
ForecasterAutoregMultiSeriesCustom, ForecasterAutoregMultiVariate.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>refit</code></td>
          <td>
                <code>(bool, int)</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If the forecaster is refitted during the backtesting process.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>n_jobs</code></td>          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The number of jobs to run in parallel.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>skforecast\utils\utils.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2051</span>
<span class="normal">2052</span>
<span class="normal">2053</span>
<span class="normal">2054</span>
<span class="normal">2055</span>
<span class="normal">2056</span>
<span class="normal">2057</span>
<span class="normal">2058</span>
<span class="normal">2059</span>
<span class="normal">2060</span>
<span class="normal">2061</span>
<span class="normal">2062</span>
<span class="normal">2063</span>
<span class="normal">2064</span>
<span class="normal">2065</span>
<span class="normal">2066</span>
<span class="normal">2067</span>
<span class="normal">2068</span>
<span class="normal">2069</span>
<span class="normal">2070</span>
<span class="normal">2071</span>
<span class="normal">2072</span>
<span class="normal">2073</span>
<span class="normal">2074</span>
<span class="normal">2075</span>
<span class="normal">2076</span>
<span class="normal">2077</span>
<span class="normal">2078</span>
<span class="normal">2079</span>
<span class="normal">2080</span>
<span class="normal">2081</span>
<span class="normal">2082</span>
<span class="normal">2083</span>
<span class="normal">2084</span>
<span class="normal">2085</span>
<span class="normal">2086</span>
<span class="normal">2087</span>
<span class="normal">2088</span>
<span class="normal">2089</span>
<span class="normal">2090</span>
<span class="normal">2091</span>
<span class="normal">2092</span>
<span class="normal">2093</span>
<span class="normal">2094</span>
<span class="normal">2095</span>
<span class="normal">2096</span>
<span class="normal">2097</span>
<span class="normal">2098</span>
<span class="normal">2099</span>
<span class="normal">2100</span>
<span class="normal">2101</span>
<span class="normal">2102</span>
<span class="normal">2103</span>
<span class="normal">2104</span>
<span class="normal">2105</span>
<span class="normal">2106</span>
<span class="normal">2107</span>
<span class="normal">2108</span>
<span class="normal">2109</span>
<span class="normal">2110</span>
<span class="normal">2111</span>
<span class="normal">2112</span>
<span class="normal">2113</span>
<span class="normal">2114</span>
<span class="normal">2115</span>
<span class="normal">2116</span>
<span class="normal">2117</span>
<span class="normal">2118</span>
<span class="normal">2119</span>
<span class="normal">2120</span>
<span class="normal">2121</span>
<span class="normal">2122</span>
<span class="normal">2123</span>
<span class="normal">2124</span>
<span class="normal">2125</span>
<span class="normal">2126</span>
<span class="normal">2127</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">select_n_jobs_backtesting</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
    <span class="n">refit</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Select the optimal number of jobs to use in the backtesting process. This</span>
<span class="sd">    selection is based on heuristics and is not guaranteed to be optimal.</span>

<span class="sd">    The number of jobs is chosen as follows:</span>

<span class="sd">    - If `refit` is an integer, then n_jobs=1. This is because parallelization doesn&#39;t </span>
<span class="sd">    work with intermittent refit.</span>
<span class="sd">    - If forecaster is &#39;ForecasterAutoreg&#39; or &#39;ForecasterAutoregCustom&#39; and</span>
<span class="sd">    regressor is a linear regressor, then n_jobs=1.</span>
<span class="sd">    - If forecaster is &#39;ForecasterAutoreg&#39; or &#39;ForecasterAutoregCustom&#39;,</span>
<span class="sd">    regressor is not a linear regressor and refit=`True`, then</span>
<span class="sd">    n_jobs=cpu_count().</span>
<span class="sd">    - If forecaster is &#39;ForecasterAutoreg&#39; or &#39;ForecasterAutoregCustom&#39;,</span>
<span class="sd">    regressor is not a linear regressor and refit=`False`, then</span>
<span class="sd">    n_jobs=1.</span>
<span class="sd">    - If forecaster is &#39;ForecasterAutoregDirect&#39; or &#39;ForecasterAutoregMultiVariate&#39;</span>
<span class="sd">    and refit=`True`, then n_jobs=cpu_count().</span>
<span class="sd">    - If forecaster is &#39;ForecasterAutoregDirect&#39; or &#39;ForecasterAutoregMultiVariate&#39;</span>
<span class="sd">    and refit=`False`, then n_jobs=1.</span>
<span class="sd">    - If forecaster is &#39;ForecasterAutoregMultiSeries&#39; or </span>
<span class="sd">    &#39;ForecasterAutoregMultiSeriesCustom&#39;, then n_jobs=cpu_count().</span>
<span class="sd">    - If forecaster is &#39;ForecasterSarimax&#39; or &#39;ForecasterEquivalentDate&#39;, </span>
<span class="sd">    then n_jobs=1.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    forecaster : Forecaster</span>
<span class="sd">        Forecaster model. ForecasterAutoreg, ForecasterAutoregCustom, </span>
<span class="sd">        ForecasterAutoregDirect, ForecasterAutoregMultiSeries, </span>
<span class="sd">        ForecasterAutoregMultiSeriesCustom, ForecasterAutoregMultiVariate.</span>
<span class="sd">    refit : bool, int</span>
<span class="sd">        If the forecaster is refitted during the backtesting process.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    n_jobs : int</span>
<span class="sd">        The number of jobs to run in parallel.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">forecaster_name</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">forecaster</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">forecaster</span><span class="o">.</span><span class="n">regressor</span><span class="p">,</span> <span class="n">Pipeline</span><span class="p">):</span>
        <span class="n">regressor_name</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">forecaster</span><span class="o">.</span><span class="n">regressor</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="vm">__name__</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">regressor_name</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">forecaster</span><span class="o">.</span><span class="n">regressor</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>

    <span class="n">linear_regressors</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">regressor_name</span>
        <span class="k">for</span> <span class="n">regressor_name</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">sklearn</span><span class="o">.</span><span class="n">linear_model</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">regressor_name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
    <span class="p">]</span>

    <span class="n">refit</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="n">refit</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">refit</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">refit</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="ow">and</span> <span class="n">refit</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">n_jobs</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ForecasterAutoreg&#39;</span><span class="p">,</span> <span class="s1">&#39;ForecasterAutoregCustom&#39;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">regressor_name</span> <span class="ow">in</span> <span class="n">linear_regressors</span><span class="p">:</span>
                <span class="n">n_jobs</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">n_jobs</span> <span class="o">=</span> <span class="n">joblib</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()</span> <span class="k">if</span> <span class="n">refit</span> <span class="k">else</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ForecasterAutoregDirect&#39;</span><span class="p">,</span> <span class="s1">&#39;ForecasterAutoregMultiVariate&#39;</span><span class="p">]:</span>
            <span class="n">n_jobs</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ForecasterAutoregMultiSeries&#39;</span><span class="p">,</span> <span class="s1">&#39;ForecasterAutoregMultiSeriesCustom&#39;</span><span class="p">]:</span>
            <span class="n">n_jobs</span> <span class="o">=</span> <span class="n">joblib</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ForecasterSarimax&#39;</span><span class="p">,</span> <span class="s1">&#39;ForecasterEquivalentDate&#39;</span><span class="p">]:</span>
            <span class="n">n_jobs</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">n_jobs</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">n_jobs</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="skforecast.utils.utils.select_n_jobs_fit_forecaster" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">select_n_jobs_fit_forecaster</span><span class="p">(</span><span class="n">forecaster_name</span><span class="p">,</span> <span class="n">regressor_name</span><span class="p">)</span></code>

<a href="#skforecast.utils.utils.select_n_jobs_fit_forecaster" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents first">
  
      <p>Select the optimal number of jobs to use in the fitting process. This
selection is based on heuristics and is not guaranteed to be optimal. </p>
<p>The number of jobs is chosen as follows:</p>
<ul>
<li>If forecaster_name is 'ForecasterAutoregDirect' or 'ForecasterAutoregMultiVariate'
and regressor_name is a linear regressor, then n_jobs=1, otherwise n_jobs=cpu_count().</li>
</ul>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>forecaster_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The type of Forecaster.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>regressor_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The type of regressor.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>n_jobs</code></td>          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The number of jobs to run in parallel.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>skforecast\utils\utils.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2130</span>
<span class="normal">2131</span>
<span class="normal">2132</span>
<span class="normal">2133</span>
<span class="normal">2134</span>
<span class="normal">2135</span>
<span class="normal">2136</span>
<span class="normal">2137</span>
<span class="normal">2138</span>
<span class="normal">2139</span>
<span class="normal">2140</span>
<span class="normal">2141</span>
<span class="normal">2142</span>
<span class="normal">2143</span>
<span class="normal">2144</span>
<span class="normal">2145</span>
<span class="normal">2146</span>
<span class="normal">2147</span>
<span class="normal">2148</span>
<span class="normal">2149</span>
<span class="normal">2150</span>
<span class="normal">2151</span>
<span class="normal">2152</span>
<span class="normal">2153</span>
<span class="normal">2154</span>
<span class="normal">2155</span>
<span class="normal">2156</span>
<span class="normal">2157</span>
<span class="normal">2158</span>
<span class="normal">2159</span>
<span class="normal">2160</span>
<span class="normal">2161</span>
<span class="normal">2162</span>
<span class="normal">2163</span>
<span class="normal">2164</span>
<span class="normal">2165</span>
<span class="normal">2166</span>
<span class="normal">2167</span>
<span class="normal">2168</span>
<span class="normal">2169</span>
<span class="normal">2170</span>
<span class="normal">2171</span>
<span class="normal">2172</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">select_n_jobs_fit_forecaster</span><span class="p">(</span>
    <span class="n">forecaster_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">regressor_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Select the optimal number of jobs to use in the fitting process. This</span>
<span class="sd">    selection is based on heuristics and is not guaranteed to be optimal. </span>

<span class="sd">    The number of jobs is chosen as follows:</span>

<span class="sd">    - If forecaster_name is &#39;ForecasterAutoregDirect&#39; or &#39;ForecasterAutoregMultiVariate&#39;</span>
<span class="sd">    and regressor_name is a linear regressor, then n_jobs=1, otherwise n_jobs=cpu_count().</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    forecaster_name : str</span>
<span class="sd">        The type of Forecaster.</span>
<span class="sd">    regressor_name : str</span>
<span class="sd">        The type of regressor.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    n_jobs : int</span>
<span class="sd">        The number of jobs to run in parallel.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">linear_regressors</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">regressor_name</span>
        <span class="k">for</span> <span class="n">regressor_name</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">sklearn</span><span class="o">.</span><span class="n">linear_model</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">regressor_name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
    <span class="p">]</span>

    <span class="k">if</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ForecasterAutoregDirect&#39;</span><span class="p">,</span> 
                           <span class="s1">&#39;ForecasterAutoregMultiVariate&#39;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">regressor_name</span> <span class="ow">in</span> <span class="n">linear_regressors</span><span class="p">:</span>
            <span class="n">n_jobs</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">n_jobs</span> <span class="o">=</span> <span class="n">joblib</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">n_jobs</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">n_jobs</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="skforecast.utils.utils.check_preprocess_series" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">check_preprocess_series</span><span class="p">(</span><span class="n">series</span><span class="p">)</span></code>

<a href="#skforecast.utils.utils.check_preprocess_series" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents first">
  
      <p>Check and preprocess <code>series</code> argument in <code>ForecasterAutoregMultiSeries</code> and
<code>ForecasterAutoregMultiSeriesCustom</code> classes.</p>
<ul>
<li>If <code>series</code> is a pandas DataFrame, it is converted to a dict of pandas 
Series and index is overwritten according to the rules of preprocess_y.</li>
<li>If <code>series</code> is a dict, all values are converted to pandas Series. Checks
if all index are pandas DatetimeIndex and, at least, one Series has a non-null
frequency. No multiple frequency is allowed.</li>
</ul>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>series</code></td>
          <td>
                <code>pandas DataFrame, dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Training time series.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>series_dict</code></td>          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with the series used during training.</p>
            </div>
          </td>
        </tr>
        <tr>
<td><code>series_indexes</code></td>          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with the index of each series.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>skforecast\utils\utils.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2175</span>
<span class="normal">2176</span>
<span class="normal">2177</span>
<span class="normal">2178</span>
<span class="normal">2179</span>
<span class="normal">2180</span>
<span class="normal">2181</span>
<span class="normal">2182</span>
<span class="normal">2183</span>
<span class="normal">2184</span>
<span class="normal">2185</span>
<span class="normal">2186</span>
<span class="normal">2187</span>
<span class="normal">2188</span>
<span class="normal">2189</span>
<span class="normal">2190</span>
<span class="normal">2191</span>
<span class="normal">2192</span>
<span class="normal">2193</span>
<span class="normal">2194</span>
<span class="normal">2195</span>
<span class="normal">2196</span>
<span class="normal">2197</span>
<span class="normal">2198</span>
<span class="normal">2199</span>
<span class="normal">2200</span>
<span class="normal">2201</span>
<span class="normal">2202</span>
<span class="normal">2203</span>
<span class="normal">2204</span>
<span class="normal">2205</span>
<span class="normal">2206</span>
<span class="normal">2207</span>
<span class="normal">2208</span>
<span class="normal">2209</span>
<span class="normal">2210</span>
<span class="normal">2211</span>
<span class="normal">2212</span>
<span class="normal">2213</span>
<span class="normal">2214</span>
<span class="normal">2215</span>
<span class="normal">2216</span>
<span class="normal">2217</span>
<span class="normal">2218</span>
<span class="normal">2219</span>
<span class="normal">2220</span>
<span class="normal">2221</span>
<span class="normal">2222</span>
<span class="normal">2223</span>
<span class="normal">2224</span>
<span class="normal">2225</span>
<span class="normal">2226</span>
<span class="normal">2227</span>
<span class="normal">2228</span>
<span class="normal">2229</span>
<span class="normal">2230</span>
<span class="normal">2231</span>
<span class="normal">2232</span>
<span class="normal">2233</span>
<span class="normal">2234</span>
<span class="normal">2235</span>
<span class="normal">2236</span>
<span class="normal">2237</span>
<span class="normal">2238</span>
<span class="normal">2239</span>
<span class="normal">2240</span>
<span class="normal">2241</span>
<span class="normal">2242</span>
<span class="normal">2243</span>
<span class="normal">2244</span>
<span class="normal">2245</span>
<span class="normal">2246</span>
<span class="normal">2247</span>
<span class="normal">2248</span>
<span class="normal">2249</span>
<span class="normal">2250</span>
<span class="normal">2251</span>
<span class="normal">2252</span>
<span class="normal">2253</span>
<span class="normal">2254</span>
<span class="normal">2255</span>
<span class="normal">2256</span>
<span class="normal">2257</span>
<span class="normal">2258</span>
<span class="normal">2259</span>
<span class="normal">2260</span>
<span class="normal">2261</span>
<span class="normal">2262</span>
<span class="normal">2263</span>
<span class="normal">2264</span>
<span class="normal">2265</span>
<span class="normal">2266</span>
<span class="normal">2267</span>
<span class="normal">2268</span>
<span class="normal">2269</span>
<span class="normal">2270</span>
<span class="normal">2271</span>
<span class="normal">2272</span>
<span class="normal">2273</span>
<span class="normal">2274</span>
<span class="normal">2275</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">check_preprocess_series</span><span class="p">(</span>
    <span class="n">series</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">dict</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">dict</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check and preprocess `series` argument in `ForecasterAutoregMultiSeries` and</span>
<span class="sd">    `ForecasterAutoregMultiSeriesCustom` classes.</span>

<span class="sd">    - If `series` is a pandas DataFrame, it is converted to a dict of pandas </span>
<span class="sd">    Series and index is overwritten according to the rules of preprocess_y.</span>
<span class="sd">    - If `series` is a dict, all values are converted to pandas Series. Checks</span>
<span class="sd">    if all index are pandas DatetimeIndex and, at least, one Series has a non-null</span>
<span class="sd">    frequency. No multiple frequency is allowed.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    series : pandas DataFrame, dict</span>
<span class="sd">        Training time series.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    series_dict : dict</span>
<span class="sd">        Dictionary with the series used during training.</span>
<span class="sd">    series_indexes : dict</span>
<span class="sd">        Dictionary with the index of each series.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>

        <span class="n">_</span><span class="p">,</span> <span class="n">series_index</span> <span class="o">=</span> <span class="n">preprocess_y</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">series</span><span class="p">,</span> <span class="n">return_values</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">series</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">series</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">series_index</span>
        <span class="n">series_dict</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="s2">&quot;series&quot;</span><span class="p">)</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>

        <span class="n">not_valid_series</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">k</span> 
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">series</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">))</span>
        <span class="p">]</span>
        <span class="k">if</span> <span class="n">not_valid_series</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;If `series` is a dictionary, all series must be a named &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;pandas Series or a pandas DataFrame with a single column. &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;Review series: </span><span class="si">{</span><span class="n">not_valid_series</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="n">series_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">k</span><span class="p">:</span> <span class="n">v</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">series</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="p">}</span>

        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">series_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;If `series` is a dictionary, all series must be a named &quot;</span>
                         <span class="sa">f</span><span class="s2">&quot;pandas Series or a pandas DataFrame with a single column. &quot;</span>
                         <span class="sa">f</span><span class="s2">&quot;Review series: &#39;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
                    <span class="p">)</span>
                <span class="n">series_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>

            <span class="n">series_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">k</span>

        <span class="n">not_valid_index</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">k</span> 
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">series_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="k">if</span> <span class="n">not_valid_index</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;If `series` is a dictionary, all series must have a Pandas &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;DatetimeIndex as index with the same frequency. &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;Review series: </span><span class="si">{</span><span class="n">not_valid_index</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="n">indexes_freq</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">v</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">freq</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">series_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
        <span class="n">indexes_freq</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">indexes_freq</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">indexes_freq</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;If `series` is a dictionary, all series must have a Pandas &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;DatetimeIndex as index with the same frequency. &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;Found frequencies: </span><span class="si">{</span><span class="n">indexes_freq</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`series` must be a pandas DataFrame or a dict of DataFrames or Series. &quot;</span>
             <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">series</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">series_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;All values of series &#39;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&#39; are NaN.&quot;</span><span class="p">)</span>

    <span class="n">series_indexes</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">k</span><span class="p">:</span> <span class="n">v</span><span class="o">.</span><span class="n">index</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">series_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">series_dict</span><span class="p">,</span> <span class="n">series_indexes</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="skforecast.utils.utils.check_preprocess_exog_multiseries" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">check_preprocess_exog_multiseries</span><span class="p">(</span><span class="n">input_series_is_dict</span><span class="p">,</span> <span class="n">series_indexes</span><span class="p">,</span> <span class="n">series_col_names</span><span class="p">,</span> <span class="n">exog</span><span class="p">,</span> <span class="n">exog_dict</span><span class="p">)</span></code>

<a href="#skforecast.utils.utils.check_preprocess_exog_multiseries" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents first">
  
      <p>Check and preprocess <code>exog</code> argument in <code>ForecasterAutoregMultiSeries</code> and
<code>ForecasterAutoregMultiSeriesCustom</code> classes.</p>
<ul>
<li>If input series is a pandas DataFrame (input_series_is_dict = False),<br />
checks that input exog (pandas Series, DataFrame or dict) has the same index 
(type, length and frequency). Index is overwritten according to the rules 
of preprocess_exog. Create a dict of exog with the same keys as series.</li>
<li>If input series is a dict (input_series_is_dict = True), then input 
exog must be a dict. Check exog has a pandas DatetimeIndex and convert all
values to pandas DataFrames.</li>
</ul>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_series_is_dict</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Indicates if input series argument is a dict.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>series_indexes</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with the index of each series.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>series_col_names</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Names of the series (levels) used during training.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>exog</code></td>
          <td>
                <code>pandas Series, pandas DataFrame, dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Exogenous variable/s used during training.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>exog_dict</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with the exogenous variable/s used during training.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>exog_dict</code></td>          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with the exogenous variable/s used during training.</p>
            </div>
          </td>
        </tr>
        <tr>
<td><code>exog_col_names</code></td>          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Names of the exogenous variables used during training.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>skforecast\utils\utils.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2278</span>
<span class="normal">2279</span>
<span class="normal">2280</span>
<span class="normal">2281</span>
<span class="normal">2282</span>
<span class="normal">2283</span>
<span class="normal">2284</span>
<span class="normal">2285</span>
<span class="normal">2286</span>
<span class="normal">2287</span>
<span class="normal">2288</span>
<span class="normal">2289</span>
<span class="normal">2290</span>
<span class="normal">2291</span>
<span class="normal">2292</span>
<span class="normal">2293</span>
<span class="normal">2294</span>
<span class="normal">2295</span>
<span class="normal">2296</span>
<span class="normal">2297</span>
<span class="normal">2298</span>
<span class="normal">2299</span>
<span class="normal">2300</span>
<span class="normal">2301</span>
<span class="normal">2302</span>
<span class="normal">2303</span>
<span class="normal">2304</span>
<span class="normal">2305</span>
<span class="normal">2306</span>
<span class="normal">2307</span>
<span class="normal">2308</span>
<span class="normal">2309</span>
<span class="normal">2310</span>
<span class="normal">2311</span>
<span class="normal">2312</span>
<span class="normal">2313</span>
<span class="normal">2314</span>
<span class="normal">2315</span>
<span class="normal">2316</span>
<span class="normal">2317</span>
<span class="normal">2318</span>
<span class="normal">2319</span>
<span class="normal">2320</span>
<span class="normal">2321</span>
<span class="normal">2322</span>
<span class="normal">2323</span>
<span class="normal">2324</span>
<span class="normal">2325</span>
<span class="normal">2326</span>
<span class="normal">2327</span>
<span class="normal">2328</span>
<span class="normal">2329</span>
<span class="normal">2330</span>
<span class="normal">2331</span>
<span class="normal">2332</span>
<span class="normal">2333</span>
<span class="normal">2334</span>
<span class="normal">2335</span>
<span class="normal">2336</span>
<span class="normal">2337</span>
<span class="normal">2338</span>
<span class="normal">2339</span>
<span class="normal">2340</span>
<span class="normal">2341</span>
<span class="normal">2342</span>
<span class="normal">2343</span>
<span class="normal">2344</span>
<span class="normal">2345</span>
<span class="normal">2346</span>
<span class="normal">2347</span>
<span class="normal">2348</span>
<span class="normal">2349</span>
<span class="normal">2350</span>
<span class="normal">2351</span>
<span class="normal">2352</span>
<span class="normal">2353</span>
<span class="normal">2354</span>
<span class="normal">2355</span>
<span class="normal">2356</span>
<span class="normal">2357</span>
<span class="normal">2358</span>
<span class="normal">2359</span>
<span class="normal">2360</span>
<span class="normal">2361</span>
<span class="normal">2362</span>
<span class="normal">2363</span>
<span class="normal">2364</span>
<span class="normal">2365</span>
<span class="normal">2366</span>
<span class="normal">2367</span>
<span class="normal">2368</span>
<span class="normal">2369</span>
<span class="normal">2370</span>
<span class="normal">2371</span>
<span class="normal">2372</span>
<span class="normal">2373</span>
<span class="normal">2374</span>
<span class="normal">2375</span>
<span class="normal">2376</span>
<span class="normal">2377</span>
<span class="normal">2378</span>
<span class="normal">2379</span>
<span class="normal">2380</span>
<span class="normal">2381</span>
<span class="normal">2382</span>
<span class="normal">2383</span>
<span class="normal">2384</span>
<span class="normal">2385</span>
<span class="normal">2386</span>
<span class="normal">2387</span>
<span class="normal">2388</span>
<span class="normal">2389</span>
<span class="normal">2390</span>
<span class="normal">2391</span>
<span class="normal">2392</span>
<span class="normal">2393</span>
<span class="normal">2394</span>
<span class="normal">2395</span>
<span class="normal">2396</span>
<span class="normal">2397</span>
<span class="normal">2398</span>
<span class="normal">2399</span>
<span class="normal">2400</span>
<span class="normal">2401</span>
<span class="normal">2402</span>
<span class="normal">2403</span>
<span class="normal">2404</span>
<span class="normal">2405</span>
<span class="normal">2406</span>
<span class="normal">2407</span>
<span class="normal">2408</span>
<span class="normal">2409</span>
<span class="normal">2410</span>
<span class="normal">2411</span>
<span class="normal">2412</span>
<span class="normal">2413</span>
<span class="normal">2414</span>
<span class="normal">2415</span>
<span class="normal">2416</span>
<span class="normal">2417</span>
<span class="normal">2418</span>
<span class="normal">2419</span>
<span class="normal">2420</span>
<span class="normal">2421</span>
<span class="normal">2422</span>
<span class="normal">2423</span>
<span class="normal">2424</span>
<span class="normal">2425</span>
<span class="normal">2426</span>
<span class="normal">2427</span>
<span class="normal">2428</span>
<span class="normal">2429</span>
<span class="normal">2430</span>
<span class="normal">2431</span>
<span class="normal">2432</span>
<span class="normal">2433</span>
<span class="normal">2434</span>
<span class="normal">2435</span>
<span class="normal">2436</span>
<span class="normal">2437</span>
<span class="normal">2438</span>
<span class="normal">2439</span>
<span class="normal">2440</span>
<span class="normal">2441</span>
<span class="normal">2442</span>
<span class="normal">2443</span>
<span class="normal">2444</span>
<span class="normal">2445</span>
<span class="normal">2446</span>
<span class="normal">2447</span>
<span class="normal">2448</span>
<span class="normal">2449</span>
<span class="normal">2450</span>
<span class="normal">2451</span>
<span class="normal">2452</span>
<span class="normal">2453</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">check_preprocess_exog_multiseries</span><span class="p">(</span>
    <span class="n">input_series_is_dict</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">series_indexes</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">series_col_names</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">dict</span><span class="p">],</span>
    <span class="n">exog_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">dict</span><span class="p">,</span> <span class="nb">list</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check and preprocess `exog` argument in `ForecasterAutoregMultiSeries` and</span>
<span class="sd">    `ForecasterAutoregMultiSeriesCustom` classes.</span>

<span class="sd">    - If input series is a pandas DataFrame (input_series_is_dict = False),  </span>
<span class="sd">    checks that input exog (pandas Series, DataFrame or dict) has the same index </span>
<span class="sd">    (type, length and frequency). Index is overwritten according to the rules </span>
<span class="sd">    of preprocess_exog. Create a dict of exog with the same keys as series.</span>
<span class="sd">    - If input series is a dict (input_series_is_dict = True), then input </span>
<span class="sd">    exog must be a dict. Check exog has a pandas DatetimeIndex and convert all</span>
<span class="sd">    values to pandas DataFrames.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    input_series_is_dict : bool</span>
<span class="sd">        Indicates if input series argument is a dict.</span>
<span class="sd">    series_indexes : dict</span>
<span class="sd">        Dictionary with the index of each series.</span>
<span class="sd">    series_col_names : list</span>
<span class="sd">        Names of the series (levels) used during training.</span>
<span class="sd">    exog : pandas Series, pandas DataFrame, dict</span>
<span class="sd">        Exogenous variable/s used during training.</span>
<span class="sd">    exog_dict : dict</span>
<span class="sd">        Dictionary with the exogenous variable/s used during training.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    exog_dict : dict</span>
<span class="sd">        Dictionary with the exogenous variable/s used during training.</span>
<span class="sd">    exog_col_names : list</span>
<span class="sd">        Names of the exogenous variables used during training.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`exog` must be a pandas Series, DataFrame, dictionary of pandas &quot;</span>
             <span class="sa">f</span><span class="s2">&quot;Series/DataFrames or None. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">input_series_is_dict</span><span class="p">:</span>
        <span class="c1"># If input series is a pandas DataFrame, all index are the same.</span>
        <span class="c1"># Select the first index to check exog</span>
        <span class="n">series_index</span> <span class="o">=</span> <span class="n">series_indexes</span><span class="p">[</span><span class="n">series_col_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)):</span> 

        <span class="k">if</span> <span class="n">input_series_is_dict</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`exog` must be a dict of DataFrames or Series if &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;`series` is a dict. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="n">_</span><span class="p">,</span> <span class="n">exog_index</span> <span class="o">=</span> <span class="n">preprocess_exog</span><span class="p">(</span><span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span> <span class="n">return_values</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">exog</span> <span class="o">=</span> <span class="n">exog</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="k">else</span> <span class="n">exog</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">exog</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">exog_index</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">series_index</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`exog` must have same number of samples as `series`. &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;length `exog`: (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span><span class="si">}</span><span class="s2">), length `series`: (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">series_index</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">exog_index</span> <span class="o">==</span> <span class="n">series_index</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="p">(</span><span class="s2">&quot;Different index for `series` and `exog`. They must be equal &quot;</span>
                 <span class="s2">&quot;to ensure the correct alignment of values.&quot;</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="n">exog_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">serie</span><span class="p">:</span> <span class="n">exog</span> <span class="k">for</span> <span class="n">serie</span> <span class="ow">in</span> <span class="n">series_col_names</span><span class="p">}</span>

    <span class="k">else</span><span class="p">:</span>

        <span class="n">not_valid_exog</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">k</span> 
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">exog</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)))</span>
        <span class="p">]</span>
        <span class="k">if</span> <span class="n">not_valid_exog</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;If `exog` is a dictionary, all exog must be a named pandas &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;Series, a pandas DataFrame or None. Review exog: </span><span class="si">{</span><span class="n">not_valid_exog</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="c1"># Only elements already present in exog_dict are updated</span>
        <span class="n">exog_dict</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
            <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">exog</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> 
            <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">exog_dict</span> <span class="ow">and</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="p">)</span>

        <span class="n">series_not_in_exog</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">series_col_names</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">exog</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">series_not_in_exog</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">series_not_in_exog</span><span class="si">}</span><span class="s2"> not present in `exog`. All values &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;of the exogenous variables for these series will be NaN.&quot;</span><span class="p">),</span>
                 <span class="n">MissingExogWarning</span>
            <span class="p">)</span>

        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">exog_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">check_exog</span><span class="p">(</span><span class="n">exog</span><span class="o">=</span><span class="n">v</span><span class="p">,</span> <span class="n">allow_nan</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
                    <span class="n">v</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span>
                <span class="n">exog_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">input_series_is_dict</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">exog_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">series_index</span><span class="p">):</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                            <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`exog` for series &#39;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&#39; must have same number of &quot;</span>
                             <span class="sa">f</span><span class="s2">&quot;samples as `series`. length `exog`: (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="si">}</span><span class="s2">), &quot;</span>
                             <span class="sa">f</span><span class="s2">&quot;length `series`: (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">series_index</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
                        <span class="p">)</span>

                    <span class="n">_</span><span class="p">,</span> <span class="n">v_index</span> <span class="o">=</span> <span class="n">preprocess_exog</span><span class="p">(</span><span class="n">exog</span><span class="o">=</span><span class="n">v</span><span class="p">,</span> <span class="n">return_values</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                    <span class="n">exog_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">v_index</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">exog_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="n">series_index</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                            <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Different index for series &#39;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&#39; and its exog. &quot;</span>
                             <span class="sa">f</span><span class="s2">&quot;When `series` is a pandas DataFrame, they must be &quot;</span>
                             <span class="sa">f</span><span class="s2">&quot;equal to ensure the correct alignment of values.&quot;</span><span class="p">)</span>
                        <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">not_valid_index</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">k</span>
                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">exog_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="k">if</span> <span class="n">not_valid_index</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;All exog must have a Pandas DatetimeIndex as index with the &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;same frequency. Check exog for series: </span><span class="si">{</span><span class="n">not_valid_index</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="p">)</span>

    <span class="n">exog_col_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
        <span class="nb">set</span><span class="p">(</span>
            <span class="n">column</span>
            <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">exog_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">df</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
        <span class="p">)</span>
    <span class="p">)</span>

    <span class="c1"># Check that all exog have the same dtypes for common columns</span>
    <span class="n">exog_dtype_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">col_name</span><span class="p">:</span> <span class="nb">set</span><span class="p">()</span> 
                       <span class="k">for</span> <span class="n">col_name</span> <span class="ow">in</span> <span class="n">exog_col_names</span><span class="p">}</span>
    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">exog_dict</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">col_name</span> <span class="ow">in</span> <span class="n">v</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="n">exog_dtype_dict</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">col_name</span><span class="p">,</span> <span class="n">dtypes</span> <span class="ow">in</span> <span class="n">exog_dtype_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dtypes</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Column &#39;</span><span class="si">{</span><span class="n">col_name</span><span class="si">}</span><span class="s2">&#39; has different dtypes in different exog &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;DataFrames or Series.&quot;</span><span class="p">)</span>
            <span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">exog_col_names</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">series_col_names</span><span class="p">))</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">exog_col_names</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`exog` cannot contain a column named the same as one of the &quot;</span>
             <span class="sa">f</span><span class="s2">&quot;series (column names of series).</span><span class="se">\n</span><span class="s2">&quot;</span>
             <span class="sa">f</span><span class="s2">&quot;    `series` columns : </span><span class="si">{</span><span class="n">series_col_names</span><span class="si">}</span><span class="s2">.</span><span class="se">\n</span><span class="s2">&quot;</span>
             <span class="sa">f</span><span class="s2">&quot;    `exog`   columns : </span><span class="si">{</span><span class="n">exog_col_names</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">exog_dict</span><span class="p">,</span> <span class="n">exog_col_names</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="skforecast.utils.utils.align_series_and_exog_multiseries" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">align_series_and_exog_multiseries</span><span class="p">(</span><span class="n">series_dict</span><span class="p">,</span> <span class="n">input_series_is_dict</span><span class="p">,</span> <span class="n">exog_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#skforecast.utils.utils.align_series_and_exog_multiseries" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents first">
  
      <p>Align series and exog according to their index. If needed, reindexing is
applied. Heading and trailing NaNs are removed from all series in 
<code>series_dict</code>.</p>
<ul>
<li>If input series is a pandas DataFrame (input_series_is_dict = False),<br />
input exog (pandas Series, DataFrame or dict) must have the same index 
(type, length and frequency). Reindexing is not applied.</li>
<li>If input series is a dict (input_series_is_dict = True), then input 
exog must be a dict. Both must have a pandas DatetimeIndex, but can have 
different lengths. Reindexing is applied.</li>
</ul>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>series_dict</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with the series used during training.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>input_series_is_dict</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Indicates if input series argument is a dict.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>exog_dict</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with the exogenous variable/s used during training.</p>
            </div>
          </td>
          <td>
                <code>`None`</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>series_dict</code></td>          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with the series used during training.</p>
            </div>
          </td>
        </tr>
        <tr>
<td><code>exog_dict</code></td>          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with the exogenous variable/s used during training.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>skforecast\utils\utils.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2456</span>
<span class="normal">2457</span>
<span class="normal">2458</span>
<span class="normal">2459</span>
<span class="normal">2460</span>
<span class="normal">2461</span>
<span class="normal">2462</span>
<span class="normal">2463</span>
<span class="normal">2464</span>
<span class="normal">2465</span>
<span class="normal">2466</span>
<span class="normal">2467</span>
<span class="normal">2468</span>
<span class="normal">2469</span>
<span class="normal">2470</span>
<span class="normal">2471</span>
<span class="normal">2472</span>
<span class="normal">2473</span>
<span class="normal">2474</span>
<span class="normal">2475</span>
<span class="normal">2476</span>
<span class="normal">2477</span>
<span class="normal">2478</span>
<span class="normal">2479</span>
<span class="normal">2480</span>
<span class="normal">2481</span>
<span class="normal">2482</span>
<span class="normal">2483</span>
<span class="normal">2484</span>
<span class="normal">2485</span>
<span class="normal">2486</span>
<span class="normal">2487</span>
<span class="normal">2488</span>
<span class="normal">2489</span>
<span class="normal">2490</span>
<span class="normal">2491</span>
<span class="normal">2492</span>
<span class="normal">2493</span>
<span class="normal">2494</span>
<span class="normal">2495</span>
<span class="normal">2496</span>
<span class="normal">2497</span>
<span class="normal">2498</span>
<span class="normal">2499</span>
<span class="normal">2500</span>
<span class="normal">2501</span>
<span class="normal">2502</span>
<span class="normal">2503</span>
<span class="normal">2504</span>
<span class="normal">2505</span>
<span class="normal">2506</span>
<span class="normal">2507</span>
<span class="normal">2508</span>
<span class="normal">2509</span>
<span class="normal">2510</span>
<span class="normal">2511</span>
<span class="normal">2512</span>
<span class="normal">2513</span>
<span class="normal">2514</span>
<span class="normal">2515</span>
<span class="normal">2516</span>
<span class="normal">2517</span>
<span class="normal">2518</span>
<span class="normal">2519</span>
<span class="normal">2520</span>
<span class="normal">2521</span>
<span class="normal">2522</span>
<span class="normal">2523</span>
<span class="normal">2524</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">align_series_and_exog_multiseries</span><span class="p">(</span>
    <span class="n">series_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">input_series_is_dict</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">exog_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="o">=</span><span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Align series and exog according to their index. If needed, reindexing is</span>
<span class="sd">    applied. Heading and trailing NaNs are removed from all series in </span>
<span class="sd">    `series_dict`.</span>

<span class="sd">    - If input series is a pandas DataFrame (input_series_is_dict = False),  </span>
<span class="sd">    input exog (pandas Series, DataFrame or dict) must have the same index </span>
<span class="sd">    (type, length and frequency). Reindexing is not applied.</span>
<span class="sd">    - If input series is a dict (input_series_is_dict = True), then input </span>
<span class="sd">    exog must be a dict. Both must have a pandas DatetimeIndex, but can have </span>
<span class="sd">    different lengths. Reindexing is applied.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    series_dict : dict</span>
<span class="sd">        Dictionary with the series used during training.</span>
<span class="sd">    input_series_is_dict : bool</span>
<span class="sd">        Indicates if input series argument is a dict.</span>
<span class="sd">    exog_dict : dict, default `None`</span>
<span class="sd">        Dictionary with the exogenous variable/s used during training.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    series_dict : dict</span>
<span class="sd">        Dictionary with the series used during training.</span>
<span class="sd">    exog_dict : dict</span>
<span class="sd">        Dictionary with the exogenous variable/s used during training.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">series_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>

        <span class="n">first_valid_index</span> <span class="o">=</span> <span class="n">series_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">first_valid_index</span><span class="p">()</span>
        <span class="n">last_valid_index</span> <span class="o">=</span> <span class="n">series_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">last_valid_index</span><span class="p">()</span>

        <span class="n">series_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">series_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">first_valid_index</span> <span class="p">:</span> <span class="n">last_valid_index</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">exog_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">input_series_is_dict</span><span class="p">:</span>
                <span class="n">index_intersection</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">series_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">exog_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">index_intersection</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                        <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Series &#39;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&#39; and its `exog` do not have the same index. &quot;</span>
                         <span class="sa">f</span><span class="s2">&quot;All exog values will be NaN for the period of the series.&quot;</span><span class="p">),</span>
                         <span class="n">MissingValuesWarning</span>
                    <span class="p">)</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">index_intersection</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">series_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]):</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                        <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Series &#39;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&#39; and its `exog` do not have the same length. &quot;</span>
                         <span class="sa">f</span><span class="s2">&quot;Exog values will be NaN for the not matched period of the series.&quot;</span><span class="p">),</span>
                         <span class="n">MissingValuesWarning</span>
                    <span class="p">)</span>  
                <span class="n">exog_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">exog_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">index_intersection</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">index_intersection</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">series_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]):</span>
                    <span class="n">exog_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">exog_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span>
                                       <span class="n">series_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> 
                                       <span class="n">fill_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
                                   <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">exog_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">exog_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">first_valid_index</span> <span class="p">:</span> <span class="n">last_valid_index</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">series_dict</span><span class="p">,</span> <span class="n">exog_dict</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="skforecast.utils.utils.set_skforecast_warnings" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">set_skforecast_warnings</span><span class="p">(</span><span class="n">suppress_warnings</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">)</span></code>

<a href="#skforecast.utils.utils.set_skforecast_warnings" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents first">
  
      <p>Set skforecast warnings action.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>suppress_warnings</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>True</code>, skforecast warnings will be suppressed. If <code>False</code>, skforecast
warnings will be shown as default. See 
skforecast.exceptions.warn_skforecast_categories for more information.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>action</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Action to be taken when a warning is raised. See the warnings module
for more information.</p>
            </div>
          </td>
          <td>
                <code>`&#39;default&#39;`</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>None</code>
          </td>
          <td>
            <div class="doc-md-description">
              
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>skforecast\utils\utils.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2527</span>
<span class="normal">2528</span>
<span class="normal">2529</span>
<span class="normal">2530</span>
<span class="normal">2531</span>
<span class="normal">2532</span>
<span class="normal">2533</span>
<span class="normal">2534</span>
<span class="normal">2535</span>
<span class="normal">2536</span>
<span class="normal">2537</span>
<span class="normal">2538</span>
<span class="normal">2539</span>
<span class="normal">2540</span>
<span class="normal">2541</span>
<span class="normal">2542</span>
<span class="normal">2543</span>
<span class="normal">2544</span>
<span class="normal">2545</span>
<span class="normal">2546</span>
<span class="normal">2547</span>
<span class="normal">2548</span>
<span class="normal">2549</span>
<span class="normal">2550</span>
<span class="normal">2551</span>
<span class="normal">2552</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_skforecast_warnings</span><span class="p">(</span>
    <span class="n">suppress_warnings</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">action</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s1">&#39;default&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set skforecast warnings action.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    suppress_warnings : bool</span>
<span class="sd">        If `True`, skforecast warnings will be suppressed. If `False`, skforecast</span>
<span class="sd">        warnings will be shown as default. See </span>
<span class="sd">        skforecast.exceptions.warn_skforecast_categories for more information.</span>
<span class="sd">    action : str, default `&#39;default&#39;`</span>
<span class="sd">        Action to be taken when a warning is raised. See the warnings module</span>
<span class="sd">        for more information.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">suppress_warnings</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">category</span> <span class="ow">in</span> <span class="n">warn_skforecast_categories</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="n">category</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


  




                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2021 - 2024 Joaqun Amat Rodrigo, Javier Escobar Ortiz
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            

  
    
  


  
    
  



  


<h4>Cookie consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
      
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="analytics" checked>
          <span class="task-list-indicator"></span>
          Google Analytics
        </label>
      </li>
    
      
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="github" checked>
          <span class="task-list-indicator"></span>
          GitHub
        </label>
      </li>
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout(function(){document.querySelector("[data-md-component=consent]").hidden=!1},250);var action,form=document.forms.consent;for(action of["submit","reset"])form.addEventListener(action,function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map(function(e){return[e,!0]}))),location.hash="",location.reload()})</script>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.top"], "search": "../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.6c14ae12.min.js"></script>
      
    
  </body>
</html>