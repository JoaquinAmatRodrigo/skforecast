
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Python library that eases using machine learning models as single and multi-step forecasters. It works with any regressor compatible with the scikit-learn API (XGBoost, LightGBM, Ranger...).">
      
      
        <meta name="author" content="Joaquin Amat Rodrigo and Javier Escobar Ortiz">
      
      
        <link rel="canonical" href="https://joaquinamatrodrigo.github.io/skforecast/0.13.0/api/model_selection.html">
      
      
        <link rel="prev" href="ForecasterBaseline.html">
      
      
        <link rel="next" href="model_selection_multiseries.html">
      
      
      <link rel="icon" href="../img/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.30">
    
    
      
        <title>model_selection - Skforecast Docs</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.3cba04c6.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,700,700i%7CUbuntu+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Open Sans";--md-code-font:"Ubuntu Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-GR8X9Z9LKL"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-GR8X9Z9LKL",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-GR8X9Z9LKL",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>
  
    <script>var consent;"undefined"==typeof __md_analytics||(consent=__md_get("__consent"))&&consent.analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="light" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#model_selection" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
  You're not viewing the latest version.
  <a href="../..">
    <strong>Click here to go to latest.</strong>
  </a>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),outdated=__md_get("__outdated",sessionStorage);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Skforecast Docs" class="md-header__button md-logo" aria-label="Skforecast Docs" data-md-component="logo">
      
  <img src="../img/logo-skforecast.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Skforecast Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              model_selection
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="light" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/JoaquinAmatRodrigo/skforecast" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../index.html" class="md-tabs__link">
          
  
  Home

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../introduction-forecasting/introduction-forecasting.html" class="md-tabs__link">
          
  
  Introduction to forecasting

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../quick-start/quick-start-skforecast.html" class="md-tabs__link">
          
  
  Quick start

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../user_guides/user-guides.html" class="md-tabs__link">
          
  
  User Guides

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../examples/examples.html" class="md-tabs__link">
        
  
    
  
  Examples and tutorials

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="ForecasterAutoreg.html" class="md-tabs__link">
          
  
  API Reference

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../faq/faq.html" class="md-tabs__link">
          
  
  FAQ and Tips

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../releases/releases.html" class="md-tabs__link">
        
  
    
  
  Releases

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../authors/authors.html" class="md-tabs__link">
        
  
    
  
  Authors

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Skforecast Docs" class="md-nav__button md-logo" aria-label="Skforecast Docs" data-md-component="logo">
      
  <img src="../img/logo-skforecast.png" alt="logo">

    </a>
    Skforecast Docs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/JoaquinAmatRodrigo/skforecast" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Home
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Home
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome to skforecast
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../introduction-forecasting/introduction-forecasting.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction to forecasting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../quick-start/quick-start-skforecast.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quick start
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/user-guides.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    User Guides
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/examples.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Examples and tutorials
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterAutoreg.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/faq.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FAQ and Tips
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../releases/releases.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Releases
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../authors/authors.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Authors
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Introduction to forecasting
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Introduction to forecasting
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../introduction-forecasting/introduction-forecasting.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction to forecasting
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Quick start
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Quick start
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../quick-start/quick-start-skforecast.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quick start
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../quick-start/forecaster-parameters.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Forecaster Parameters
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../quick-start/forecaster-attributes.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Forecaster Attributes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../quick-start/how-to-install.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to install
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    User Guides
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            User Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/user-guides.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Table of contents
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/input-data.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Input data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/autoregresive-forecaster.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Recursive multi-step forecasting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/direct-multi-step-forecasting.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Direct multi-step forecasting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/independent-multi-time-series-forecasting.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Global Models : Independent multi-time series forecasting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/multi-series-with-different-length-and-different_exog.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Global Models : Series with different lengths and different exogenous variables
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/dependent-multi-series-multivariate-forecasting.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Global Models : Dependent multivariate series forecasting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/forecasting-with-deep-learning-rnn-lstm.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deep learning Recurrent Neural Networks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/forecasting-sarimax-arima.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ARIMA and SARIMAX forecasting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/forecasting-baseline.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Foreasting baseline
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/exogenous-variables.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Exogenous variables
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/window-features-and-custom-features.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Window and custom features
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/weighted-time-series-forecasting.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Weighted time series forecasting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/backtesting.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Backtesting forecaster
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/metrics.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Metrics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/hyperparameter-tuning-and-lags-selection.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hyperparameter tuning and lags selection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/sklearn-transformers-and-pipeline.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Scikit-learn Transformers and Pipelines
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/probabilistic-forecasting.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Probabilistic forecasting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/categorical-features.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Categorical features
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/calendar-features.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Calendars features
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/feature-selection.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Feature selection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/forecasting-xgboost-lightgbm.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Forecasting with XGBoost and LightGBM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/forecaster-in-production.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Forecaster in production
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/save-load-forecaster.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Save and load forecaster
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/explainability.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Explainability
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/skforecast-in-GPU.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Skforecast in GPU
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/plotting.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Plotting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/datasets.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Datasets
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/examples.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Examples and tutorials
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterAutoreg.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ForecasterAutoreg
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterAutoregCustom.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ForecasterAutoregCustom
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterAutoregDirect.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ForecasterAutoregDirect
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterMultiSeries.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ForecasterMultiSeries
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterMultiSeriesCustom.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ForecasterMultiSeriesCustom
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterMultiVariate.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ForecasterMultiVariate
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterRnn.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ForecasterRnn
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterSarimax.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ForecasterSarimax
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Sarimax.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sarimax
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterBaseline.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ForecasterBaseline
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    model_selection
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="model_selection.html" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    model_selection
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection.model_selection.backtesting_forecaster" class="md-nav__link">
    <span class="md-ellipsis">
      backtesting_forecaster
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection.model_selection.grid_search_forecaster" class="md-nav__link">
    <span class="md-ellipsis">
      grid_search_forecaster
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection.model_selection.random_search_forecaster" class="md-nav__link">
    <span class="md-ellipsis">
      random_search_forecaster
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection.model_selection.bayesian_search_forecaster" class="md-nav__link">
    <span class="md-ellipsis">
      bayesian_search_forecaster
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection.model_selection.select_features" class="md-nav__link">
    <span class="md-ellipsis">
      select_features
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="model_selection_multiseries.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    model_selection_multiseries
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="model_selection_sarimax.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    model_selection_sarimax
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="preprocessing.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    preprocessing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="metrics.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    metrics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="plot.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    plot
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="utils.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="datasets.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    datasets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="exceptions.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    exceptions
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    FAQ and Tips
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            FAQ and Tips
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/faq.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Table of contents
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/time-series-differentiation.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Time series differentiation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/non-negative-predictions.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Avoid negative predictions when forecasting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/forecasting-time-series-with-missing-values.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Forecasting time series with missing values
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/cyclical-features-time-series.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cyclical features in time series
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/stacking-ensemble-models-forecasting.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Stacking (ensemble) machine learning models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/forecasting-with-delayed-historical-data.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Forecasting with delayed historical data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/time-series-aggregation.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Time series aggregation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/parallelization-skforecast.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parallelization in skforecast
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/profiling-skforecast.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Profiling skforecast
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../releases/releases.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Releases
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../authors/authors.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Authors
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection.model_selection.backtesting_forecaster" class="md-nav__link">
    <span class="md-ellipsis">
      backtesting_forecaster
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection.model_selection.grid_search_forecaster" class="md-nav__link">
    <span class="md-ellipsis">
      grid_search_forecaster
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection.model_selection.random_search_forecaster" class="md-nav__link">
    <span class="md-ellipsis">
      random_search_forecaster
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection.model_selection.bayesian_search_forecaster" class="md-nav__link">
    <span class="md-ellipsis">
      bayesian_search_forecaster
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection.model_selection.select_features" class="md-nav__link">
    <span class="md-ellipsis">
      select_features
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="model_selection"><code>model_selection</code><a class="headerlink" href="#model_selection" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-function">


<h2 id="skforecast.model_selection.model_selection.backtesting_forecaster" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">backtesting_forecaster</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">steps</span><span class="p">,</span> <span class="n">metric</span><span class="p">,</span> <span class="n">initial_train_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fixed_train_size</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">gap</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">skip_folds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">allow_incomplete_fold</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">refit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_boot</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span> <span class="n">in_sample_residuals</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">binned_residuals</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#skforecast.model_selection.model_selection.backtesting_forecaster" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">

      <p>Backtesting of forecaster model.</p>
<ul>
<li>If <code>refit</code> is <code>False</code>, the model will be trained only once using the 
<code>initial_train_size</code> first observations. </li>
<li>If <code>refit</code> is <code>True</code>, the model is trained on each iteration, increasing
the training set. </li>
<li>If <code>refit</code> is an <code>integer</code>, the model will be trained every that number 
of iterations.</li>
<li>If <code>forecaster</code> is already trained and <code>initial_train_size</code> is <code>None</code>,
no initial train will be done and all data will be used to evaluate the model.
However, the first <code>len(forecaster.last_window)</code> observations are needed
to create the initial predictors, so no predictions are calculated for them.</li>
</ul>
<p>A copy of the original forecaster is created so that it is not modified during 
the process.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>forecaster</code></td>
            <td>
                  <code>(<span title="skforecast.ForecasterAutoreg">ForecasterAutoreg</span>, <span title="skforecast.ForecasterAutoregCustom">ForecasterAutoregCustom</span>, <span title="skforecast.ForecasterAutoregDirect">ForecasterAutoregDirect</span>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Forecaster model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>y</code></td>
            <td>
                  <code>pandas Series</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training time series.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>steps</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of steps to predict.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>metric</code></td>
            <td>
                  <code>(str, <span title="typing.Callable">Callable</span>, list)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Metric used to quantify the goodness of fit of the model.</p>
<ul>
<li>If <code>string</code>: {'mean_squared_error', 'mean_absolute_error',
'mean_absolute_percentage_error', 'mean_squared_log_error',
'mean_absolute_scaled_error', 'root_mean_squared_scaled_error'}</li>
<li>If <code>Callable</code>: Function with arguments <code>y_true</code>, <code>y_pred</code> and <code>y_train</code>
(Optional) that returns a float.</li>
<li>If <code>list</code>: List containing multiple strings and/or Callables.</li>
</ul>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>initial_train_size</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of samples in the initial train split. If <code>None</code> and <code>forecaster</code> is 
already trained, no initial train is done and all data is used to evaluate the 
model. However, the first <code>len(forecaster.last_window)</code> observations are needed 
to create the initial predictors, so no predictions are calculated for them. 
This useful to backtest the model on the same data used to train it.
<code>None</code> is only allowed when <code>refit</code> is <code>False</code> and <code>forecaster</code> is already
trained.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>fixed_train_size</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, train size doesn't increase but moves by <code>steps</code> in each iteration.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>gap</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of samples to be excluded after the end of each training set and 
before the test set.</p>
              </div>
            </td>
            <td>
                  <code>`0`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>skip_folds</code></td>
            <td>
                  <code>(int, list)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>skip_folds</code> is an integer, every 'skip_folds'-th is returned. If <code>skip_folds</code>
is a list, the folds in the list are skipped. For example, if <code>skip_folds = 3</code>,
and there are 10 folds, the folds returned will be [0, 3, 6, 9]. If <code>skip_folds</code>
is a list [1, 2, 3], the folds returned will be [0, 4, 5, 6, 7, 8, 9].</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>allow_incomplete_fold</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Last fold is allowed to have a smaller number of samples than the 
<code>test_size</code>. If <code>False</code>, the last fold is excluded.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>exog</code></td>
            <td>
                  <code>pandas Series, pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variable/s included as predictor/s. Must have the same
number of observations as <code>y</code> and should be aligned so that y[i] is
regressed on exog[i].</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>refit</code></td>
            <td>
                  <code>(bool, int)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to re-fit the forecaster in each iteration. If <code>refit</code> is an integer, 
the Forecaster will be trained every that number of iterations.</p>
              </div>
            </td>
            <td>
                  <code>`False`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>interval</code></td>
            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Confidence of the prediction interval estimated. Sequence of percentiles
to compute, which must be between 0 and 100 inclusive. For example, 
interval of 95% should be as <code>interval = [2.5, 97.5]</code>. If <code>None</code>, no
intervals are estimated.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>n_boot</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of bootstrapping iterations used to estimate prediction
intervals.</p>
              </div>
            </td>
            <td>
                  <code>`500`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>random_state</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sets a seed to the random generator, so that boot intervals are always 
deterministic.</p>
              </div>
            </td>
            <td>
                  <code>`123`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>in_sample_residuals</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, residuals from the training data are used as proxy of prediction 
error to create prediction intervals. If <code>False</code>, out_sample_residuals 
are used if they are already stored inside the forecaster.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>binned_residuals</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <div class="codehilite"><pre><span></span><code><span class="k">If</span><span class="w"> </span><span class="n n-Quoted">`True`</span><span class="p">,</span><span class="w"> </span><span class="n">residuals</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="k">each</span><span class="w"> </span><span class="n">bootstrapping</span><span class="w"> </span><span class="n">iteration</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">selected</span>
<span class="n">conditioning</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">predicted</span><span class="w"> </span><span class="k">values</span><span class="p">.</span><span class="w"> </span><span class="k">If</span><span class="w"> </span><span class="n n-Quoted">`False`</span><span class="p">,</span><span class="w"> </span><span class="n">residuals</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">selected</span>
<span class="n">randomly</span><span class="w"> </span><span class="k">without</span><span class="w"> </span><span class="n">conditioning</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">predicted</span><span class="w"> </span><span class="k">values</span><span class="p">.</span>
</code></pre></div>
              </div>
            </td>
            <td>
                  <code>`False`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>n_jobs</code></td>
            <td>
                  <code>(int, auto)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of jobs to run in parallel. If <code>-1</code>, then the number of jobs is 
set to the number of cores. If 'auto', <code>n_jobs</code> is set using the function
skforecast.utils.select_n_jobs_backtesting.
<strong>New in version 0.9.0</strong></p>
              </div>
            </td>
            <td>
                  <code>`&#39;auto&#39;`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>verbose</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Print number of folds and index of training and validation sets used 
for backtesting.</p>
              </div>
            </td>
            <td>
                  <code>`False`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>show_progress</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to show a progress bar.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>metric_values</code></td>            <td>
                  <code>pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Value(s) of the metric(s).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>backtest_predictions</code></td>            <td>
                  <code>pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Value of predictions and their estimated interval if <code>interval</code> is not <code>None</code>.</p>
<ul>
<li>column pred: predictions.</li>
<li>column lower_bound: lower bound of the interval.</li>
<li>column upper_bound: upper bound of the interval.</li>
</ul>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>skforecast\model_selection\model_selection.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">backtesting_forecaster</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
    <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="nb">list</span><span class="p">],</span>
    <span class="n">initial_train_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">fixed_train_size</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">gap</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">skip_folds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_incomplete_fold</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">refit</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">interval</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">n_boot</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span>
    <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
    <span class="n">in_sample_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">binned_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Backtesting of forecaster model.</span>

<span class="sd">    - If `refit` is `False`, the model will be trained only once using the </span>
<span class="sd">    `initial_train_size` first observations. </span>
<span class="sd">    - If `refit` is `True`, the model is trained on each iteration, increasing</span>
<span class="sd">    the training set. </span>
<span class="sd">    - If `refit` is an `integer`, the model will be trained every that number </span>
<span class="sd">    of iterations.</span>
<span class="sd">    - If `forecaster` is already trained and `initial_train_size` is `None`,</span>
<span class="sd">    no initial train will be done and all data will be used to evaluate the model.</span>
<span class="sd">    However, the first `len(forecaster.last_window)` observations are needed</span>
<span class="sd">    to create the initial predictors, so no predictions are calculated for them.</span>

<span class="sd">    A copy of the original forecaster is created so that it is not modified during </span>
<span class="sd">    the process.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    forecaster : ForecasterAutoreg, ForecasterAutoregCustom, ForecasterAutoregDirect</span>
<span class="sd">        Forecaster model.</span>
<span class="sd">    y : pandas Series</span>
<span class="sd">        Training time series.</span>
<span class="sd">    steps : int</span>
<span class="sd">        Number of steps to predict.</span>
<span class="sd">    metric : str, Callable, list</span>
<span class="sd">        Metric used to quantify the goodness of fit of the model.</span>

<span class="sd">        - If `string`: {&#39;mean_squared_error&#39;, &#39;mean_absolute_error&#39;,</span>
<span class="sd">        &#39;mean_absolute_percentage_error&#39;, &#39;mean_squared_log_error&#39;,</span>
<span class="sd">        &#39;mean_absolute_scaled_error&#39;, &#39;root_mean_squared_scaled_error&#39;}</span>
<span class="sd">        - If `Callable`: Function with arguments `y_true`, `y_pred` and `y_train`</span>
<span class="sd">        (Optional) that returns a float.</span>
<span class="sd">        - If `list`: List containing multiple strings and/or Callables.</span>
<span class="sd">    initial_train_size : int, default `None`</span>
<span class="sd">        Number of samples in the initial train split. If `None` and `forecaster` is </span>
<span class="sd">        already trained, no initial train is done and all data is used to evaluate the </span>
<span class="sd">        model. However, the first `len(forecaster.last_window)` observations are needed </span>
<span class="sd">        to create the initial predictors, so no predictions are calculated for them. </span>
<span class="sd">        This useful to backtest the model on the same data used to train it.</span>
<span class="sd">        `None` is only allowed when `refit` is `False` and `forecaster` is already</span>
<span class="sd">        trained.</span>
<span class="sd">    fixed_train_size : bool, default `True`</span>
<span class="sd">        If True, train size doesn&#39;t increase but moves by `steps` in each iteration.</span>
<span class="sd">    gap : int, default `0`</span>
<span class="sd">        Number of samples to be excluded after the end of each training set and </span>
<span class="sd">        before the test set.</span>
<span class="sd">    skip_folds : int, list, default `None`</span>
<span class="sd">        If `skip_folds` is an integer, every &#39;skip_folds&#39;-th is returned. If `skip_folds`</span>
<span class="sd">        is a list, the folds in the list are skipped. For example, if `skip_folds = 3`,</span>
<span class="sd">        and there are 10 folds, the folds returned will be [0, 3, 6, 9]. If `skip_folds`</span>
<span class="sd">        is a list [1, 2, 3], the folds returned will be [0, 4, 5, 6, 7, 8, 9].</span>
<span class="sd">    allow_incomplete_fold : bool, default `True`</span>
<span class="sd">        Last fold is allowed to have a smaller number of samples than the </span>
<span class="sd">        `test_size`. If `False`, the last fold is excluded.</span>
<span class="sd">    exog : pandas Series, pandas DataFrame, default `None`</span>
<span class="sd">        Exogenous variable/s included as predictor/s. Must have the same</span>
<span class="sd">        number of observations as `y` and should be aligned so that y[i] is</span>
<span class="sd">        regressed on exog[i].</span>
<span class="sd">    refit : bool, int, default `False`</span>
<span class="sd">        Whether to re-fit the forecaster in each iteration. If `refit` is an integer, </span>
<span class="sd">        the Forecaster will be trained every that number of iterations.</span>
<span class="sd">    interval : list, default `None`</span>
<span class="sd">        Confidence of the prediction interval estimated. Sequence of percentiles</span>
<span class="sd">        to compute, which must be between 0 and 100 inclusive. For example, </span>
<span class="sd">        interval of 95% should be as `interval = [2.5, 97.5]`. If `None`, no</span>
<span class="sd">        intervals are estimated.</span>
<span class="sd">    n_boot : int, default `500`</span>
<span class="sd">        Number of bootstrapping iterations used to estimate prediction</span>
<span class="sd">        intervals.</span>
<span class="sd">    random_state : int, default `123`</span>
<span class="sd">        Sets a seed to the random generator, so that boot intervals are always </span>
<span class="sd">        deterministic.</span>
<span class="sd">    in_sample_residuals : bool, default `True`</span>
<span class="sd">        If `True`, residuals from the training data are used as proxy of prediction </span>
<span class="sd">        error to create prediction intervals. If `False`, out_sample_residuals </span>
<span class="sd">        are used if they are already stored inside the forecaster.</span>
<span class="sd">    binned_residuals : bool, default `False`</span>
<span class="sd">            If `True`, residuals used in each bootstrapping iteration are selected</span>
<span class="sd">            conditioning on the predicted values. If `False`, residuals are selected</span>
<span class="sd">            randomly without conditioning on the predicted values.</span>
<span class="sd">    n_jobs : int, &#39;auto&#39;, default `&#39;auto&#39;`</span>
<span class="sd">        The number of jobs to run in parallel. If `-1`, then the number of jobs is </span>
<span class="sd">        set to the number of cores. If &#39;auto&#39;, `n_jobs` is set using the function</span>
<span class="sd">        skforecast.utils.select_n_jobs_backtesting.</span>
<span class="sd">        **New in version 0.9.0**</span>
<span class="sd">    verbose : bool, default `False`</span>
<span class="sd">        Print number of folds and index of training and validation sets used </span>
<span class="sd">        for backtesting.</span>
<span class="sd">    show_progress : bool, default `True`</span>
<span class="sd">        Whether to show a progress bar.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    metric_values : pandas DataFrame</span>
<span class="sd">        Value(s) of the metric(s).</span>
<span class="sd">    backtest_predictions : pandas DataFrame</span>
<span class="sd">        Value of predictions and their estimated interval if `interval` is not `None`.</span>

<span class="sd">        - column pred: predictions.</span>
<span class="sd">        - column lower_bound: lower bound of the interval.</span>
<span class="sd">        - column upper_bound: upper bound of the interval.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">forecaters_allowed</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;ForecasterAutoreg&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;ForecasterAutoregCustom&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;ForecasterAutoregDirect&#39;</span><span class="p">,</span>
        <span class="s1">&#39;ForecasterEquivalentDate&#39;</span>
    <span class="p">]</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">forecaster</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">forecaters_allowed</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`forecaster` must be of type </span><span class="si">{</span><span class="n">forecaters_allowed</span><span class="si">}</span><span class="s2">, for all other types of &quot;</span>
             <span class="sa">f</span><span class="s2">&quot; forecasters use the functions available in the other `model_selection` &quot;</span>
             <span class="sa">f</span><span class="s2">&quot;modules.&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="n">check_backtesting_input</span><span class="p">(</span>
        <span class="n">forecaster</span>            <span class="o">=</span> <span class="n">forecaster</span><span class="p">,</span>
        <span class="n">steps</span>                 <span class="o">=</span> <span class="n">steps</span><span class="p">,</span>
        <span class="n">metric</span>                <span class="o">=</span> <span class="n">metric</span><span class="p">,</span>
        <span class="n">y</span>                     <span class="o">=</span> <span class="n">y</span><span class="p">,</span>
        <span class="n">initial_train_size</span>    <span class="o">=</span> <span class="n">initial_train_size</span><span class="p">,</span>
        <span class="n">fixed_train_size</span>      <span class="o">=</span> <span class="n">fixed_train_size</span><span class="p">,</span>
        <span class="n">gap</span>                   <span class="o">=</span> <span class="n">gap</span><span class="p">,</span>
        <span class="n">skip_folds</span>            <span class="o">=</span> <span class="n">skip_folds</span><span class="p">,</span>
        <span class="n">allow_incomplete_fold</span> <span class="o">=</span> <span class="n">allow_incomplete_fold</span><span class="p">,</span>
        <span class="n">refit</span>                 <span class="o">=</span> <span class="n">refit</span><span class="p">,</span>
        <span class="n">interval</span>              <span class="o">=</span> <span class="n">interval</span><span class="p">,</span>
        <span class="n">n_boot</span>                <span class="o">=</span> <span class="n">n_boot</span><span class="p">,</span>
        <span class="n">random_state</span>          <span class="o">=</span> <span class="n">random_state</span><span class="p">,</span>
        <span class="n">in_sample_residuals</span>   <span class="o">=</span> <span class="n">in_sample_residuals</span><span class="p">,</span>
        <span class="n">n_jobs</span>                <span class="o">=</span> <span class="n">n_jobs</span><span class="p">,</span>
        <span class="n">verbose</span>               <span class="o">=</span> <span class="n">verbose</span><span class="p">,</span>
        <span class="n">show_progress</span>         <span class="o">=</span> <span class="n">show_progress</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">forecaster</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;ForecasterAutoregDirect&#39;</span> <span class="ow">and</span> \
       <span class="n">forecaster</span><span class="o">.</span><span class="n">steps</span> <span class="o">&lt;</span> <span class="n">steps</span> <span class="o">+</span> <span class="n">gap</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;When using a ForecasterAutoregDirect, the combination of steps &quot;</span>
             <span class="sa">f</span><span class="s2">&quot;+ gap (</span><span class="si">{</span><span class="n">steps</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gap</span><span class="si">}</span><span class="s2">) cannot be greater than the `steps` parameter &quot;</span>
             <span class="sa">f</span><span class="s2">&quot;declared when the forecaster is initialized (</span><span class="si">{</span><span class="n">forecaster</span><span class="o">.</span><span class="n">steps</span><span class="si">}</span><span class="s2">).&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="n">metric_values</span><span class="p">,</span> <span class="n">backtest_predictions</span> <span class="o">=</span> <span class="n">_backtesting_forecaster</span><span class="p">(</span>
        <span class="n">forecaster</span>            <span class="o">=</span> <span class="n">forecaster</span><span class="p">,</span>
        <span class="n">y</span>                     <span class="o">=</span> <span class="n">y</span><span class="p">,</span>
        <span class="n">steps</span>                 <span class="o">=</span> <span class="n">steps</span><span class="p">,</span>
        <span class="n">metric</span>                <span class="o">=</span> <span class="n">metric</span><span class="p">,</span>
        <span class="n">initial_train_size</span>    <span class="o">=</span> <span class="n">initial_train_size</span><span class="p">,</span>
        <span class="n">fixed_train_size</span>      <span class="o">=</span> <span class="n">fixed_train_size</span><span class="p">,</span>
        <span class="n">gap</span>                   <span class="o">=</span> <span class="n">gap</span><span class="p">,</span>
        <span class="n">skip_folds</span>            <span class="o">=</span> <span class="n">skip_folds</span><span class="p">,</span>
        <span class="n">allow_incomplete_fold</span> <span class="o">=</span> <span class="n">allow_incomplete_fold</span><span class="p">,</span>
        <span class="n">exog</span>                  <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
        <span class="n">refit</span>                 <span class="o">=</span> <span class="n">refit</span><span class="p">,</span>
        <span class="n">interval</span>              <span class="o">=</span> <span class="n">interval</span><span class="p">,</span>
        <span class="n">n_boot</span>                <span class="o">=</span> <span class="n">n_boot</span><span class="p">,</span>
        <span class="n">random_state</span>          <span class="o">=</span> <span class="n">random_state</span><span class="p">,</span>
        <span class="n">in_sample_residuals</span>   <span class="o">=</span> <span class="n">in_sample_residuals</span><span class="p">,</span>
        <span class="n">binned_residuals</span>      <span class="o">=</span> <span class="n">binned_residuals</span><span class="p">,</span>
        <span class="n">n_jobs</span>                <span class="o">=</span> <span class="n">n_jobs</span><span class="p">,</span>
        <span class="n">verbose</span>               <span class="o">=</span> <span class="n">verbose</span><span class="p">,</span>
        <span class="n">show_progress</span>         <span class="o">=</span> <span class="n">show_progress</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">metric_values</span><span class="p">,</span> <span class="n">backtest_predictions</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="skforecast.model_selection.model_selection.grid_search_forecaster" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">grid_search_forecaster</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">steps</span><span class="p">,</span> <span class="n">metric</span><span class="p">,</span> <span class="n">initial_train_size</span><span class="p">,</span> <span class="n">fixed_train_size</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">gap</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">skip_folds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">allow_incomplete_fold</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lags_grid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">refit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_best</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">output_file</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#skforecast.model_selection.model_selection.grid_search_forecaster" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">

      <p>Exhaustive search over specified parameter values for a Forecaster object.
Validation is done using time series backtesting.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>forecaster</code></td>
            <td>
                  <code>(<span title="skforecast.ForecasterAutoreg">ForecasterAutoreg</span>, <span title="skforecast.ForecasterAutoregCustom">ForecasterAutoregCustom</span>, <span title="skforecast.ForecasterAutoregDirect">ForecasterAutoregDirect</span>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Forecaster model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>y</code></td>
            <td>
                  <code>pandas Series</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training time series.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>param_grid</code></td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary with parameters names (<code>str</code>) as keys and lists of parameter
settings to try as values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>steps</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of steps to predict.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>metric</code></td>
            <td>
                  <code>(str, <span title="typing.Callable">Callable</span>, list)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Metric used to quantify the goodness of fit of the model.</p>
<ul>
<li>If <code>string</code>: {'mean_squared_error', 'mean_absolute_error',
'mean_absolute_percentage_error', 'mean_squared_log_error',
'mean_absolute_scaled_error', 'root_mean_squared_scaled_error'}</li>
<li>If <code>Callable</code>: Function with arguments <code>y_true</code>, <code>y_pred</code> and <code>y_train</code>
(Optional) that returns a float.</li>
<li>If <code>list</code>: List containing multiple strings and/or Callables.</li>
</ul>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>initial_train_size</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of samples in the initial train split.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>fixed_train_size</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, train size doesn't increase but moves by <code>steps</code> in each iteration.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>gap</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of samples to be excluded after the end of each training set and 
before the test set.</p>
              </div>
            </td>
            <td>
                  <code>`0`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>skip_folds</code></td>
            <td>
                  <code>(int, list)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>skip_folds</code> is an integer, every 'skip_folds'-th is returned. If <code>skip_folds</code>
is a list, the folds in the list are skipped. For example, if <code>skip_folds = 3</code>,
and there are 10 folds, the folds returned will be [0, 3, 6, 9]. If <code>skip_folds</code>
is a list [1, 2, 3], the folds returned will be [0, 4, 5, 6, 7, 8, 9].</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>allow_incomplete_fold</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Last fold is allowed to have a smaller number of samples than the 
<code>test_size</code>. If <code>False</code>, the last fold is excluded.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>exog</code></td>
            <td>
                  <code>pandas Series, pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variable/s included as predictor/s. Must have the same
number of observations as <code>y</code> and should be aligned so that y[i] is
regressed on exog[i].</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>lags_grid</code></td>
            <td>
                  <code>(list, dict)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Lists of lags to try, containing int, lists, numpy ndarray, or range 
objects. If <code>dict</code>, the keys are used as labels in the <code>results</code> 
DataFrame, and the values are used as the lists of lags to try. Ignored 
if the forecaster is an instance of <code>ForecasterAutoregCustom</code> or 
<code>ForecasterAutoregMultiSeriesCustom</code>.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>refit</code></td>
            <td>
                  <code>(bool, int)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to re-fit the forecaster in each iteration. If <code>refit</code> is an integer, 
the Forecaster will be trained every that number of iterations.</p>
              </div>
            </td>
            <td>
                  <code>`False`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>return_best</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Refit the <code>forecaster</code> using the best found parameters on the whole data.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>n_jobs</code></td>
            <td>
                  <code>(int, auto)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of jobs to run in parallel. If <code>-1</code>, then the number of jobs is 
set to the number of cores. If 'auto', <code>n_jobs</code> is set using the function
skforecast.utils.select_n_jobs_backtesting.
<strong>New in version 0.9.0</strong></p>
              </div>
            </td>
            <td>
                  <code>`&#39;auto&#39;`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>verbose</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Print number of folds used for cv or backtesting.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>show_progress</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to show a progress bar.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>output_file</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specifies the filename or full path where the results should be saved. 
The results will be saved in a tab-separated values (TSV) format. If 
<code>None</code>, the results will not be saved to a file.
<strong>New in version 0.12.0</strong></p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>results</code></td>            <td>
                  <code>pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Results for each combination of parameters.</p>
<ul>
<li>column lags: lags configuration for each iteration.</li>
<li>column lags_label: descriptive label or alias for the lags.</li>
<li>column params: parameters configuration for each iteration.</li>
<li>column metric: metric value estimated for each iteration.</li>
<li>additional n columns with param = value.</li>
</ul>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>skforecast\model_selection\model_selection.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">grid_search_forecaster</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
    <span class="n">param_grid</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="nb">list</span><span class="p">],</span>
    <span class="n">initial_train_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">fixed_train_size</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">gap</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">skip_folds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_incomplete_fold</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">lags_grid</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">refit</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">return_best</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">output_file</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Exhaustive search over specified parameter values for a Forecaster object.</span>
<span class="sd">    Validation is done using time series backtesting.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    forecaster : ForecasterAutoreg, ForecasterAutoregCustom, ForecasterAutoregDirect</span>
<span class="sd">        Forecaster model.</span>
<span class="sd">    y : pandas Series</span>
<span class="sd">        Training time series. </span>
<span class="sd">    param_grid : dict</span>
<span class="sd">        Dictionary with parameters names (`str`) as keys and lists of parameter</span>
<span class="sd">        settings to try as values.</span>
<span class="sd">    steps : int</span>
<span class="sd">        Number of steps to predict.</span>
<span class="sd">    metric : str, Callable, list</span>
<span class="sd">        Metric used to quantify the goodness of fit of the model.</span>

<span class="sd">        - If `string`: {&#39;mean_squared_error&#39;, &#39;mean_absolute_error&#39;,</span>
<span class="sd">        &#39;mean_absolute_percentage_error&#39;, &#39;mean_squared_log_error&#39;,</span>
<span class="sd">        &#39;mean_absolute_scaled_error&#39;, &#39;root_mean_squared_scaled_error&#39;}</span>
<span class="sd">        - If `Callable`: Function with arguments `y_true`, `y_pred` and `y_train`</span>
<span class="sd">        (Optional) that returns a float.</span>
<span class="sd">        - If `list`: List containing multiple strings and/or Callables.</span>
<span class="sd">    initial_train_size : int </span>
<span class="sd">        Number of samples in the initial train split.</span>
<span class="sd">    fixed_train_size : bool, default `True`</span>
<span class="sd">        If True, train size doesn&#39;t increase but moves by `steps` in each iteration.</span>
<span class="sd">    gap : int, default `0`</span>
<span class="sd">        Number of samples to be excluded after the end of each training set and </span>
<span class="sd">        before the test set.</span>
<span class="sd">    skip_folds : int, list, default `None`</span>
<span class="sd">        If `skip_folds` is an integer, every &#39;skip_folds&#39;-th is returned. If `skip_folds`</span>
<span class="sd">        is a list, the folds in the list are skipped. For example, if `skip_folds = 3`,</span>
<span class="sd">        and there are 10 folds, the folds returned will be [0, 3, 6, 9]. If `skip_folds`</span>
<span class="sd">        is a list [1, 2, 3], the folds returned will be [0, 4, 5, 6, 7, 8, 9].</span>
<span class="sd">    allow_incomplete_fold : bool, default `True`</span>
<span class="sd">        Last fold is allowed to have a smaller number of samples than the </span>
<span class="sd">        `test_size`. If `False`, the last fold is excluded.</span>
<span class="sd">    exog : pandas Series, pandas DataFrame, default `None`</span>
<span class="sd">        Exogenous variable/s included as predictor/s. Must have the same</span>
<span class="sd">        number of observations as `y` and should be aligned so that y[i] is</span>
<span class="sd">        regressed on exog[i].</span>
<span class="sd">    lags_grid : list, dict, default `None`</span>
<span class="sd">        Lists of lags to try, containing int, lists, numpy ndarray, or range </span>
<span class="sd">        objects. If `dict`, the keys are used as labels in the `results` </span>
<span class="sd">        DataFrame, and the values are used as the lists of lags to try. Ignored </span>
<span class="sd">        if the forecaster is an instance of `ForecasterAutoregCustom` or </span>
<span class="sd">        `ForecasterAutoregMultiSeriesCustom`.</span>
<span class="sd">    refit : bool, int, default `False`</span>
<span class="sd">        Whether to re-fit the forecaster in each iteration. If `refit` is an integer, </span>
<span class="sd">        the Forecaster will be trained every that number of iterations.</span>
<span class="sd">    return_best : bool, default `True`</span>
<span class="sd">        Refit the `forecaster` using the best found parameters on the whole data.</span>
<span class="sd">    n_jobs : int, &#39;auto&#39;, default `&#39;auto&#39;`</span>
<span class="sd">        The number of jobs to run in parallel. If `-1`, then the number of jobs is </span>
<span class="sd">        set to the number of cores. If &#39;auto&#39;, `n_jobs` is set using the function</span>
<span class="sd">        skforecast.utils.select_n_jobs_backtesting.</span>
<span class="sd">        **New in version 0.9.0**</span>
<span class="sd">    verbose : bool, default `True`</span>
<span class="sd">        Print number of folds used for cv or backtesting.</span>
<span class="sd">    show_progress : bool, default `True`</span>
<span class="sd">        Whether to show a progress bar.</span>
<span class="sd">    output_file : str, default `None`</span>
<span class="sd">        Specifies the filename or full path where the results should be saved. </span>
<span class="sd">        The results will be saved in a tab-separated values (TSV) format. If </span>
<span class="sd">        `None`, the results will not be saved to a file.</span>
<span class="sd">        **New in version 0.12.0**</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    results : pandas DataFrame</span>
<span class="sd">        Results for each combination of parameters.</span>

<span class="sd">        - column lags: lags configuration for each iteration.</span>
<span class="sd">        - column lags_label: descriptive label or alias for the lags.</span>
<span class="sd">        - column params: parameters configuration for each iteration.</span>
<span class="sd">        - column metric: metric value estimated for each iteration.</span>
<span class="sd">        - additional n columns with param = value.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">param_grid</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ParameterGrid</span><span class="p">(</span><span class="n">param_grid</span><span class="p">))</span>

    <span class="n">results</span> <span class="o">=</span> <span class="n">_evaluate_grid_hyperparameters</span><span class="p">(</span>
        <span class="n">forecaster</span>            <span class="o">=</span> <span class="n">forecaster</span><span class="p">,</span>
        <span class="n">y</span>                     <span class="o">=</span> <span class="n">y</span><span class="p">,</span>
        <span class="n">param_grid</span>            <span class="o">=</span> <span class="n">param_grid</span><span class="p">,</span>
        <span class="n">steps</span>                 <span class="o">=</span> <span class="n">steps</span><span class="p">,</span>
        <span class="n">metric</span>                <span class="o">=</span> <span class="n">metric</span><span class="p">,</span>
        <span class="n">initial_train_size</span>    <span class="o">=</span> <span class="n">initial_train_size</span><span class="p">,</span>
        <span class="n">fixed_train_size</span>      <span class="o">=</span> <span class="n">fixed_train_size</span><span class="p">,</span>
        <span class="n">gap</span>                   <span class="o">=</span> <span class="n">gap</span><span class="p">,</span>
        <span class="n">skip_folds</span>            <span class="o">=</span> <span class="n">skip_folds</span><span class="p">,</span>
        <span class="n">allow_incomplete_fold</span> <span class="o">=</span> <span class="n">allow_incomplete_fold</span><span class="p">,</span>
        <span class="n">exog</span>                  <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
        <span class="n">lags_grid</span>             <span class="o">=</span> <span class="n">lags_grid</span><span class="p">,</span>
        <span class="n">refit</span>                 <span class="o">=</span> <span class="n">refit</span><span class="p">,</span>
        <span class="n">return_best</span>           <span class="o">=</span> <span class="n">return_best</span><span class="p">,</span>
        <span class="n">n_jobs</span>                <span class="o">=</span> <span class="n">n_jobs</span><span class="p">,</span>
        <span class="n">verbose</span>               <span class="o">=</span> <span class="n">verbose</span><span class="p">,</span>
        <span class="n">show_progress</span>         <span class="o">=</span> <span class="n">show_progress</span><span class="p">,</span>
        <span class="n">output_file</span>           <span class="o">=</span> <span class="n">output_file</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">results</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="skforecast.model_selection.model_selection.random_search_forecaster" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">random_search_forecaster</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">param_distributions</span><span class="p">,</span> <span class="n">steps</span><span class="p">,</span> <span class="n">metric</span><span class="p">,</span> <span class="n">initial_train_size</span><span class="p">,</span> <span class="n">fixed_train_size</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">gap</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">skip_folds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">allow_incomplete_fold</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lags_grid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">refit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">n_iter</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span> <span class="n">return_best</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">output_file</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#skforecast.model_selection.model_selection.random_search_forecaster" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">

      <p>Random search over specified parameter values or distributions for a Forecaster 
object. Validation is done using time series backtesting.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>forecaster</code></td>
            <td>
                  <code>(<span title="skforecast.ForecasterAutoreg">ForecasterAutoreg</span>, <span title="skforecast.ForecasterAutoregCustom">ForecasterAutoregCustom</span>, <span title="skforecast.ForecasterAutoregDirect">ForecasterAutoregDirect</span>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Forecaster model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>y</code></td>
            <td>
                  <code>pandas Series</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training time series.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>param_distributions</code></td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary with parameters names (<code>str</code>) as keys and 
distributions or lists of parameters to try.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>steps</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of steps to predict.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>metric</code></td>
            <td>
                  <code>(str, <span title="typing.Callable">Callable</span>, list)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Metric used to quantify the goodness of fit of the model.</p>
<ul>
<li>If <code>string</code>: {'mean_squared_error', 'mean_absolute_error',
'mean_absolute_percentage_error', 'mean_squared_log_error',
'mean_absolute_scaled_error', 'root_mean_squared_scaled_error'}</li>
<li>If <code>Callable</code>: Function with arguments <code>y_true</code>, <code>y_pred</code> and <code>y_train</code>
(Optional) that returns a float.</li>
<li>If <code>list</code>: List containing multiple strings and/or Callables.</li>
</ul>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>initial_train_size</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of samples in the initial train split.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>fixed_train_size</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, train size doesn't increase but moves by <code>steps</code> in each iteration.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>gap</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of samples to be excluded after the end of each training set and 
before the test set.</p>
              </div>
            </td>
            <td>
                  <code>`0`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>skip_folds</code></td>
            <td>
                  <code>(int, list)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>skip_folds</code> is an integer, every 'skip_folds'-th is returned. If <code>skip_folds</code>
is a list, the folds in the list are skipped. For example, if <code>skip_folds = 3</code>,
and there are 10 folds, the folds returned will be [0, 3, 6, 9]. If <code>skip_folds</code>
is a list [1, 2, 3], the folds returned will be [0, 4, 5, 6, 7, 8, 9].</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>allow_incomplete_fold</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Last fold is allowed to have a smaller number of samples than the 
<code>test_size</code>. If <code>False</code>, the last fold is excluded.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>exog</code></td>
            <td>
                  <code>pandas Series, pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variable/s included as predictor/s. Must have the same
number of observations as <code>y</code> and should be aligned so that y[i] is
regressed on exog[i].</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>lags_grid</code></td>
            <td>
                  <code>(list, dict)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Lists of lags to try, containing int, lists, numpy ndarray, or range 
objects. If <code>dict</code>, the keys are used as labels in the <code>results</code> 
DataFrame, and the values are used as the lists of lags to try. Ignored 
if the forecaster is an instance of <code>ForecasterAutoregCustom</code> or 
<code>ForecasterAutoregMultiSeriesCustom</code>.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>refit</code></td>
            <td>
                  <code>(bool, int)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to re-fit the forecaster in each iteration. If <code>refit</code> is an integer, 
the Forecaster will be trained every that number of iterations.</p>
              </div>
            </td>
            <td>
                  <code>`False`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>n_iter</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of parameter settings that are sampled per lags configuration. 
n_iter trades off runtime vs quality of the solution.</p>
              </div>
            </td>
            <td>
                  <code>`10`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>random_state</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sets a seed to the random sampling for reproducible output.</p>
              </div>
            </td>
            <td>
                  <code>`123`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>return_best</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Refit the <code>forecaster</code> using the best found parameters on the whole data.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>n_jobs</code></td>
            <td>
                  <code>(int, auto)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of jobs to run in parallel. If <code>-1</code>, then the number of jobs is 
set to the number of cores. If 'auto', <code>n_jobs</code> is set using the function
skforecast.utils.select_n_jobs_backtesting.
<strong>New in version 0.9.0</strong></p>
              </div>
            </td>
            <td>
                  <code>`&#39;auto&#39;`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>verbose</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Print number of folds used for cv or backtesting.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>show_progress</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to show a progress bar.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>output_file</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specifies the filename or full path where the results should be saved. 
The results will be saved in a tab-separated values (TSV) format. If 
<code>None</code>, the results will not be saved to a file.
<strong>New in version 0.12.0</strong></p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>results</code></td>            <td>
                  <code>pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Results for each combination of parameters.</p>
<ul>
<li>column lags: lags configuration for each iteration.</li>
<li>column lags_label: descriptive label or alias for the lags.</li>
<li>column params: parameters configuration for each iteration.</li>
<li>column metric: metric value estimated for each iteration.</li>
<li>additional n columns with param = value.</li>
</ul>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>skforecast\model_selection\model_selection.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">random_search_forecaster</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
    <span class="n">param_distributions</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="nb">list</span><span class="p">],</span>
    <span class="n">initial_train_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">fixed_train_size</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">gap</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">skip_folds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_incomplete_fold</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">lags_grid</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">refit</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">n_iter</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
    <span class="n">return_best</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">output_file</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Random search over specified parameter values or distributions for a Forecaster </span>
<span class="sd">    object. Validation is done using time series backtesting.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    forecaster : ForecasterAutoreg, ForecasterAutoregCustom, ForecasterAutoregDirect</span>
<span class="sd">        Forecaster model.</span>
<span class="sd">    y : pandas Series</span>
<span class="sd">        Training time series. </span>
<span class="sd">    param_distributions : dict</span>
<span class="sd">        Dictionary with parameters names (`str`) as keys and </span>
<span class="sd">        distributions or lists of parameters to try.</span>
<span class="sd">    steps : int</span>
<span class="sd">        Number of steps to predict.</span>
<span class="sd">    metric : str, Callable, list</span>
<span class="sd">        Metric used to quantify the goodness of fit of the model.</span>

<span class="sd">        - If `string`: {&#39;mean_squared_error&#39;, &#39;mean_absolute_error&#39;,</span>
<span class="sd">        &#39;mean_absolute_percentage_error&#39;, &#39;mean_squared_log_error&#39;,</span>
<span class="sd">        &#39;mean_absolute_scaled_error&#39;, &#39;root_mean_squared_scaled_error&#39;}</span>
<span class="sd">        - If `Callable`: Function with arguments `y_true`, `y_pred` and `y_train`</span>
<span class="sd">        (Optional) that returns a float.</span>
<span class="sd">        - If `list`: List containing multiple strings and/or Callables.</span>
<span class="sd">    initial_train_size : int </span>
<span class="sd">        Number of samples in the initial train split.</span>
<span class="sd">    fixed_train_size : bool, default `True`</span>
<span class="sd">        If True, train size doesn&#39;t increase but moves by `steps` in each iteration.</span>
<span class="sd">    gap : int, default `0`</span>
<span class="sd">        Number of samples to be excluded after the end of each training set and </span>
<span class="sd">        before the test set.</span>
<span class="sd">    skip_folds : int, list, default `None`</span>
<span class="sd">        If `skip_folds` is an integer, every &#39;skip_folds&#39;-th is returned. If `skip_folds`</span>
<span class="sd">        is a list, the folds in the list are skipped. For example, if `skip_folds = 3`,</span>
<span class="sd">        and there are 10 folds, the folds returned will be [0, 3, 6, 9]. If `skip_folds`</span>
<span class="sd">        is a list [1, 2, 3], the folds returned will be [0, 4, 5, 6, 7, 8, 9].</span>
<span class="sd">    allow_incomplete_fold : bool, default `True`</span>
<span class="sd">        Last fold is allowed to have a smaller number of samples than the </span>
<span class="sd">        `test_size`. If `False`, the last fold is excluded.</span>
<span class="sd">    exog : pandas Series, pandas DataFrame, default `None`</span>
<span class="sd">        Exogenous variable/s included as predictor/s. Must have the same</span>
<span class="sd">        number of observations as `y` and should be aligned so that y[i] is</span>
<span class="sd">        regressed on exog[i]. </span>
<span class="sd">    lags_grid : list, dict, default `None`</span>
<span class="sd">        Lists of lags to try, containing int, lists, numpy ndarray, or range </span>
<span class="sd">        objects. If `dict`, the keys are used as labels in the `results` </span>
<span class="sd">        DataFrame, and the values are used as the lists of lags to try. Ignored </span>
<span class="sd">        if the forecaster is an instance of `ForecasterAutoregCustom` or </span>
<span class="sd">        `ForecasterAutoregMultiSeriesCustom`.</span>
<span class="sd">    refit : bool, int, default `False`</span>
<span class="sd">        Whether to re-fit the forecaster in each iteration. If `refit` is an integer, </span>
<span class="sd">        the Forecaster will be trained every that number of iterations.</span>
<span class="sd">    n_iter : int, default `10`</span>
<span class="sd">        Number of parameter settings that are sampled per lags configuration. </span>
<span class="sd">        n_iter trades off runtime vs quality of the solution.</span>
<span class="sd">    random_state : int, default `123`</span>
<span class="sd">        Sets a seed to the random sampling for reproducible output.</span>
<span class="sd">    return_best : bool, default `True`</span>
<span class="sd">        Refit the `forecaster` using the best found parameters on the whole data.</span>
<span class="sd">    n_jobs : int, &#39;auto&#39;, default `&#39;auto&#39;`</span>
<span class="sd">        The number of jobs to run in parallel. If `-1`, then the number of jobs is </span>
<span class="sd">        set to the number of cores. If &#39;auto&#39;, `n_jobs` is set using the function</span>
<span class="sd">        skforecast.utils.select_n_jobs_backtesting.</span>
<span class="sd">        **New in version 0.9.0**</span>
<span class="sd">    verbose : bool, default `True`</span>
<span class="sd">        Print number of folds used for cv or backtesting.</span>
<span class="sd">    show_progress : bool, default `True`</span>
<span class="sd">        Whether to show a progress bar.</span>
<span class="sd">    output_file : str, default `None`</span>
<span class="sd">        Specifies the filename or full path where the results should be saved. </span>
<span class="sd">        The results will be saved in a tab-separated values (TSV) format. If </span>
<span class="sd">        `None`, the results will not be saved to a file.</span>
<span class="sd">        **New in version 0.12.0**</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    results : pandas DataFrame</span>
<span class="sd">        Results for each combination of parameters.</span>

<span class="sd">        - column lags: lags configuration for each iteration.</span>
<span class="sd">        - column lags_label: descriptive label or alias for the lags.</span>
<span class="sd">        - column params: parameters configuration for each iteration.</span>
<span class="sd">        - column metric: metric value estimated for each iteration.</span>
<span class="sd">        - additional n columns with param = value.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">param_grid</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ParameterSampler</span><span class="p">(</span><span class="n">param_distributions</span><span class="p">,</span> <span class="n">n_iter</span><span class="o">=</span><span class="n">n_iter</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">))</span>

    <span class="n">results</span> <span class="o">=</span> <span class="n">_evaluate_grid_hyperparameters</span><span class="p">(</span>
        <span class="n">forecaster</span>            <span class="o">=</span> <span class="n">forecaster</span><span class="p">,</span>
        <span class="n">y</span>                     <span class="o">=</span> <span class="n">y</span><span class="p">,</span>
        <span class="n">param_grid</span>            <span class="o">=</span> <span class="n">param_grid</span><span class="p">,</span>
        <span class="n">steps</span>                 <span class="o">=</span> <span class="n">steps</span><span class="p">,</span>
        <span class="n">metric</span>                <span class="o">=</span> <span class="n">metric</span><span class="p">,</span>
        <span class="n">initial_train_size</span>    <span class="o">=</span> <span class="n">initial_train_size</span><span class="p">,</span>
        <span class="n">fixed_train_size</span>      <span class="o">=</span> <span class="n">fixed_train_size</span><span class="p">,</span>
        <span class="n">gap</span>                   <span class="o">=</span> <span class="n">gap</span><span class="p">,</span>
        <span class="n">skip_folds</span>            <span class="o">=</span> <span class="n">skip_folds</span><span class="p">,</span>
        <span class="n">allow_incomplete_fold</span> <span class="o">=</span> <span class="n">allow_incomplete_fold</span><span class="p">,</span>
        <span class="n">exog</span>                  <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
        <span class="n">lags_grid</span>             <span class="o">=</span> <span class="n">lags_grid</span><span class="p">,</span>
        <span class="n">refit</span>                 <span class="o">=</span> <span class="n">refit</span><span class="p">,</span>
        <span class="n">return_best</span>           <span class="o">=</span> <span class="n">return_best</span><span class="p">,</span>
        <span class="n">n_jobs</span>                <span class="o">=</span> <span class="n">n_jobs</span><span class="p">,</span>
        <span class="n">verbose</span>               <span class="o">=</span> <span class="n">verbose</span><span class="p">,</span>
        <span class="n">show_progress</span>         <span class="o">=</span> <span class="n">show_progress</span><span class="p">,</span>
        <span class="n">output_file</span>           <span class="o">=</span> <span class="n">output_file</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">results</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="skforecast.model_selection.model_selection.bayesian_search_forecaster" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">bayesian_search_forecaster</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">search_space</span><span class="p">,</span> <span class="n">steps</span><span class="p">,</span> <span class="n">metric</span><span class="p">,</span> <span class="n">initial_train_size</span><span class="p">,</span> <span class="n">fixed_train_size</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">gap</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">skip_folds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">allow_incomplete_fold</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">refit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">n_trials</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span> <span class="n">return_best</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">output_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;optuna&#39;</span><span class="p">,</span> <span class="n">kwargs_create_study</span><span class="o">=</span><span class="p">{},</span> <span class="n">kwargs_study_optimize</span><span class="o">=</span><span class="p">{})</span></code>

<a href="#skforecast.model_selection.model_selection.bayesian_search_forecaster" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">

      <p>Bayesian optimization for a Forecaster object using time series backtesting and 
optuna library.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>forecaster</code></td>
            <td>
                  <code>(<span title="skforecast.ForecasterAutoreg">ForecasterAutoreg</span>, <span title="skforecast.ForecasterAutoregCustom">ForecasterAutoregCustom</span>, <span title="skforecast.ForecasterAutoregDirect">ForecasterAutoregDirect</span>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Forecaster model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>y</code></td>
            <td>
                  <code>pandas Series</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training time series.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>search_space</code></td>
            <td>
                  <code><span title="typing.Callable">Callable</span>(optuna)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function with argument <code>trial</code> which returns a dictionary with parameters names 
(<code>str</code>) as keys and Trial object from optuna (trial.suggest_float, 
trial.suggest_int, trial.suggest_categorical) as values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>steps</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of steps to predict.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>metric</code></td>
            <td>
                  <code>(str, <span title="typing.Callable">Callable</span>, list)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Metric used to quantify the goodness of fit of the model.</p>
<ul>
<li>If <code>string</code>: {'mean_squared_error', 'mean_absolute_error',
'mean_absolute_percentage_error', 'mean_squared_log_error',
'mean_absolute_scaled_error', 'root_mean_squared_scaled_error'}</li>
<li>If <code>Callable</code>: Function with arguments <code>y_true</code>, <code>y_pred</code> and <code>y_train</code>
(Optional) that returns a float.</li>
<li>If <code>list</code>: List containing multiple strings and/or Callables.</li>
</ul>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>initial_train_size</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of samples in the initial train split.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>fixed_train_size</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, train size doesn't increase but moves by <code>steps</code> in each iteration.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>gap</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of samples to be excluded after the end of each training set and 
before the test set.</p>
              </div>
            </td>
            <td>
                  <code>`0`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>skip_folds</code></td>
            <td>
                  <code>(int, list)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>skip_folds</code> is an integer, every 'skip_folds'-th is returned. If <code>skip_folds</code>
is a list, the folds in the list are skipped. For example, if <code>skip_folds = 3</code>,
and there are 10 folds, the folds returned will be [0, 3, 6, 9]. If <code>skip_folds</code>
is a list [1, 2, 3], the folds returned will be [0, 4, 5, 6, 7, 8, 9].</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>allow_incomplete_fold</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Last fold is allowed to have a smaller number of samples than the 
<code>test_size</code>. If <code>False</code>, the last fold is excluded.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>exog</code></td>
            <td>
                  <code>pandas Series, pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variable/s included as predictor/s. Must have the same
number of observations as <code>y</code> and should be aligned so that y[i] is
regressed on exog[i].</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>refit</code></td>
            <td>
                  <code>(bool, int)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to re-fit the forecaster in each iteration. If <code>refit</code> is an integer, 
the Forecaster will be trained every that number of iterations.</p>
              </div>
            </td>
            <td>
                  <code>`False`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>n_trials</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of parameter settings that are sampled in each lag configuration.</p>
              </div>
            </td>
            <td>
                  <code>`10`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>random_state</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sets a seed to the sampling for reproducible output. When a new sampler 
is passed in <code>kwargs_create_study</code>, the seed must be set within the 
sampler. For example <code>{'sampler': TPESampler(seed=145)}</code>.</p>
              </div>
            </td>
            <td>
                  <code>`123`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>return_best</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Refit the <code>forecaster</code> using the best found parameters on the whole data.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>n_jobs</code></td>
            <td>
                  <code>(int, auto)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of jobs to run in parallel. If <code>-1</code>, then the number of jobs is 
set to the number of cores. If 'auto', <code>n_jobs</code> is set using the function
skforecast.utils.select_n_jobs_backtesting.
<strong>New in version 0.9.0</strong></p>
              </div>
            </td>
            <td>
                  <code>`&#39;auto&#39;`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>verbose</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Print number of folds used for cv or backtesting.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>show_progress</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to show a progress bar.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>output_file</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specifies the filename or full path where the results should be saved. 
The results will be saved in a tab-separated values (TSV) format. If 
<code>None</code>, the results will not be saved to a file.
<strong>New in version 0.12.0</strong></p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>engine</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Bayesian optimization runs through the optuna library.</p>
              </div>
            </td>
            <td>
                  <code>`&#39;optuna&#39;`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>kwargs_create_study</code></td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Keyword arguments (key, value mappings) to pass to optuna.create_study().
If default, the direction is set to 'minimize' and a TPESampler(seed=123) 
sampler is used during optimization.</p>
              </div>
            </td>
            <td>
                  <code>`{}`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>kwargs_study_optimize</code></td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Only applies to engine='optuna'. Other keyword arguments (key, value mappings) 
to pass to study.optimize().</p>
              </div>
            </td>
            <td>
                  <code>`{}`</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>results</code></td>            <td>
                  <code>pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Results for each combination of parameters.</p>
<ul>
<li>column lags: lags configuration for each iteration.</li>
<li>column params: parameters configuration for each iteration.</li>
<li>column metric: metric value estimated for each iteration.</li>
<li>additional n columns with param = value.</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>best_trial</code></td>            <td>
                  <code>optuna object</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The best optimization result returned as a FrozenTrial optuna object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>skforecast\model_selection\model_selection.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">bayesian_search_forecaster</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
    <span class="n">search_space</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
    <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="nb">list</span><span class="p">],</span>
    <span class="n">initial_train_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">fixed_train_size</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">gap</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">skip_folds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_incomplete_fold</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">refit</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">n_trials</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
    <span class="n">return_best</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">output_file</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">engine</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;optuna&#39;</span><span class="p">,</span>
    <span class="n">kwargs_create_study</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">kwargs_study_optimize</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">object</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Bayesian optimization for a Forecaster object using time series backtesting and </span>
<span class="sd">    optuna library.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    forecaster : ForecasterAutoreg, ForecasterAutoregCustom, ForecasterAutoregDirect</span>
<span class="sd">        Forecaster model.</span>
<span class="sd">    y : pandas Series</span>
<span class="sd">        Training time series. </span>
<span class="sd">    search_space : Callable (optuna)</span>
<span class="sd">        Function with argument `trial` which returns a dictionary with parameters names </span>
<span class="sd">        (`str`) as keys and Trial object from optuna (trial.suggest_float, </span>
<span class="sd">        trial.suggest_int, trial.suggest_categorical) as values.</span>
<span class="sd">    steps : int</span>
<span class="sd">        Number of steps to predict.</span>
<span class="sd">    metric : str, Callable, list</span>
<span class="sd">        Metric used to quantify the goodness of fit of the model.</span>

<span class="sd">        - If `string`: {&#39;mean_squared_error&#39;, &#39;mean_absolute_error&#39;,</span>
<span class="sd">        &#39;mean_absolute_percentage_error&#39;, &#39;mean_squared_log_error&#39;,</span>
<span class="sd">        &#39;mean_absolute_scaled_error&#39;, &#39;root_mean_squared_scaled_error&#39;}</span>
<span class="sd">        - If `Callable`: Function with arguments `y_true`, `y_pred` and `y_train`</span>
<span class="sd">        (Optional) that returns a float.</span>
<span class="sd">        - If `list`: List containing multiple strings and/or Callables.</span>
<span class="sd">    initial_train_size : int </span>
<span class="sd">        Number of samples in the initial train split.</span>
<span class="sd">    fixed_train_size : bool, default `True`</span>
<span class="sd">        If True, train size doesn&#39;t increase but moves by `steps` in each iteration.</span>
<span class="sd">    gap : int, default `0`</span>
<span class="sd">        Number of samples to be excluded after the end of each training set and </span>
<span class="sd">        before the test set.</span>
<span class="sd">    skip_folds : int, list, default `None`</span>
<span class="sd">        If `skip_folds` is an integer, every &#39;skip_folds&#39;-th is returned. If `skip_folds`</span>
<span class="sd">        is a list, the folds in the list are skipped. For example, if `skip_folds = 3`,</span>
<span class="sd">        and there are 10 folds, the folds returned will be [0, 3, 6, 9]. If `skip_folds`</span>
<span class="sd">        is a list [1, 2, 3], the folds returned will be [0, 4, 5, 6, 7, 8, 9].</span>
<span class="sd">    allow_incomplete_fold : bool, default `True`</span>
<span class="sd">        Last fold is allowed to have a smaller number of samples than the </span>
<span class="sd">        `test_size`. If `False`, the last fold is excluded.</span>
<span class="sd">    exog : pandas Series, pandas DataFrame, default `None`</span>
<span class="sd">        Exogenous variable/s included as predictor/s. Must have the same</span>
<span class="sd">        number of observations as `y` and should be aligned so that y[i] is</span>
<span class="sd">        regressed on exog[i].</span>
<span class="sd">    refit : bool, int, default `False`</span>
<span class="sd">        Whether to re-fit the forecaster in each iteration. If `refit` is an integer, </span>
<span class="sd">        the Forecaster will be trained every that number of iterations.</span>
<span class="sd">    n_trials : int, default `10`</span>
<span class="sd">        Number of parameter settings that are sampled in each lag configuration.</span>
<span class="sd">    random_state : int, default `123`</span>
<span class="sd">        Sets a seed to the sampling for reproducible output. When a new sampler </span>
<span class="sd">        is passed in `kwargs_create_study`, the seed must be set within the </span>
<span class="sd">        sampler. For example `{&#39;sampler&#39;: TPESampler(seed=145)}`.</span>
<span class="sd">    return_best : bool, default `True`</span>
<span class="sd">        Refit the `forecaster` using the best found parameters on the whole data.</span>
<span class="sd">    n_jobs : int, &#39;auto&#39;, default `&#39;auto&#39;`</span>
<span class="sd">        The number of jobs to run in parallel. If `-1`, then the number of jobs is </span>
<span class="sd">        set to the number of cores. If &#39;auto&#39;, `n_jobs` is set using the function</span>
<span class="sd">        skforecast.utils.select_n_jobs_backtesting.</span>
<span class="sd">        **New in version 0.9.0**</span>
<span class="sd">    verbose : bool, default `True`</span>
<span class="sd">        Print number of folds used for cv or backtesting.</span>
<span class="sd">    show_progress : bool, default `True`</span>
<span class="sd">        Whether to show a progress bar.</span>
<span class="sd">    output_file : str, default `None`</span>
<span class="sd">        Specifies the filename or full path where the results should be saved. </span>
<span class="sd">        The results will be saved in a tab-separated values (TSV) format. If </span>
<span class="sd">        `None`, the results will not be saved to a file.</span>
<span class="sd">        **New in version 0.12.0**</span>
<span class="sd">    engine : str, default `&#39;optuna&#39;`</span>
<span class="sd">        Bayesian optimization runs through the optuna library.</span>
<span class="sd">    kwargs_create_study : dict, default `{}`</span>
<span class="sd">        Keyword arguments (key, value mappings) to pass to optuna.create_study().</span>
<span class="sd">        If default, the direction is set to &#39;minimize&#39; and a TPESampler(seed=123) </span>
<span class="sd">        sampler is used during optimization.</span>
<span class="sd">    kwargs_study_optimize : dict, default `{}`</span>
<span class="sd">        Only applies to engine=&#39;optuna&#39;. Other keyword arguments (key, value mappings) </span>
<span class="sd">        to pass to study.optimize().</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    results : pandas DataFrame</span>
<span class="sd">        Results for each combination of parameters.</span>

<span class="sd">        - column lags: lags configuration for each iteration.</span>
<span class="sd">        - column params: parameters configuration for each iteration.</span>
<span class="sd">        - column metric: metric value estimated for each iteration.</span>
<span class="sd">        - additional n columns with param = value.</span>
<span class="sd">    best_trial : optuna object</span>
<span class="sd">        The best optimization result returned as a FrozenTrial optuna object.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">return_best</span> <span class="ow">and</span> <span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`exog` must have same number of samples as `y`. &quot;</span>
             <span class="sa">f</span><span class="s2">&quot;length `exog`: (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span><span class="si">}</span><span class="s2">), length `y`: (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">engine</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;optuna&#39;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;`engine` only allows &#39;optuna&#39;, got </span><span class="si">{</span><span class="n">engine</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>

    <span class="n">results</span><span class="p">,</span> <span class="n">best_trial</span> <span class="o">=</span> <span class="n">_bayesian_search_optuna</span><span class="p">(</span>
                              <span class="n">forecaster</span>            <span class="o">=</span> <span class="n">forecaster</span><span class="p">,</span>
                              <span class="n">y</span>                     <span class="o">=</span> <span class="n">y</span><span class="p">,</span>
                              <span class="n">exog</span>                  <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
                              <span class="n">search_space</span>          <span class="o">=</span> <span class="n">search_space</span><span class="p">,</span>
                              <span class="n">steps</span>                 <span class="o">=</span> <span class="n">steps</span><span class="p">,</span>
                              <span class="n">metric</span>                <span class="o">=</span> <span class="n">metric</span><span class="p">,</span>
                              <span class="n">refit</span>                 <span class="o">=</span> <span class="n">refit</span><span class="p">,</span>
                              <span class="n">initial_train_size</span>    <span class="o">=</span> <span class="n">initial_train_size</span><span class="p">,</span>
                              <span class="n">fixed_train_size</span>      <span class="o">=</span> <span class="n">fixed_train_size</span><span class="p">,</span>
                              <span class="n">gap</span>                   <span class="o">=</span> <span class="n">gap</span><span class="p">,</span>
                              <span class="n">skip_folds</span>            <span class="o">=</span> <span class="n">skip_folds</span><span class="p">,</span>
                              <span class="n">allow_incomplete_fold</span> <span class="o">=</span> <span class="n">allow_incomplete_fold</span><span class="p">,</span>
                              <span class="n">n_trials</span>              <span class="o">=</span> <span class="n">n_trials</span><span class="p">,</span>
                              <span class="n">random_state</span>          <span class="o">=</span> <span class="n">random_state</span><span class="p">,</span>
                              <span class="n">return_best</span>           <span class="o">=</span> <span class="n">return_best</span><span class="p">,</span>
                              <span class="n">n_jobs</span>                <span class="o">=</span> <span class="n">n_jobs</span><span class="p">,</span>
                              <span class="n">verbose</span>               <span class="o">=</span> <span class="n">verbose</span><span class="p">,</span>
                              <span class="n">show_progress</span>         <span class="o">=</span> <span class="n">show_progress</span><span class="p">,</span>
                              <span class="n">output_file</span>           <span class="o">=</span> <span class="n">output_file</span><span class="p">,</span>
                              <span class="n">kwargs_create_study</span>   <span class="o">=</span> <span class="n">kwargs_create_study</span><span class="p">,</span>
                              <span class="n">kwargs_study_optimize</span> <span class="o">=</span> <span class="n">kwargs_study_optimize</span>
                          <span class="p">)</span>

    <span class="k">return</span> <span class="n">results</span><span class="p">,</span> <span class="n">best_trial</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="skforecast.model_selection.model_selection.select_features" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">select_features</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">selector</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">select_only</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">force_inclusion</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">subsample</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#skforecast.model_selection.model_selection.select_features" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">

      <p>Feature selection using any of the sklearn.feature_selection module selectors 
(such as <code>RFECV</code>, <code>SelectFromModel</code>, etc.). Two groups of features are
evaluated: autoregressive features and exogenous features. By default, the 
selection process is performed on both sets of features at the same time, 
so that the most relevant autoregressive and exogenous features are selected. 
However, using the <code>select_only</code> argument, the selection process can focus 
only on the autoregressive or exogenous features without taking into account 
the other features. Therefore, all other features will remain in the model. 
It is also possible to force the inclusion of certain features in the final 
list of selected features using the <code>force_inclusion</code> parameter.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>forecaster</code></td>
            <td>
                  <code>(<span title="skforecast.ForecasterAutoreg">ForecasterAutoreg</span>, <span title="skforecast.ForecasterAutoregCustom">ForecasterAutoregCustom</span>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Forecaster model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>selector</code></td>
            <td>
                  <code>object</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A feature selector from sklearn.feature_selection.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>y</code></td>
            <td>
                  <code>pandas Series, pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Target time series to which the feature selection will be applied.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>exog</code></td>
            <td>
                  <code>pandas Series, pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variable/s included as predictor/s. Must have the same
number of observations as <code>y</code> and should be aligned so that y[i] is
regressed on exog[i].</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>select_only</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Decide what type of features to include in the selection process. </p>
<ul>
<li>If <code>'autoreg'</code>, only autoregressive features (lags or custom 
predictors) are evaluated by the selector. All exogenous features are 
included in the output (<code>selected_exog</code>).</li>
<li>If <code>'exog'</code>, only exogenous features are evaluated without the presence
of autoregressive features. All autoregressive features are included 
in the output (<code>selected_autoreg</code>).</li>
<li>If <code>None</code>, all features are evaluated by the selector.</li>
</ul>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>force_inclusion</code></td>
            <td>
                  <code>(list, str)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Features to force include in the final list of selected features.</p>
<ul>
<li>If <code>list</code>, list of feature names to force include.</li>
<li>If <code>str</code>, regular expression to identify features to force include. 
For example, if <code>force_inclusion="^sun_"</code>, all features that begin 
with "sun_" will be included in the final list of selected features.</li>
</ul>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>subsample</code></td>
            <td>
                  <code>(int, float)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Proportion of records to use for feature selection.</p>
              </div>
            </td>
            <td>
                  <code>`0.5`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>random_state</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sets a seed for the random subsample so that the subsampling process 
is always deterministic.</p>
              </div>
            </td>
            <td>
                  <code>`123`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>verbose</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Print information about feature selection process.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>selected_autoreg</code></td>            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of selected autoregressive features.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>selected_exog</code></td>            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of selected exogenous features.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>skforecast\model_selection\model_selection.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1704</span>
<span class="normal">1705</span>
<span class="normal">1706</span>
<span class="normal">1707</span>
<span class="normal">1708</span>
<span class="normal">1709</span>
<span class="normal">1710</span>
<span class="normal">1711</span>
<span class="normal">1712</span>
<span class="normal">1713</span>
<span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span>
<span class="normal">1717</span>
<span class="normal">1718</span>
<span class="normal">1719</span>
<span class="normal">1720</span>
<span class="normal">1721</span>
<span class="normal">1722</span>
<span class="normal">1723</span>
<span class="normal">1724</span>
<span class="normal">1725</span>
<span class="normal">1726</span>
<span class="normal">1727</span>
<span class="normal">1728</span>
<span class="normal">1729</span>
<span class="normal">1730</span>
<span class="normal">1731</span>
<span class="normal">1732</span>
<span class="normal">1733</span>
<span class="normal">1734</span>
<span class="normal">1735</span>
<span class="normal">1736</span>
<span class="normal">1737</span>
<span class="normal">1738</span>
<span class="normal">1739</span>
<span class="normal">1740</span>
<span class="normal">1741</span>
<span class="normal">1742</span>
<span class="normal">1743</span>
<span class="normal">1744</span>
<span class="normal">1745</span>
<span class="normal">1746</span>
<span class="normal">1747</span>
<span class="normal">1748</span>
<span class="normal">1749</span>
<span class="normal">1750</span>
<span class="normal">1751</span>
<span class="normal">1752</span>
<span class="normal">1753</span>
<span class="normal">1754</span>
<span class="normal">1755</span>
<span class="normal">1756</span>
<span class="normal">1757</span>
<span class="normal">1758</span>
<span class="normal">1759</span>
<span class="normal">1760</span>
<span class="normal">1761</span>
<span class="normal">1762</span>
<span class="normal">1763</span>
<span class="normal">1764</span>
<span class="normal">1765</span>
<span class="normal">1766</span>
<span class="normal">1767</span>
<span class="normal">1768</span>
<span class="normal">1769</span>
<span class="normal">1770</span>
<span class="normal">1771</span>
<span class="normal">1772</span>
<span class="normal">1773</span>
<span class="normal">1774</span>
<span class="normal">1775</span>
<span class="normal">1776</span>
<span class="normal">1777</span>
<span class="normal">1778</span>
<span class="normal">1779</span>
<span class="normal">1780</span>
<span class="normal">1781</span>
<span class="normal">1782</span>
<span class="normal">1783</span>
<span class="normal">1784</span>
<span class="normal">1785</span>
<span class="normal">1786</span>
<span class="normal">1787</span>
<span class="normal">1788</span>
<span class="normal">1789</span>
<span class="normal">1790</span>
<span class="normal">1791</span>
<span class="normal">1792</span>
<span class="normal">1793</span>
<span class="normal">1794</span>
<span class="normal">1795</span>
<span class="normal">1796</span>
<span class="normal">1797</span>
<span class="normal">1798</span>
<span class="normal">1799</span>
<span class="normal">1800</span>
<span class="normal">1801</span>
<span class="normal">1802</span>
<span class="normal">1803</span>
<span class="normal">1804</span>
<span class="normal">1805</span>
<span class="normal">1806</span>
<span class="normal">1807</span>
<span class="normal">1808</span>
<span class="normal">1809</span>
<span class="normal">1810</span>
<span class="normal">1811</span>
<span class="normal">1812</span>
<span class="normal">1813</span>
<span class="normal">1814</span>
<span class="normal">1815</span>
<span class="normal">1816</span>
<span class="normal">1817</span>
<span class="normal">1818</span>
<span class="normal">1819</span>
<span class="normal">1820</span>
<span class="normal">1821</span>
<span class="normal">1822</span>
<span class="normal">1823</span>
<span class="normal">1824</span>
<span class="normal">1825</span>
<span class="normal">1826</span>
<span class="normal">1827</span>
<span class="normal">1828</span>
<span class="normal">1829</span>
<span class="normal">1830</span>
<span class="normal">1831</span>
<span class="normal">1832</span>
<span class="normal">1833</span>
<span class="normal">1834</span>
<span class="normal">1835</span>
<span class="normal">1836</span>
<span class="normal">1837</span>
<span class="normal">1838</span>
<span class="normal">1839</span>
<span class="normal">1840</span>
<span class="normal">1841</span>
<span class="normal">1842</span>
<span class="normal">1843</span>
<span class="normal">1844</span>
<span class="normal">1845</span>
<span class="normal">1846</span>
<span class="normal">1847</span>
<span class="normal">1848</span>
<span class="normal">1849</span>
<span class="normal">1850</span>
<span class="normal">1851</span>
<span class="normal">1852</span>
<span class="normal">1853</span>
<span class="normal">1854</span>
<span class="normal">1855</span>
<span class="normal">1856</span>
<span class="normal">1857</span>
<span class="normal">1858</span>
<span class="normal">1859</span>
<span class="normal">1860</span>
<span class="normal">1861</span>
<span class="normal">1862</span>
<span class="normal">1863</span>
<span class="normal">1864</span>
<span class="normal">1865</span>
<span class="normal">1866</span>
<span class="normal">1867</span>
<span class="normal">1868</span>
<span class="normal">1869</span>
<span class="normal">1870</span>
<span class="normal">1871</span>
<span class="normal">1872</span>
<span class="normal">1873</span>
<span class="normal">1874</span>
<span class="normal">1875</span>
<span class="normal">1876</span>
<span class="normal">1877</span>
<span class="normal">1878</span>
<span class="normal">1879</span>
<span class="normal">1880</span>
<span class="normal">1881</span>
<span class="normal">1882</span>
<span class="normal">1883</span>
<span class="normal">1884</span>
<span class="normal">1885</span>
<span class="normal">1886</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">select_features</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
    <span class="n">selector</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">select_only</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">force_inclusion</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">subsample</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
    <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="nb">list</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Feature selection using any of the sklearn.feature_selection module selectors </span>
<span class="sd">    (such as `RFECV`, `SelectFromModel`, etc.). Two groups of features are</span>
<span class="sd">    evaluated: autoregressive features and exogenous features. By default, the </span>
<span class="sd">    selection process is performed on both sets of features at the same time, </span>
<span class="sd">    so that the most relevant autoregressive and exogenous features are selected. </span>
<span class="sd">    However, using the `select_only` argument, the selection process can focus </span>
<span class="sd">    only on the autoregressive or exogenous features without taking into account </span>
<span class="sd">    the other features. Therefore, all other features will remain in the model. </span>
<span class="sd">    It is also possible to force the inclusion of certain features in the final </span>
<span class="sd">    list of selected features using the `force_inclusion` parameter.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    forecaster : ForecasterAutoreg, ForecasterAutoregCustom</span>
<span class="sd">        Forecaster model.</span>
<span class="sd">    selector : object</span>
<span class="sd">        A feature selector from sklearn.feature_selection.</span>
<span class="sd">    y : pandas Series, pandas DataFrame</span>
<span class="sd">        Target time series to which the feature selection will be applied.</span>
<span class="sd">    exog : pandas Series, pandas DataFrame, default `None`</span>
<span class="sd">        Exogenous variable/s included as predictor/s. Must have the same</span>
<span class="sd">        number of observations as `y` and should be aligned so that y[i] is</span>
<span class="sd">        regressed on exog[i].</span>
<span class="sd">    select_only : str, default `None`</span>
<span class="sd">        Decide what type of features to include in the selection process. </span>

<span class="sd">        - If `&#39;autoreg&#39;`, only autoregressive features (lags or custom </span>
<span class="sd">        predictors) are evaluated by the selector. All exogenous features are </span>
<span class="sd">        included in the output (`selected_exog`).</span>
<span class="sd">        - If `&#39;exog&#39;`, only exogenous features are evaluated without the presence</span>
<span class="sd">        of autoregressive features. All autoregressive features are included </span>
<span class="sd">        in the output (`selected_autoreg`).</span>
<span class="sd">        - If `None`, all features are evaluated by the selector.</span>
<span class="sd">    force_inclusion : list, str, default `None`</span>
<span class="sd">        Features to force include in the final list of selected features.</span>

<span class="sd">        - If `list`, list of feature names to force include.</span>
<span class="sd">        - If `str`, regular expression to identify features to force include. </span>
<span class="sd">        For example, if `force_inclusion=&quot;^sun_&quot;`, all features that begin </span>
<span class="sd">        with &quot;sun_&quot; will be included in the final list of selected features.</span>
<span class="sd">    subsample : int, float, default `0.5`</span>
<span class="sd">        Proportion of records to use for feature selection.</span>
<span class="sd">    random_state : int, default `123`</span>
<span class="sd">        Sets a seed for the random subsample so that the subsampling process </span>
<span class="sd">        is always deterministic.</span>
<span class="sd">    verbose : bool, default `True`</span>
<span class="sd">        Print information about feature selection process.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    selected_autoreg : list</span>
<span class="sd">        List of selected autoregressive features.</span>
<span class="sd">    selected_exog : list</span>
<span class="sd">        List of selected exogenous features.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">valid_forecasters</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;ForecasterAutoreg&#39;</span><span class="p">,</span>
        <span class="s1">&#39;ForecasterAutoregCustom&#39;</span>
    <span class="p">]</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">forecaster</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">valid_forecasters</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;`forecaster` must be one of the following classes: </span><span class="si">{</span><span class="n">valid_forecasters</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">select_only</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;autoreg&#39;</span><span class="p">,</span> <span class="s1">&#39;exog&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;`select_only` must be one of the following values: &#39;autoreg&#39;, &#39;exog&#39;, None.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">subsample</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">subsample</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;`subsample` must be a number greater than 0 and less than or equal to 1.&quot;</span>
        <span class="p">)</span>

    <span class="n">forecaster</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">forecaster</span><span class="p">)</span>
    <span class="n">forecaster</span><span class="o">.</span><span class="n">fitted</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">create_train_X_y</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="s1">&#39;lags&#39;</span><span class="p">):</span>
        <span class="n">autoreg_cols</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;lag_</span><span class="si">{</span><span class="n">lag</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">lag</span> <span class="ow">in</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">lags</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">name_predictors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">autoreg_cols</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">name_predictors</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">autoreg_cols</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">col</span>
                <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">X_train</span><span class="o">.</span><span class="n">columns</span>
                <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^custom_predictor_\d+&#39;</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
            <span class="p">]</span>
    <span class="n">exog_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">X_train</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">autoreg_cols</span><span class="p">]</span>

    <span class="n">forced_autoreg</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">forced_exog</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">force_inclusion</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">force_inclusion</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">forced_autoreg</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">force_inclusion</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">autoreg_cols</span><span class="p">]</span>
            <span class="n">forced_exog</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">force_inclusion</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">exog_cols</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">force_inclusion</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">forced_autoreg</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">autoreg_cols</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">force_inclusion</span><span class="p">,</span> <span class="n">col</span><span class="p">)]</span>
            <span class="n">forced_exog</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">exog_cols</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">force_inclusion</span><span class="p">,</span> <span class="n">col</span><span class="p">)]</span>

    <span class="k">if</span> <span class="n">select_only</span> <span class="o">==</span> <span class="s1">&#39;autoreg&#39;</span><span class="p">:</span>
        <span class="n">X_train</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">exog_cols</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">select_only</span> <span class="o">==</span> <span class="s1">&#39;exog&#39;</span><span class="p">:</span>
        <span class="n">X_train</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">autoreg_cols</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">subsample</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
        <span class="n">subsample</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span> <span class="o">*</span> <span class="n">subsample</span><span class="p">)</span>

    <span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">random_state</span><span class="p">)</span>
    <span class="n">sample</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">subsample</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">X_train_sample</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sample</span><span class="p">,</span> <span class="p">:]</span>
    <span class="n">y_train_sample</span> <span class="o">=</span> <span class="n">y_train</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sample</span><span class="p">]</span>
    <span class="n">selector</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_sample</span><span class="p">,</span> <span class="n">y_train_sample</span><span class="p">)</span>
    <span class="n">selected_features</span> <span class="o">=</span> <span class="n">selector</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">select_only</span> <span class="o">==</span> <span class="s1">&#39;exog&#39;</span><span class="p">:</span>
        <span class="n">selected_autoreg</span> <span class="o">=</span> <span class="n">autoreg_cols</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">selected_autoreg</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">feature</span>
            <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">selected_features</span>
            <span class="k">if</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">autoreg_cols</span>
        <span class="p">]</span>

    <span class="k">if</span> <span class="n">select_only</span> <span class="o">==</span> <span class="s1">&#39;autoreg&#39;</span><span class="p">:</span>
        <span class="n">selected_exog</span> <span class="o">=</span> <span class="n">exog_cols</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">selected_exog</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">feature</span>
            <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">selected_features</span>
            <span class="k">if</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">exog_cols</span>
        <span class="p">]</span>

    <span class="k">if</span> <span class="n">force_inclusion</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> 
        <span class="k">if</span> <span class="n">select_only</span> <span class="o">!=</span> <span class="s1">&#39;autoreg&#39;</span><span class="p">:</span>
            <span class="n">forced_exog_not_selected</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">forced_exog</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">selected_features</span><span class="p">)</span>
            <span class="n">selected_exog</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">forced_exog_not_selected</span><span class="p">)</span>
            <span class="n">selected_exog</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">exog_cols</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">select_only</span> <span class="o">!=</span> <span class="s1">&#39;exog&#39;</span><span class="p">:</span>
            <span class="n">forced_autoreg_not_selected</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">forced_autoreg</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">selected_features</span><span class="p">)</span>
            <span class="n">selected_autoreg</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">forced_autoreg_not_selected</span><span class="p">)</span>
            <span class="n">selected_autoreg</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">autoreg_cols</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selected_autoreg</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="p">(</span><span class="s2">&quot;No autoregressive features have been selected. Since a Forecaster &quot;</span>
             <span class="s2">&quot;cannot be created without them, be sure to include at least one &quot;</span>
             <span class="s2">&quot;using the `force_inclusion` parameter.&quot;</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="s1">&#39;lags&#39;</span><span class="p">):</span>
            <span class="n">selected_autoreg</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">feature</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;lag_&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span> 
                                <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">selected_autoreg</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Recursive feature elimination (</span><span class="si">{</span><span class="n">selector</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--------------------------------&quot;</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">selector</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total number of records available: </span><span class="si">{</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total number of records used for feature selection: </span><span class="si">{</span><span class="n">X_train_sample</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of features available: </span><span class="si">{</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> 
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Autoreg (n=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">autoreg_cols</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Exog    (n=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">exog_cols</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of features selected: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">selected_features</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Autoreg (n=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">selected_autoreg</span><span class="p">)</span><span class="si">}</span><span class="s2">) : </span><span class="si">{</span><span class="n">selected_autoreg</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Exog    (n=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">selected_exog</span><span class="p">)</span><span class="si">}</span><span class="s2">) : </span><span class="si">{</span><span class="n">selected_exog</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">selected_autoreg</span><span class="p">,</span> <span class="n">selected_exog</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>









  




                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2021 - 2024 Joaqun Amat Rodrigo, Javier Escobar Ortiz
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            

  
    
  


  
    
  



  


<h4>Cookie consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
      
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="analytics" checked>
          <span class="task-list-indicator"></span>
          Google Analytics
        </label>
      </li>
    
      
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="github" checked>
          <span class="task-list-indicator"></span>
          GitHub
        </label>
      </li>
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout(function(){document.querySelector("[data-md-component=consent]").hidden=!1},250);var action,form=document.forms.consent;for(action of["submit","reset"])form.addEventListener(action,function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map(function(e){return[e,!0]}))),location.hash="",location.reload()})</script>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.top"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.fe8b6f2b.min.js"></script>
      
    
  </body>
</html>