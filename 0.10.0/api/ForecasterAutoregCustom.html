
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Python library that eases using scikit-learn regressors as multi-step forecasters. It also works with any regressor compatible with the scikit-learn API (XGBoost, LightGBM, Ranger...).">
      
      
        <meta name="author" content="Joaquin Amat Rodrigo and Javier Escobar Ortiz">
      
      
        <link rel="canonical" href="https://joaquinamatrodrigo.github.io/skforecast/0.10.0/api/ForecasterAutoregCustom.html">
      
      
        <link rel="prev" href="ForecasterAutoreg.html">
      
      
        <link rel="next" href="ForecasterAutoregDirect.html">
      
      <link rel="icon" href="../img/favicon.png">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.15">
    
    
      
        <title>ForecasterAutoregCustom - Skforecast Docs</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.26e3688c.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ecc896b0.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,700,700i%7CUbuntu+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Open Sans";--md-code-font:"Ubuntu Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  


  <script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-GR8X9Z9LKL"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-GR8X9Z9LKL",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-GR8X9Z9LKL",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>

  
    <script>var consent;"undefined"==typeof __md_analytics||(consent=__md_get("__consent"))&&consent.analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="light" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#forecasterautoregcustom" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
  You're not viewing the latest version.
  <a href="../..">
    <strong>Click here to go to latest.</strong>
  </a>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),outdated=__md_get("__outdated",sessionStorage);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Skforecast Docs" class="md-header__button md-logo" aria-label="Skforecast Docs" data-md-component="logo">
      
  <img src="../img/logo-skforecast-orange-no-backgound.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Skforecast Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              ForecasterAutoregCustom
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
          
            
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="light" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
            
              <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
              </label>
            
          
            
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
            
              <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
              </label>
            
          
        </form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/JoaquinAmatRodrigo/skforecast" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../index.html" class="md-tabs__link">
        Home
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../introduction-forecasting/introduction-forecasting.html" class="md-tabs__link">
        Introduction to forecasting
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../user_guides/quick-start-skforecast.html" class="md-tabs__link">
        Quick start
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../user_guides/input-data.html" class="md-tabs__link">
        User Guides
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../examples/examples.html" class="md-tabs__link">
        Examples and tutorials
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="ForecasterAutoreg.html" class="md-tabs__link md-tabs__link--active">
        API Reference
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../faq/faq.html" class="md-tabs__link">
        FAQ and Tips
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../releases/releases.html" class="md-tabs__link">
      Releases
    </a>
  </li>

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Skforecast Docs" class="md-nav__button md-logo" aria-label="Skforecast Docs" data-md-component="logo">
      
  <img src="../img/logo-skforecast-orange-no-backgound.png" alt="logo">

    </a>
    Skforecast Docs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/JoaquinAmatRodrigo/skforecast" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1" >
      
      
      
        <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
          Home
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Home
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        Welcome to skforecast
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../introduction-forecasting/introduction-forecasting.html" class="md-nav__link">
        Introduction to forecasting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/quick-start-skforecast.html" class="md-nav__link">
        Quick start
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/input-data.html" class="md-nav__link">
        User Guides
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examples/examples.html" class="md-nav__link">
        Examples and tutorials
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterAutoreg.html" class="md-nav__link">
        API Reference
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../faq/faq.html" class="md-nav__link">
        FAQ and Tips
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../releases/releases.html" class="md-nav__link">
        Releases
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Introduction to forecasting
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Introduction to forecasting
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../introduction-forecasting/introduction-forecasting.html" class="md-nav__link">
        Introduction to forecasting
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Quick start
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Quick start
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/quick-start-skforecast.html" class="md-nav__link">
        Quick start
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../introduction-forecasting/forecaster-parameters.html" class="md-nav__link">
        Forecaster Parameters
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../introduction-forecasting/forecaster-attributes.html" class="md-nav__link">
        Forecaster Attributes
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          User Guides
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          User Guides
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/input-data.html" class="md-nav__link">
        Input data
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/autoregresive-forecaster.html" class="md-nav__link">
        Recursive multi-step forecasting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/direct-multi-step-forecasting.html" class="md-nav__link">
        Direct multi-step forecasting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/independent-multi-time-series-forecasting.html" class="md-nav__link">
        Independent multi-time series forecasting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/dependent-multi-series-multivariate-forecasting.html" class="md-nav__link">
        Dependent multivariate series forecasting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/forecasting-sarimax-arima.html" class="md-nav__link">
        ARIMA and SARIMAX forecasting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/exogenous-variables.html" class="md-nav__link">
        Exogenous variables
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/custom-predictors.html" class="md-nav__link">
        Custom predictors
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/weighted-time-series-forecasting.html" class="md-nav__link">
        Weighted time series forecasting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/backtesting.html" class="md-nav__link">
        Backtesting forecaster
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/hyperparameter-tuning-and-lags-selection.html" class="md-nav__link">
        Hyperparameter tuning and lags selection
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/sklearn-transformers-and-pipeline.html" class="md-nav__link">
        Scikit-learn Transformers and Pipelines
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/probabilistic-forecasting.html" class="md-nav__link">
        Probabilistic forecasting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/feature-importances.html" class="md-nav__link">
        Feature importances
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/categorical-features.html" class="md-nav__link">
        Categorical features
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/forecasting-xgboost-lightgbm.html" class="md-nav__link">
        Forecasting with XGBoost and LightGBM
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/forecaster-in-production.html" class="md-nav__link">
        Forecaster in production
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/save-load-forecaster.html" class="md-nav__link">
        Save and load forecaster
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/shap-values-skforecast.html" class="md-nav__link">
        Shap-values
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/skforecast-in-GPU.html" class="md-nav__link">
        Skforecast in GPU
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/plot-forecaster-residuals.html" class="md-nav__link">
        Plot forecaster residuals
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
      
      
      
        <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          Examples and tutorials
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Examples and tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examples/examples.html" class="md-nav__link">
        Examples and tutorials
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
      
      
      
        <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
          API Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          API Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterAutoreg.html" class="md-nav__link">
        ForecasterAutoreg
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          ForecasterAutoregCustom
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="ForecasterAutoregCustom.html" class="md-nav__link md-nav__link--active">
        ForecasterAutoregCustom
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom" class="md-nav__link">
    ForecasterAutoregCustom
  </a>
  
    <nav class="md-nav" aria-label="ForecasterAutoregCustom">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom.create_train_X_y" class="md-nav__link">
    create_train_X_y()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom.create_sample_weights" class="md-nav__link">
    create_sample_weights()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom.fit" class="md-nav__link">
    fit()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom._recursive_predict" class="md-nav__link">
    _recursive_predict()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom.predict" class="md-nav__link">
    predict()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom.predict_bootstrapping" class="md-nav__link">
    predict_bootstrapping()
  </a>
  
    <nav class="md-nav" aria-label="predict_bootstrapping()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom.predict_bootstrapping--notes" class="md-nav__link">
    Notes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom.predict_interval" class="md-nav__link">
    predict_interval()
  </a>
  
    <nav class="md-nav" aria-label="predict_interval()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom.predict_interval--notes" class="md-nav__link">
    Notes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom.predict_dist" class="md-nav__link">
    predict_dist()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom.set_params" class="md-nav__link">
    set_params()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom.set_fit_kwargs" class="md-nav__link">
    set_fit_kwargs()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom.set_out_sample_residuals" class="md-nav__link">
    set_out_sample_residuals()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom.get_feature_importances" class="md-nav__link">
    get_feature_importances()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterAutoregDirect.html" class="md-nav__link">
        ForecasterAutoregDirect
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterMultiSeries.html" class="md-nav__link">
        ForecasterMultiSeries
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterMultiSeriesCustom.html" class="md-nav__link">
        ForecasterMultiSeriesCustom
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterMultiVariate.html" class="md-nav__link">
        ForecasterMultiVariate
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterSarimax.html" class="md-nav__link">
        ForecasterSarimax
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Sarimax.html" class="md-nav__link">
        Sarimax
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="model_selection.html" class="md-nav__link">
        model_selection
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="model_selection_multiseries.html" class="md-nav__link">
        model_selection_multiseries
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="model_selection_sarimax.html" class="md-nav__link">
        model_selection_sarimax
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="preprocessing.html" class="md-nav__link">
        preprocessing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="plot.html" class="md-nav__link">
        plot
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="utils.html" class="md-nav__link">
        utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="exceptions.html" class="md-nav__link">
        exceptions
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
      
      
      
        <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
          FAQ and Tips
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          FAQ and Tips
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../faq/faq.html" class="md-nav__link">
        Table of contents
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../faq/time-series-differentiation.html" class="md-nav__link">
        Time series differentiation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../faq/non-negative-predictions.html" class="md-nav__link">
        Avoid negative predictions when forecasting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../faq/forecasting-time-series-with-missing-values.html" class="md-nav__link">
        Forecasting time series with missing values
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../faq/cyclical-features-time-series.html" class="md-nav__link">
        Cyclical features in time series
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../faq/parallelization-skforecast.html" class="md-nav__link">
        Parallelization in skforecast
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../faq/profiling-skforecast.html" class="md-nav__link">
        Profiling skforecast
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../releases/releases.html" class="md-nav__link">
        Releases
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom" class="md-nav__link">
    ForecasterAutoregCustom
  </a>
  
    <nav class="md-nav" aria-label="ForecasterAutoregCustom">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom.create_train_X_y" class="md-nav__link">
    create_train_X_y()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom.create_sample_weights" class="md-nav__link">
    create_sample_weights()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom.fit" class="md-nav__link">
    fit()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom._recursive_predict" class="md-nav__link">
    _recursive_predict()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom.predict" class="md-nav__link">
    predict()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom.predict_bootstrapping" class="md-nav__link">
    predict_bootstrapping()
  </a>
  
    <nav class="md-nav" aria-label="predict_bootstrapping()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom.predict_bootstrapping--notes" class="md-nav__link">
    Notes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom.predict_interval" class="md-nav__link">
    predict_interval()
  </a>
  
    <nav class="md-nav" aria-label="predict_interval()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom.predict_interval--notes" class="md-nav__link">
    Notes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom.predict_dist" class="md-nav__link">
    predict_dist()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom.set_params" class="md-nav__link">
    set_params()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom.set_fit_kwargs" class="md-nav__link">
    set_fit_kwargs()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom.set_out_sample_residuals" class="md-nav__link">
    set_out_sample_residuals()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom.get_feature_importances" class="md-nav__link">
    get_feature_importances()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="forecasterautoregcustom"><code>ForecasterAutoregCustom</code><a class="headerlink" href="#forecasterautoregcustom" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-class">



<h2 id="skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom" class="doc doc-heading">
<code class="highlight language-python"><span class="n">ForecasterAutoregCustom</span><span class="p">(</span><span class="n">regressor</span><span class="p">,</span> <span class="n">fun_predictors</span><span class="p">,</span> <span class="n">window_size</span><span class="p">,</span> <span class="n">name_predictors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">transformer_y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">transformer_exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">weight_func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">differentiation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fit_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">forecaster_id</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents first">
      <p class="doc doc-class-bases">
        Bases: <code><span title="skforecast.ForecasterBase.ForecasterBase">ForecasterBase</span></code></p>

  
      <p>This class turns any regressor compatible with the scikit-learn API into a
recursive (multi-step) forecaster with a custom function to create predictors.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>regressor</code></td>
          <td>
                <code>regressor or pipeline compatible with the scikit-learn API</code>
          </td>
          <td><p>An instance of a regressor or pipeline compatible with the scikit-learn API.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>fun_predictors</code></td>
          <td>
                <code><span title="typing.Callable">Callable</span></code>
          </td>
          <td><p>Function that receives a time series as input (numpy ndarray) and returns 
another numpy ndarray with the predictors.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>window_size</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Size of the window needed by <code>fun_predictors</code> to create the predictors.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>name_predictors</code></td>
          <td>
                <code>list</code>
          </td>
          <td><p>Name of the predictors returned by <code>fun_predictors</code>. If <code>None</code>, predictors are
named using the prefix 'custom_predictor_<i>' where <code>i</code> is the index of the position
the predictor has in the returned array of <code>fun_predictors</code>.</p></td>
          <td>
                <code>`None`</code>
          </td>
        </tr>
        <tr>
          <td><code>transformer_y</code></td>
          <td>
                <code>object transformer (preprocessor)</code>
          </td>
          <td><p>An instance of a transformer (preprocessor) compatible with the scikit-learn
preprocessing API with methods: fit, transform, fit_transform and inverse_transform.
ColumnTransformers are not allowed since they do not have inverse_transform method.
The transformation is applied to <code>y</code> before training the forecaster.</p></td>
          <td>
                <code>`None`</code>
          </td>
        </tr>
        <tr>
          <td><code>transformer_exog</code></td>
          <td>
                <code>object transformer (preprocessor)</code>
          </td>
          <td><p>An instance of a transformer (preprocessor) compatible with the scikit-learn
preprocessing API. The transformation is applied to <code>exog</code> before training the
forecaster. <code>inverse_transform</code> is not available when using ColumnTransformers.</p></td>
          <td>
                <code>`None`</code>
          </td>
        </tr>
        <tr>
          <td><code>weight_func</code></td>
          <td>
                <code><span title="typing.Callable">Callable</span></code>
          </td>
          <td><p>Function that defines the individual weights for each sample based on the
index. For example, a function that assigns a lower weight to certain dates.
Ignored if <code>regressor</code> does not have the argument <code>sample_weight</code> in its <code>fit</code>
method. The resulting <code>sample_weight</code> cannot have negative values.</p></td>
          <td>
                <code>`None`</code>
          </td>
        </tr>
        <tr>
          <td><code>differentiation</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Order of differencing applied to the time series before training the forecaster.
If <code>None</code>, no differencing is applied. The order of differentiation is the number
of times the differencing operation is applied to a time series. Differencing
involves computing the differences between consecutive data points in the series.
Diferentiarion is reversed in the output of <code>predict()</code> and <code>predict_interval()</code>.
<strong>WARNING: This argument is newly introduced and requires special attention. It
is still experimental and may undergo changes.</strong>
<strong>New in version 0.10.0</strong></p></td>
          <td>
                <code>`None`</code>
          </td>
        </tr>
        <tr>
          <td><code>fit_kwargs</code></td>
          <td>
                <code>dict</code>
          </td>
          <td><p>Additional arguments to be passed to the <code>fit</code> method of the regressor.
<strong>New in version 0.8.0</strong></p></td>
          <td>
                <code>`None`</code>
          </td>
        </tr>
        <tr>
          <td><code>forecaster_id</code></td>
          <td>
                <code>str, int</code>
          </td>
          <td><p>Name used as an identifier of the forecaster.
<strong>New in version 0.7.0</strong></p></td>
          <td>
                <code>`None`</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>regressor</code></td>
          <td>
                <code>regressor compatible with the scikit-learn API</code>
          </td>
          <td><p>An instance of a regressor compatible with the scikit-learn API.</p></td>
        </tr>
        <tr>
          <td><code>fun_predictors</code></td>
          <td>
                <code><span title="typing.Callable">Callable</span></code>
          </td>
          <td><p>Function that receives a time series as input (numpy ndarray) and returns
another numpy ndarray with the predictors.
<strong>New in version 0.7.0</strong></p></td>
        </tr>
        <tr>
          <td><code>source_code_fun_predictors</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Source code of the custom function used to create the predictors.
<strong>New in version 0.7.0</strong></p></td>
        </tr>
        <tr>
          <td><code>window_size</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Size of the window needed by <code>fun_predictors</code> to create the predictors.
If <code>differentiation</code> is not <code>None</code>, <code>window_size</code> is increased by the
order of differentiation.</p></td>
        </tr>
        <tr>
          <td><code>name_predictors</code></td>
          <td>
                <code>list</code>
          </td>
          <td><p>Name of the predictors returned by <code>fun_predictors</code>. If <code>None</code>, predictors are
named using the prefix 'custom_predictor_<i>' where <code>i</code> is the index of the position
the predictor has in the returned array of <code>fun_predictors</code>.</p></td>
        </tr>
        <tr>
          <td><code>transformer_y</code></td>
          <td>
                <code>object transformer (preprocessor)</code>
          </td>
          <td><p>An instance of a transformer (preprocessor) compatible with the scikit-learn
preprocessing API with methods: fit, transform, fit_transform and inverse_transform.
ColumnTransformers are not allowed since they do not have inverse_transform method.
The transformation is applied to <code>y</code> before training the forecaster.</p></td>
        </tr>
        <tr>
          <td><code>transformer_exog</code></td>
          <td>
                <code>object transformer (preprocessor)</code>
          </td>
          <td><p>An instance of a transformer (preprocessor) compatible with the scikit-learn
preprocessing API. The transformation is applied to <code>exog</code> before training the
forecaster. <code>inverse_transform</code> is not available when using ColumnTransformers.</p></td>
        </tr>
        <tr>
          <td><code>weight_func</code></td>
          <td>
                <code><span title="typing.Callable">Callable</span></code>
          </td>
          <td><p>Function that defines the individual weights for each sample based on the
index. For example, a function that assigns a lower weight to certain dates.
Ignored if <code>regressor</code> does not have the argument <code>sample_weight</code> in its <code>fit</code>
method. The resulting <code>sample_weight</code> cannot have negative values.</p></td>
        </tr>
        <tr>
          <td><code>differentiation</code></td>
          <td>
                <code>int, default `None`</code>
          </td>
          <td><p>Order of differencing applied to the time series before training the forecaster.
If <code>None</code>, no differencing is applied. The order of differentiation is the number
of times the differencing operation is applied to a time series. Differencing
involves computing the differences between consecutive data points in the series.
Differentiation is reversed in the output of <code>predict()</code> and <code>predict_interval()</code>.
<strong>WARNING: This argument is newly introduced and requires special attention. It
is still experimental and may undergo changes.</strong>
<strong>New in version 0.10.0</strong></p></td>
        </tr>
        <tr>
          <td><code>source_code_weight_func</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Source code of the custom function used to create weights.</p></td>
        </tr>
        <tr>
          <td><code>last_window</code></td>
          <td>
                <code>pandas Series</code>
          </td>
          <td><p>This window represents the most recent data observed by the predictor
during its training phase. It contains the values needed to predict the
next step immediately after the training data. These values are stored
in the original scale of the time series before undergoing any transformations
or differentiation. When <code>differentiation</code> parameter is specified, the
dimensions of the <code>last_window</code> are expanded as many values as the order
of differentiation. For example, if <code>fun_predictors()</code> requires 7 lagged
values and <code>differentiation=1</code>, <code>last_window</code> will contain 8 values.</p></td>
        </tr>
        <tr>
          <td><code>index_type</code></td>
          <td>
                <code>type</code>
          </td>
          <td><p>Type of index of the input used in training.</p></td>
        </tr>
        <tr>
          <td><code>index_freq</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Frequency of Index of the input used in training.</p></td>
        </tr>
        <tr>
          <td><code>training_range</code></td>
          <td>
                <code>pandas Index</code>
          </td>
          <td><p>First and last values of index of the data used during training.</p></td>
        </tr>
        <tr>
          <td><code>included_exog</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>If the forecaster has been trained using exogenous variable/s.</p></td>
        </tr>
        <tr>
          <td><code>exog_type</code></td>
          <td>
                <code>type</code>
          </td>
          <td><p>Type of exogenous data (pandas Series or DataFrame) used in training.</p></td>
        </tr>
        <tr>
          <td><code>exog_dtypes</code></td>
          <td>
                <code>dict</code>
          </td>
          <td><p>Type of each exogenous variable/s used in training. If <code>transformer_exog</code> 
is used, the dtypes are calculated after the transformation.</p></td>
        </tr>
        <tr>
          <td><code>exog_col_names</code></td>
          <td>
                <code>list</code>
          </td>
          <td><p>Names of columns of <code>exog</code> if <code>exog</code> used in training was a pandas
DataFrame.</p></td>
        </tr>
        <tr>
          <td><code>X_train_col_names</code></td>
          <td>
                <code>list</code>
          </td>
          <td><p>Names of columns of the matrix created internally for training.</p></td>
        </tr>
        <tr>
          <td><code>fit_kwargs</code></td>
          <td>
                <code>dict</code>
          </td>
          <td><p>Additional arguments to be passed to the <code>fit</code> method of the regressor.
<strong>New in version 0.8.0</strong></p></td>
        </tr>
        <tr>
          <td><code>in_sample_residuals</code></td>
          <td>
                <code>numpy ndarray</code>
          </td>
          <td><p>Residuals of the model when predicting training data. Only stored up to
1000 values. If <code>transformer_y</code> is not <code>None</code>, residuals are stored in the
transformed scale.</p></td>
        </tr>
        <tr>
          <td><code>out_sample_residuals</code></td>
          <td>
                <code>numpy ndarray</code>
          </td>
          <td><p>Residuals of the model when predicting non training data. Only stored
up to 1000 values. If <code>transformer_y</code> is not <code>None</code>, residuals
are assumed to be in the transformed scale. Use <code>set_out_sample_residuals</code> 
method to set values.</p></td>
        </tr>
        <tr>
          <td><code>fitted</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Tag to identify if the regressor has been fitted (trained).</p></td>
        </tr>
        <tr>
          <td><code>creation_date</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Date of creation.</p></td>
        </tr>
        <tr>
          <td><code>fit_date</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Date of last fit.</p></td>
        </tr>
        <tr>
          <td><code>skforcast_version</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Version of skforecast library used to create the forecaster.</p></td>
        </tr>
        <tr>
          <td><code>python_version</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Version of python used to create the forecaster.</p></td>
        </tr>
        <tr>
          <td><code>forecaster_id</code></td>
          <td>
                <code>str, int</code>
          </td>
          <td><p>Name used as an identifier of the forecaster.</p></td>
        </tr>
    </tbody>
  </table>


          <details class="quote">
            <summary>Source code in <code>skforecast\ForecasterAutoregCustom\ForecasterAutoregCustom.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> 
    <span class="n">regressor</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span> 
    <span class="n">fun_predictors</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> 
    <span class="n">window_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">name_predictors</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">transformer_y</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">object</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">transformer_exog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">object</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">weight_func</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">differentiation</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">fit_kwargs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">forecaster_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span><span class="o">=</span><span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">regressor</span>                  <span class="o">=</span> <span class="n">regressor</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fun_predictors</span>             <span class="o">=</span> <span class="n">fun_predictors</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">source_code_fun_predictors</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span>                <span class="o">=</span> <span class="n">window_size</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">name_predictors</span>            <span class="o">=</span> <span class="n">name_predictors</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">transformer_y</span>              <span class="o">=</span> <span class="n">transformer_y</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">transformer_exog</span>           <span class="o">=</span> <span class="n">transformer_exog</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">weight_func</span>                <span class="o">=</span> <span class="n">weight_func</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span>            <span class="o">=</span> <span class="n">differentiation</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">differentiator</span>             <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">source_code_weight_func</span>    <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">last_window</span>                <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">index_type</span>                 <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">index_freq</span>                 <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">training_range</span>             <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">included_exog</span>              <span class="o">=</span> <span class="kc">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">exog_type</span>                  <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">exog_dtypes</span>                <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">exog_col_names</span>             <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">X_train_col_names</span>          <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals</span>        <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals</span>       <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fitted</span>                     <span class="o">=</span> <span class="kc">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">creation_date</span>              <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fit_date</span>                   <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">skforcast_version</span>          <span class="o">=</span> <span class="n">skforecast</span><span class="o">.</span><span class="n">__version__</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">python_version</span>             <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">version</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">forecaster_id</span>              <span class="o">=</span> <span class="n">forecaster_id</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">window_size</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Argument `window_size` must be an int. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">window_size</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">differentiation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">differentiation</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;`differentiation` must be greater than 0. Got </span><span class="si">{</span><span class="n">differentiation</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">differentiator</span> <span class="o">=</span> <span class="n">TimeSeriesDifferentiator</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fun_predictors</span><span class="p">,</span> <span class="n">Callable</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Argument `fun_predictors` must be a Callable. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">fun_predictors</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">source_code_fun_predictors</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getsource</span><span class="p">(</span><span class="n">fun_predictors</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">weight_func</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_code_weight_func</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">initialize_weights</span><span class="p">(</span>
        <span class="n">forecaster_name</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> 
        <span class="n">regressor</span>       <span class="o">=</span> <span class="n">regressor</span><span class="p">,</span> 
        <span class="n">weight_func</span>     <span class="o">=</span> <span class="n">weight_func</span><span class="p">,</span> 
        <span class="n">series_weights</span>  <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">fit_kwargs</span> <span class="o">=</span> <span class="n">check_select_fit_kwargs</span><span class="p">(</span>
                          <span class="n">regressor</span>  <span class="o">=</span> <span class="n">regressor</span><span class="p">,</span>
                          <span class="n">fit_kwargs</span> <span class="o">=</span> <span class="n">fit_kwargs</span>
                      <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom.create_train_X_y" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_train_X_y</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom.create_train_X_y" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Create training matrices from univariate time series and exogenous
variables.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>y</code></td>
          <td>
                <code>pandas Series</code>
          </td>
          <td><p>Training time series.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>exog</code></td>
          <td>
                <code>pandas Series, pandas DataFrame</code>
          </td>
          <td><p>Exogenous variable/s included as predictor/s. Must have the same
number of observations as <code>y</code> and their indexes must be aligned.</p></td>
          <td>
                <code>`None`</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>X_train</code></td>          <td>
                <code>pandas DataFrame</code>
          </td>
          <td><p>Pandas DataFrame with the training values (predictors).</p></td>
        </tr>
        <tr>
<td><code>y_train</code></td>          <td>
                <code>pandas Series</code>
          </td>
          <td><p>Values (target) of the time series related to each row of <code>X_train</code>.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>skforecast\ForecasterAutoregCustom\ForecasterAutoregCustom.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_train_X_y</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]]</span><span class="o">=</span><span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create training matrices from univariate time series and exogenous</span>
<span class="sd">    variables.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    y : pandas Series</span>
<span class="sd">        Training time series.</span>
<span class="sd">    exog : pandas Series, pandas DataFrame, default `None`</span>
<span class="sd">        Exogenous variable/s included as predictor/s. Must have the same</span>
<span class="sd">        number of observations as `y` and their indexes must be aligned.</span>


<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    X_train : pandas DataFrame</span>
<span class="sd">        Pandas DataFrame with the training values (predictors).</span>
<span class="sd">    y_train : pandas Series</span>
<span class="sd">        Values (target) of the time series related to each row of `X_train`.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`y` must have as many values as the windows_size needed by &quot;</span>
             <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">fun_predictors</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">. For this Forecaster the &quot;</span>
             <span class="sa">f</span><span class="s2">&quot;minimum length is </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="n">check_y</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">transform_series</span><span class="p">(</span>
            <span class="n">series</span>            <span class="o">=</span> <span class="n">y</span><span class="p">,</span>
            <span class="n">transformer</span>       <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformer_y</span><span class="p">,</span>
            <span class="n">fit</span>               <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
            <span class="n">inverse_transform</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="p">)</span>
    <span class="n">y_values</span><span class="p">,</span> <span class="n">y_index</span> <span class="o">=</span> <span class="n">preprocess_y</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">y_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiator</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">y_values</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s1">&#39;`exog` must have same number of samples as `y`. &#39;</span>
                <span class="sa">f</span><span class="s1">&#39;length `exog`: (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span><span class="si">}</span><span class="s1">), length `y`: (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="si">}</span><span class="s1">)&#39;</span>
            <span class="p">)</span>
        <span class="n">check_exog</span><span class="p">(</span><span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span> <span class="n">allow_nan</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
            <span class="n">exog</span> <span class="o">=</span> <span class="n">transform_series</span><span class="p">(</span>
                        <span class="n">series</span>            <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
                        <span class="n">transformer</span>       <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformer_exog</span><span class="p">,</span>
                        <span class="n">fit</span>               <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                        <span class="n">inverse_transform</span> <span class="o">=</span> <span class="kc">False</span>
                   <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">exog</span> <span class="o">=</span> <span class="n">transform_dataframe</span><span class="p">(</span>
                        <span class="n">df</span>                <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
                        <span class="n">transformer</span>       <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformer_exog</span><span class="p">,</span>
                        <span class="n">fit</span>               <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                        <span class="n">inverse_transform</span> <span class="o">=</span> <span class="kc">False</span>
                   <span class="p">)</span>

        <span class="n">check_exog</span><span class="p">(</span><span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span> <span class="n">allow_nan</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">check_exog_dtypes</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exog_dtypes</span> <span class="o">=</span> <span class="n">get_exog_dtypes</span><span class="p">(</span><span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">)</span>

        <span class="n">_</span><span class="p">,</span> <span class="n">exog_index</span> <span class="o">=</span> <span class="n">preprocess_exog</span><span class="p">(</span><span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span> <span class="n">return_values</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">exog_index</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">y_index</span><span class="p">)]</span> <span class="o">==</span> <span class="n">y_index</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="p">(</span><span class="s2">&quot;Different index for `y` and `exog`. They must be equal &quot;</span>
                 <span class="s2">&quot;to ensure the correct alignment of values.&quot;</span><span class="p">)</span>
            <span class="p">)</span>

    <span class="n">X_train</span>  <span class="o">=</span> <span class="p">[]</span>
    <span class="n">y_train</span>  <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="p">):</span>

        <span class="n">train_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span>
        <span class="n">test_index</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="o">+</span> <span class="n">i</span>

        <span class="n">X_train</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fun_predictors</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_values</span><span class="p">[</span><span class="n">train_index</span><span class="p">]))</span>
        <span class="n">y_train</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_values</span><span class="p">[</span><span class="n">test_index</span><span class="p">])</span>

    <span class="n">X_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
    <span class="n">y_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name_predictors</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">X_train_col_names</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;custom_predictor_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name_predictors</span><span class="p">)</span> <span class="o">!=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="p">(</span><span class="s2">&quot;The length of provided predictors names (`name_predictors`) do not &quot;</span>
                 <span class="s2">&quot;match the number of columns created by `fun_predictors()`.&quot;</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="n">X_train_col_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name_predictors</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;`fun_predictors()` is returning `NaN` values.&quot;</span>
        <span class="p">)</span>

    <span class="n">expected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun_predictors</span><span class="p">(</span><span class="n">y_values</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">observed</span> <span class="o">=</span> <span class="n">X_train</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>

    <span class="k">if</span> <span class="n">expected</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">observed</span><span class="o">.</span><span class="n">shape</span> <span class="ow">or</span> <span class="ow">not</span> <span class="p">(</span><span class="n">expected</span> <span class="o">==</span> <span class="n">observed</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The `window_size` argument (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2">), declared when &quot;</span>
             <span class="sa">f</span><span class="s2">&quot;initializing the forecaster, does not correspond to the window &quot;</span>
             <span class="sa">f</span><span class="s2">&quot;used by `fun_predictors()`.&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="n">X_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
                  <span class="n">data</span>    <span class="o">=</span> <span class="n">X_train</span><span class="p">,</span>
                  <span class="n">columns</span> <span class="o">=</span> <span class="n">X_train_col_names</span><span class="p">,</span>
                  <span class="n">index</span>   <span class="o">=</span> <span class="n">y_index</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="p">:</span> <span class="p">]</span>
              <span class="p">)</span>

    <span class="k">if</span> <span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># The first `self.window_size` positions have to be removed from exog</span>
        <span class="c1"># since they are not in X_train.</span>
        <span class="n">exog_to_train</span> <span class="o">=</span> <span class="n">exog</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="p">:,</span> <span class="p">]</span>
        <span class="n">check_exog_dtypes</span><span class="p">(</span><span class="n">exog_to_train</span><span class="p">)</span>
        <span class="n">X_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="n">X_train</span><span class="p">,</span> <span class="n">exog_to_train</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">X_train_col_names</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
    <span class="n">y_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span>
                  <span class="n">data</span>  <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span>
                  <span class="n">index</span> <span class="o">=</span> <span class="n">y_index</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="p">:</span> <span class="p">],</span>
                  <span class="n">name</span>  <span class="o">=</span> <span class="s1">&#39;y&#39;</span>
              <span class="p">)</span>

    <span class="k">return</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom.create_sample_weights" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_sample_weights</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span></code>

<a href="#skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom.create_sample_weights" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Crate weights for each observation according to the forecaster's attribute
<code>weight_func</code>.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>X_train</code></td>
          <td>
                <code>pandas DataFrame</code>
          </td>
          <td><p>Dataframe created with the <code>create_train_X_y</code> method, first return.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>sample_weight</code></td>          <td>
                <code>numpy ndarray</code>
          </td>
          <td><p>Weights to use in <code>fit</code> method.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>skforecast\ForecasterAutoregCustom\ForecasterAutoregCustom.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_sample_weights</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">X_train</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
<span class="p">)</span><span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Crate weights for each observation according to the forecaster&#39;s attribute</span>
<span class="sd">    `weight_func`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    X_train : pandas DataFrame</span>
<span class="sd">        Dataframe created with the `create_train_X_y` method, first return.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    sample_weight : numpy ndarray</span>
<span class="sd">        Weights to use in `fit` method.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">sample_weight</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight_func</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">sample_weight</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight_func</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">sample_weight</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">sample_weight</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;The resulting `sample_weight` cannot have NaN values.&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">sample_weight</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;The resulting `sample_weight` cannot have negative values.&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">sample_weight</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="p">(</span><span class="s2">&quot;The resulting `sample_weight` cannot be normalized because &quot;</span>
                 <span class="s2">&quot;the sum of the weights is zero.&quot;</span><span class="p">)</span>
            <span class="p">)</span>

    <span class="k">return</span> <span class="n">sample_weight</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom.fit" class="doc doc-heading">
<code class="highlight language-python"><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">store_in_sample_residuals</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom.fit" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Training Forecaster.</p>
<p>Additional arguments to be passed to the <code>fit</code> method of the regressor 
can be added with the <code>fit_kwargs</code> argument when initializing the forecaster.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>y</code></td>
          <td>
                <code>pandas Series</code>
          </td>
          <td><p>Training time series.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>exog</code></td>
          <td>
                <code>pandas Series, pandas DataFrame</code>
          </td>
          <td><p>Exogenous variable/s included as predictor/s. Must have the same
number of observations as <code>y</code> and their indexes must be aligned so
that y[i] is regressed on exog[i].</p></td>
          <td>
                <code>`None`</code>
          </td>
        </tr>
        <tr>
          <td><code>store_in_sample_residuals</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>If <code>True</code>, in-sample residuals will be stored in the forecaster object
after fitting.</p></td>
          <td>
                <code>`True`</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>None</code>
          </td>
          <td></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>skforecast\ForecasterAutoregCustom\ForecasterAutoregCustom.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">fit</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">store_in_sample_residuals</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Training Forecaster.</span>

<span class="sd">    Additional arguments to be passed to the `fit` method of the regressor </span>
<span class="sd">    can be added with the `fit_kwargs` argument when initializing the forecaster.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    y : pandas Series</span>
<span class="sd">        Training time series.</span>
<span class="sd">    exog : pandas Series, pandas DataFrame, default `None`</span>
<span class="sd">        Exogenous variable/s included as predictor/s. Must have the same</span>
<span class="sd">        number of observations as `y` and their indexes must be aligned so</span>
<span class="sd">        that y[i] is regressed on exog[i].</span>
<span class="sd">    store_in_sample_residuals : bool, default `True`</span>
<span class="sd">        If `True`, in-sample residuals will be stored in the forecaster object</span>
<span class="sd">        after fitting.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Reset values in case the forecaster has already been fitted.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">index_type</span>          <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">index_freq</span>          <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">last_window</span>         <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">included_exog</span>       <span class="o">=</span> <span class="kc">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">exog_type</span>           <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">exog_dtypes</span>         <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">exog_col_names</span>      <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">X_train_col_names</span>   <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fitted</span>              <span class="o">=</span> <span class="kc">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">training_range</span>      <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">included_exog</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exog_type</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exog_col_names</span> <span class="o">=</span> \
             <span class="n">exog</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="k">else</span> <span class="n">exog</span><span class="o">.</span><span class="n">name</span>

    <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_train_X_y</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">)</span>
    <span class="n">sample_weight</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_sample_weights</span><span class="p">(</span><span class="n">X_train</span><span class="o">=</span><span class="n">X_train</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">sample_weight</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">regressor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="n">sample_weight</span><span class="p">,</span>
                           <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_kwargs</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">regressor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_kwargs</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">fitted</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fit_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">training_range</span> <span class="o">=</span> <span class="n">preprocess_y</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">return_values</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="mi">1</span><span class="p">][[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">index_type</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index_freq</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">freqstr</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">index_freq</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">step</span>

    <span class="c1"># This is done to save time during fit in functions such as backtesting()</span>
    <span class="k">if</span> <span class="n">store_in_sample_residuals</span><span class="p">:</span>

        <span class="n">residuals</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_train</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">regressor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">))</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">residuals</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1000</span><span class="p">:</span>
            <span class="c1"># Only up to 1000 residuals are stored</span>
            <span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>
            <span class="n">residuals</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
                            <span class="n">a</span>       <span class="o">=</span> <span class="n">residuals</span><span class="p">,</span> 
                            <span class="n">size</span>    <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span> 
                            <span class="n">replace</span> <span class="o">=</span> <span class="kc">False</span>
                        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals</span> <span class="o">=</span> <span class="n">residuals</span>

    <span class="c1"># The last time window of training data is stored so that predictors in</span>
    <span class="c1"># the first iteration of `predict()` can be calculated. It also includes</span>
    <span class="c1"># the values need to calculate the diferenctiation.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">last_window</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="p">:]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom._recursive_predict" class="doc doc-heading">
<code class="highlight language-python"><span class="n">_recursive_predict</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="n">last_window</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom._recursive_predict" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Predict n steps ahead. It is an iterative process in which, each prediction,
is used as a predictor for the next step.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>steps</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Number of future steps predicted.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>last_window</code></td>
          <td>
                <code>numpy ndarray</code>
          </td>
          <td><p>Series values used to create the predictors (lags) needed in the 
first iteration of the prediction (t + 1).</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>exog</code></td>
          <td>
                <code>numpy ndarray</code>
          </td>
          <td><p>Exogenous variable/s included as predictor/s.</p></td>
          <td>
                <code>`None`</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>predictions</code></td>          <td>
                <code>numpy ndarray</code>
          </td>
          <td><p>Predicted values.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>skforecast\ForecasterAutoregCustom\ForecasterAutoregCustom.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">_recursive_predict</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">last_window</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Predict n steps ahead. It is an iterative process in which, each prediction,</span>
<span class="sd">    is used as a predictor for the next step.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    steps : int</span>
<span class="sd">        Number of future steps predicted.</span>
<span class="sd">    last_window : numpy ndarray</span>
<span class="sd">        Series values used to create the predictors (lags) needed in the </span>
<span class="sd">        first iteration of the prediction (t + 1).</span>
<span class="sd">    exog : numpy ndarray, default `None`</span>
<span class="sd">        Exogenous variable/s included as predictor/s.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    predictions : numpy ndarray</span>
<span class="sd">        Predicted values.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
        <span class="n">X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun_predictors</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">last_window</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;`fun_predictors()` is returning `NaN` values.&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">X</span><span class="p">,</span> <span class="n">exog</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)))</span>

        <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
            <span class="c1"># Suppress scikit-learn warning: &quot;X does not have valid feature names,</span>
            <span class="c1"># but NoOpTransformer was fitted with feature names&quot;.</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
            <span class="n">prediction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">regressor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
            <span class="n">predictions</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">prediction</span><span class="o">.</span><span class="n">ravel</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># Update `last_window` values. The first position is discarded and </span>
        <span class="c1"># the new prediction is added at the end.</span>
        <span class="n">last_window</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">last_window</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">prediction</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">predictions</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom.predict" class="doc doc-heading">
<code class="highlight language-python"><span class="n">predict</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="n">last_window</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom.predict" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Predict n steps ahead. It is an recursive process in which, each prediction,
is used as a predictor for the next step.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>steps</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Number of future steps predicted.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>last_window</code></td>
          <td>
                <code>pandas Series</code>
          </td>
          <td><p>Series values used to create the predictors (lags) needed in the 
first iteration of the prediction (t + 1).
If <code>last_window = None</code>, the values stored in <code>self.last_window</code> are
used to calculate the initial predictors, and the predictions start
right after training data.</p></td>
          <td>
                <code>`None`</code>
          </td>
        </tr>
        <tr>
          <td><code>exog</code></td>
          <td>
                <code>pandas Series, pandas DataFrame</code>
          </td>
          <td><p>Exogenous variable/s included as predictor/s.</p></td>
          <td>
                <code>`None`</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>predictions</code></td>          <td>
                <code>pandas Series</code>
          </td>
          <td><p>Predicted values.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>skforecast\ForecasterAutoregCustom\ForecasterAutoregCustom.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">predict</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">last_window</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]]</span><span class="o">=</span><span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Predict n steps ahead. It is an recursive process in which, each prediction,</span>
<span class="sd">    is used as a predictor for the next step.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    steps : int</span>
<span class="sd">        Number of future steps predicted.</span>
<span class="sd">    last_window : pandas Series, default `None`</span>
<span class="sd">        Series values used to create the predictors (lags) needed in the </span>
<span class="sd">        first iteration of the prediction (t + 1).</span>
<span class="sd">        If `last_window = None`, the values stored in `self.last_window` are</span>
<span class="sd">        used to calculate the initial predictors, and the predictions start</span>
<span class="sd">        right after training data.</span>
<span class="sd">    exog : pandas Series, pandas DataFrame, default `None`</span>
<span class="sd">        Exogenous variable/s included as predictor/s.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    predictions : pandas Series</span>
<span class="sd">        Predicted values.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">last_window</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">last_window</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">last_window</span><span class="p">)</span>

    <span class="n">last_window</span> <span class="o">=</span> <span class="n">last_window</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="p">:]</span>

    <span class="n">check_predict_input</span><span class="p">(</span>
        <span class="n">forecaster_name</span>  <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
        <span class="n">steps</span>            <span class="o">=</span> <span class="n">steps</span><span class="p">,</span>
        <span class="n">fitted</span>           <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fitted</span><span class="p">,</span>
        <span class="n">included_exog</span>    <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">included_exog</span><span class="p">,</span>
        <span class="n">index_type</span>       <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_type</span><span class="p">,</span>
        <span class="n">index_freq</span>       <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_freq</span><span class="p">,</span>
        <span class="n">window_size</span>      <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="p">,</span>
        <span class="n">last_window</span>      <span class="o">=</span> <span class="n">last_window</span><span class="p">,</span>
        <span class="n">last_window_exog</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">exog</span>             <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
        <span class="n">exog_type</span>        <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exog_type</span><span class="p">,</span>
        <span class="n">exog_col_names</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exog_col_names</span><span class="p">,</span>
        <span class="n">interval</span>         <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">alpha</span>            <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">max_steps</span>        <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">levels</span>           <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">series_col_names</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
            <span class="n">exog</span> <span class="o">=</span> <span class="n">transform_dataframe</span><span class="p">(</span>
                       <span class="n">df</span>                <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
                       <span class="n">transformer</span>       <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformer_exog</span><span class="p">,</span>
                       <span class="n">fit</span>               <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                       <span class="n">inverse_transform</span> <span class="o">=</span> <span class="kc">False</span>
                   <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">exog</span> <span class="o">=</span> <span class="n">transform_series</span><span class="p">(</span>
                       <span class="n">series</span>            <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
                       <span class="n">transformer</span>       <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformer_exog</span><span class="p">,</span>
                       <span class="n">fit</span>               <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                       <span class="n">inverse_transform</span> <span class="o">=</span> <span class="kc">False</span>
                   <span class="p">)</span>
        <span class="n">check_exog_dtypes</span><span class="p">(</span><span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">)</span>
        <span class="n">exog_values</span> <span class="o">=</span> <span class="n">exog</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()[:</span><span class="n">steps</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">exog_values</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">last_window</span> <span class="o">=</span> <span class="n">transform_series</span><span class="p">(</span>
                      <span class="n">series</span>            <span class="o">=</span> <span class="n">last_window</span><span class="p">,</span>
                      <span class="n">transformer</span>       <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformer_y</span><span class="p">,</span>
                      <span class="n">fit</span>               <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                      <span class="n">inverse_transform</span> <span class="o">=</span> <span class="kc">False</span>
                  <span class="p">)</span>
    <span class="n">last_window_values</span><span class="p">,</span> <span class="n">last_window_index</span> <span class="o">=</span> <span class="n">preprocess_last_window</span><span class="p">(</span>
                                                <span class="n">last_window</span> <span class="o">=</span> <span class="n">last_window</span>
                                            <span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">last_window_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiator</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">last_window_values</span><span class="p">)</span>

    <span class="n">predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recursive_predict</span><span class="p">(</span>
                      <span class="n">steps</span>       <span class="o">=</span> <span class="n">steps</span><span class="p">,</span>
                      <span class="n">last_window</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">last_window_values</span><span class="p">),</span>
                      <span class="n">exog</span>        <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">exog_values</span><span class="p">)</span>
                  <span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiator</span><span class="o">.</span><span class="n">inverse_transform_next_window</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>

    <span class="n">predictions</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span>
                      <span class="n">data</span>  <span class="o">=</span> <span class="n">predictions</span><span class="p">,</span>
                      <span class="n">index</span> <span class="o">=</span> <span class="n">expand_index</span><span class="p">(</span>
                                  <span class="n">index</span> <span class="o">=</span> <span class="n">last_window_index</span><span class="p">,</span>
                                  <span class="n">steps</span> <span class="o">=</span> <span class="n">steps</span>
                              <span class="p">),</span>
                      <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;pred&#39;</span>
                  <span class="p">)</span>

    <span class="n">predictions</span> <span class="o">=</span> <span class="n">transform_series</span><span class="p">(</span>
                      <span class="n">series</span>            <span class="o">=</span> <span class="n">predictions</span><span class="p">,</span>
                      <span class="n">transformer</span>       <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformer_y</span><span class="p">,</span>
                      <span class="n">fit</span>               <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                      <span class="n">inverse_transform</span> <span class="o">=</span> <span class="kc">True</span>
                  <span class="p">)</span>

    <span class="k">return</span> <span class="n">predictions</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom.predict_bootstrapping" class="doc doc-heading">
<code class="highlight language-python"><span class="n">predict_bootstrapping</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="n">last_window</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_boot</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span> <span class="n">in_sample_residuals</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom.predict_bootstrapping" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Generate multiple forecasting predictions using a bootstrapping process. 
By sampling from a collection of past observed errors (the residuals),
each iteration of bootstrapping generates a different set of predictions. 
See the Notes section for more information. </p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>steps</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Number of future steps predicted.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>last_window</code></td>
          <td>
                <code>pandas Series</code>
          </td>
          <td><p>Series values used to create the predictors (lags) needed in the 
first iteration of the prediction (t + 1).
If <code>last_window = None</code>, the values stored in <code>self.last_window</code> are
used to calculate the initial predictors, and the predictions start
right after training data.</p></td>
          <td>
                <code>`None`</code>
          </td>
        </tr>
        <tr>
          <td><code>exog</code></td>
          <td>
                <code>pandas Series, pandas DataFrame</code>
          </td>
          <td><p>Exogenous variable/s included as predictor/s.</p></td>
          <td>
                <code>`None`</code>
          </td>
        </tr>
        <tr>
          <td><code>n_boot</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Number of bootstrapping iterations used to estimate prediction
intervals.</p></td>
          <td>
                <code>`500`</code>
          </td>
        </tr>
        <tr>
          <td><code>random_state</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Sets a seed to the random generator, so that boot intervals are always 
deterministic.</p></td>
          <td>
                <code>`123`</code>
          </td>
        </tr>
        <tr>
          <td><code>in_sample_residuals</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>If <code>True</code>, residuals from the training data are used as proxy of
prediction error to create prediction intervals. If <code>False</code>, out of
sample residuals are used. In the latter case, the user should have
calculated and stored the residuals within the forecaster (see
<code>set_out_sample_residuals()</code>).</p></td>
          <td>
                <code>`True`</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>boot_predictions</code></td>          <td>
                <code>pandas DataFrame</code>
          </td>
          <td><p>Predictions generated by bootstrapping.
Shape: (steps, n_boot)</p></td>
        </tr>
    </tbody>
  </table>
      <h5 id="skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom.predict_bootstrapping--notes">Notes<a class="headerlink" href="#skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom.predict_bootstrapping--notes" title="Permanent link">&para;</a></h5>
<p>More information about prediction intervals in forecasting:
<a href="https://otexts.com/fpp3/prediction-intervals.html#prediction-intervals-from-bootstrapped-residuals">https://otexts.com/fpp3/prediction-intervals.html#prediction-intervals-from-bootstrapped-residuals</a>
Forecasting: Principles and Practice (3nd ed) Rob J Hyndman and George Athanasopoulos.</p>

      <details class="quote">
        <summary>Source code in <code>skforecast\ForecasterAutoregCustom\ForecasterAutoregCustom.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">predict_bootstrapping</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">last_window</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">n_boot</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
    <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
    <span class="n">in_sample_residuals</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate multiple forecasting predictions using a bootstrapping process. </span>
<span class="sd">    By sampling from a collection of past observed errors (the residuals),</span>
<span class="sd">    each iteration of bootstrapping generates a different set of predictions. </span>
<span class="sd">    See the Notes section for more information. </span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    steps : int</span>
<span class="sd">        Number of future steps predicted.</span>
<span class="sd">    last_window : pandas Series, default `None`</span>
<span class="sd">        Series values used to create the predictors (lags) needed in the </span>
<span class="sd">        first iteration of the prediction (t + 1).</span>
<span class="sd">        If `last_window = None`, the values stored in `self.last_window` are</span>
<span class="sd">        used to calculate the initial predictors, and the predictions start</span>
<span class="sd">        right after training data.</span>
<span class="sd">    exog : pandas Series, pandas DataFrame, default `None`</span>
<span class="sd">        Exogenous variable/s included as predictor/s.</span>
<span class="sd">    n_boot : int, default `500`</span>
<span class="sd">        Number of bootstrapping iterations used to estimate prediction</span>
<span class="sd">        intervals.</span>
<span class="sd">    random_state : int, default `123`</span>
<span class="sd">        Sets a seed to the random generator, so that boot intervals are always </span>
<span class="sd">        deterministic.</span>
<span class="sd">    in_sample_residuals : bool, default `True`</span>
<span class="sd">        If `True`, residuals from the training data are used as proxy of</span>
<span class="sd">        prediction error to create prediction intervals. If `False`, out of</span>
<span class="sd">        sample residuals are used. In the latter case, the user should have</span>
<span class="sd">        calculated and stored the residuals within the forecaster (see</span>
<span class="sd">        `set_out_sample_residuals()`).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    boot_predictions : pandas DataFrame</span>
<span class="sd">        Predictions generated by bootstrapping.</span>
<span class="sd">        Shape: (steps, n_boot)</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    More information about prediction intervals in forecasting:</span>
<span class="sd">    https://otexts.com/fpp3/prediction-intervals.html#prediction-intervals-from-bootstrapped-residuals</span>
<span class="sd">    Forecasting: Principles and Practice (3nd ed) Rob J Hyndman and George Athanasopoulos.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">in_sample_residuals</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="p">(</span><span class="s1">&#39;`forecaster.out_sample_residuals` is `None`. Use &#39;</span>
             <span class="s1">&#39;`in_sample_residuals=True` or method `set_out_sample_residuals()` &#39;</span>
             <span class="s1">&#39;before `predict_interval()`, `predict_bootstrapping()` or &#39;</span>
             <span class="s1">&#39;`predict_dist()`.&#39;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">last_window</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">last_window</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">last_window</span><span class="p">)</span>

    <span class="n">check_predict_input</span><span class="p">(</span>
        <span class="n">forecaster_name</span>  <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
        <span class="n">steps</span>            <span class="o">=</span> <span class="n">steps</span><span class="p">,</span>
        <span class="n">fitted</span>           <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fitted</span><span class="p">,</span>
        <span class="n">included_exog</span>    <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">included_exog</span><span class="p">,</span>
        <span class="n">index_type</span>       <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_type</span><span class="p">,</span>
        <span class="n">index_freq</span>       <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_freq</span><span class="p">,</span>
        <span class="n">window_size</span>      <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="p">,</span>
        <span class="n">last_window</span>      <span class="o">=</span> <span class="n">last_window</span><span class="p">,</span>
        <span class="n">last_window_exog</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">exog</span>             <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
        <span class="n">exog_type</span>        <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exog_type</span><span class="p">,</span>
        <span class="n">exog_col_names</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exog_col_names</span><span class="p">,</span>
        <span class="n">interval</span>         <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">alpha</span>            <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">max_steps</span>        <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">levels</span>           <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">series_col_names</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
            <span class="n">exog</span> <span class="o">=</span> <span class="n">transform_dataframe</span><span class="p">(</span>
                       <span class="n">df</span>                <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
                       <span class="n">transformer</span>       <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformer_exog</span><span class="p">,</span>
                       <span class="n">fit</span>               <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                       <span class="n">inverse_transform</span> <span class="o">=</span> <span class="kc">False</span>
                   <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">exog</span> <span class="o">=</span> <span class="n">transform_series</span><span class="p">(</span>
                       <span class="n">series</span>            <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
                       <span class="n">transformer</span>       <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformer_exog</span><span class="p">,</span>
                       <span class="n">fit</span>               <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                       <span class="n">inverse_transform</span> <span class="o">=</span> <span class="kc">False</span>
                   <span class="p">)</span>
        <span class="n">exog_values</span> <span class="o">=</span> <span class="n">exog</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()[:</span><span class="n">steps</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">exog_values</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">last_window</span> <span class="o">=</span> <span class="n">transform_series</span><span class="p">(</span>
                      <span class="n">series</span>            <span class="o">=</span> <span class="n">last_window</span><span class="p">,</span>
                      <span class="n">transformer</span>       <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformer_y</span><span class="p">,</span>
                      <span class="n">fit</span>               <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                      <span class="n">inverse_transform</span> <span class="o">=</span> <span class="kc">False</span>
                  <span class="p">)</span>
    <span class="n">last_window_values</span><span class="p">,</span> <span class="n">last_window_index</span> <span class="o">=</span> <span class="n">preprocess_last_window</span><span class="p">(</span>
                                                <span class="n">last_window</span> <span class="o">=</span> <span class="n">last_window</span>
                                            <span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">last_window_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiator</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">last_window_values</span><span class="p">)</span>

    <span class="n">boot_predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span>
                           <span class="n">shape</span>      <span class="o">=</span> <span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="n">n_boot</span><span class="p">),</span>
                           <span class="n">fill_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span>
                           <span class="n">dtype</span>      <span class="o">=</span> <span class="nb">float</span>
                       <span class="p">)</span>
    <span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">random_state</span><span class="p">)</span>
    <span class="n">seeds</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">integers</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n_boot</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">in_sample_residuals</span><span class="p">:</span>
        <span class="n">residuals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">residuals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_boot</span><span class="p">):</span>
        <span class="c1"># In each bootstraping iteration the initial last_window and exog </span>
        <span class="c1"># need to be restored.</span>
        <span class="n">last_window_boot</span> <span class="o">=</span> <span class="n">last_window_values</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">exog_boot</span> <span class="o">=</span> <span class="n">exog_values</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">if</span> <span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>

        <span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">seeds</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">sample_residuals</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
                               <span class="n">a</span>       <span class="o">=</span> <span class="n">residuals</span><span class="p">,</span>
                               <span class="n">size</span>    <span class="o">=</span> <span class="n">steps</span><span class="p">,</span>
                               <span class="n">replace</span> <span class="o">=</span> <span class="kc">True</span>
                           <span class="p">)</span>

        <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>

            <span class="n">prediction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recursive_predict</span><span class="p">(</span>
                             <span class="n">steps</span>       <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                             <span class="n">last_window</span> <span class="o">=</span> <span class="n">last_window_boot</span><span class="p">,</span>
                             <span class="n">exog</span>        <span class="o">=</span> <span class="n">exog_boot</span> 
                         <span class="p">)</span>

            <span class="n">prediction_with_residual</span>  <span class="o">=</span> <span class="n">prediction</span> <span class="o">+</span> <span class="n">sample_residuals</span><span class="p">[</span><span class="n">step</span><span class="p">]</span>
            <span class="n">boot_predictions</span><span class="p">[</span><span class="n">step</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">prediction_with_residual</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="n">last_window_boot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                                   <span class="n">last_window_boot</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span>
                                   <span class="n">prediction_with_residual</span>
                               <span class="p">)</span>

            <span class="k">if</span> <span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">exog_boot</span> <span class="o">=</span> <span class="n">exog_boot</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">boot_predictions</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">differentiator</span><span class="o">.</span><span class="n">inverse_transform_next_window</span><span class="p">(</span><span class="n">boot_predictions</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span>
            <span class="p">)</span>

    <span class="n">boot_predictions</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
                           <span class="n">data</span>    <span class="o">=</span> <span class="n">boot_predictions</span><span class="p">,</span>
                           <span class="n">index</span>   <span class="o">=</span> <span class="n">expand_index</span><span class="p">(</span><span class="n">last_window_index</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">),</span>
                           <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;pred_boot_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_boot</span><span class="p">)]</span>
                       <span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformer_y</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">boot_predictions</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">boot_predictions</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">transform_series</span><span class="p">(</span>
                                        <span class="n">series</span>            <span class="o">=</span> <span class="n">boot_predictions</span><span class="p">[</span><span class="n">col</span><span class="p">],</span>
                                        <span class="n">transformer</span>       <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformer_y</span><span class="p">,</span>
                                        <span class="n">fit</span>               <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                                        <span class="n">inverse_transform</span> <span class="o">=</span> <span class="kc">True</span>
                                    <span class="p">)</span>

    <span class="k">return</span> <span class="n">boot_predictions</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom.predict_interval" class="doc doc-heading">
<code class="highlight language-python"><span class="n">predict_interval</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="n">last_window</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">95</span><span class="p">],</span> <span class="n">n_boot</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span> <span class="n">in_sample_residuals</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom.predict_interval" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Iterative process in which each prediction is used as a predictor
for the next step, and bootstrapping is used to estimate prediction
intervals. Both predictions and intervals are returned.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>steps</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Number of future steps predicted.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>last_window</code></td>
          <td>
                <code>pandas Series</code>
          </td>
          <td><p>Series values used to create the predictors (lags) needed in the 
first iteration of the prediction (t + 1).
If <code>last_window = None</code>, the values stored in<code>self.last_window</code> are
used to calculate the initial predictors, and the predictions start
right after training data.</p></td>
          <td>
                <code>`None`</code>
          </td>
        </tr>
        <tr>
          <td><code>exog</code></td>
          <td>
                <code>pandas Series, pandas DataFrame</code>
          </td>
          <td><p>Exogenous variable/s included as predictor/s.</p></td>
          <td>
                <code>`None`</code>
          </td>
        </tr>
        <tr>
          <td><code>interval</code></td>
          <td>
                <code>list</code>
          </td>
          <td><p>Confidence of the prediction interval estimated. Sequence of 
percentiles to compute, which must be between 0 and 100 inclusive. 
For example, interval of 95% should be as <code>interval = [2.5, 97.5]</code>.</p></td>
          <td>
                <code>`[5, 95]`</code>
          </td>
        </tr>
        <tr>
          <td><code>n_boot</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Number of bootstrapping iterations used to estimate prediction
intervals.</p></td>
          <td>
                <code>`500`</code>
          </td>
        </tr>
        <tr>
          <td><code>random_state</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Sets a seed to the random generator, so that boot intervals are always 
deterministic.</p></td>
          <td>
                <code>`123`</code>
          </td>
        </tr>
        <tr>
          <td><code>in_sample_residuals</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>If <code>True</code>, residuals from the training data are used as proxy of
prediction error to create prediction intervals. If <code>False</code>, out of
sample residuals are used. In the latter case, the user should have
calculated and stored the residuals within the forecaster (see
<code>set_out_sample_residuals()</code>).</p></td>
          <td>
                <code>`True`</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>predictions</code></td>          <td>
                <code>pandas DataFrame</code>
          </td>
          <td><p>Values predicted by the forecaster and their estimated interval.</p>
<ul>
<li>pred: predictions.</li>
<li>lower_bound: lower bound of the interval.</li>
<li>upper_bound: upper bound of the interval.</li>
</ul></td>
        </tr>
    </tbody>
  </table>
      <h5 id="skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom.predict_interval--notes">Notes<a class="headerlink" href="#skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom.predict_interval--notes" title="Permanent link">&para;</a></h5>
<p>More information about prediction intervals in forecasting:
<a href="https://otexts.com/fpp2/prediction-intervals.html">https://otexts.com/fpp2/prediction-intervals.html</a>
Forecasting: Principles and Practice (2nd ed) Rob J Hyndman and
George Athanasopoulos.</p>

      <details class="quote">
        <summary>Source code in <code>skforecast\ForecasterAutoregCustom\ForecasterAutoregCustom.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">predict_interval</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">last_window</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">interval</span><span class="p">:</span> <span class="nb">list</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">95</span><span class="p">],</span>
    <span class="n">n_boot</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
    <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
    <span class="n">in_sample_residuals</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Iterative process in which each prediction is used as a predictor</span>
<span class="sd">    for the next step, and bootstrapping is used to estimate prediction</span>
<span class="sd">    intervals. Both predictions and intervals are returned.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    steps : int</span>
<span class="sd">        Number of future steps predicted.</span>
<span class="sd">    last_window : pandas Series, default `None`</span>
<span class="sd">        Series values used to create the predictors (lags) needed in the </span>
<span class="sd">        first iteration of the prediction (t + 1).</span>
<span class="sd">        If `last_window = None`, the values stored in` self.last_window` are</span>
<span class="sd">        used to calculate the initial predictors, and the predictions start</span>
<span class="sd">        right after training data.</span>
<span class="sd">    exog : pandas Series, pandas DataFrame, default `None`</span>
<span class="sd">        Exogenous variable/s included as predictor/s.</span>
<span class="sd">    interval : list, default `[5, 95]`</span>
<span class="sd">        Confidence of the prediction interval estimated. Sequence of </span>
<span class="sd">        percentiles to compute, which must be between 0 and 100 inclusive. </span>
<span class="sd">        For example, interval of 95% should be as `interval = [2.5, 97.5]`.</span>
<span class="sd">    n_boot : int, default `500`</span>
<span class="sd">        Number of bootstrapping iterations used to estimate prediction</span>
<span class="sd">        intervals.</span>
<span class="sd">    random_state : int, default `123`</span>
<span class="sd">        Sets a seed to the random generator, so that boot intervals are always </span>
<span class="sd">        deterministic.</span>
<span class="sd">    in_sample_residuals : bool, default `True`</span>
<span class="sd">        If `True`, residuals from the training data are used as proxy of</span>
<span class="sd">        prediction error to create prediction intervals. If `False`, out of</span>
<span class="sd">        sample residuals are used. In the latter case, the user should have</span>
<span class="sd">        calculated and stored the residuals within the forecaster (see</span>
<span class="sd">        `set_out_sample_residuals()`).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    predictions : pandas DataFrame</span>
<span class="sd">        Values predicted by the forecaster and their estimated interval.</span>

<span class="sd">            - pred: predictions.</span>
<span class="sd">            - lower_bound: lower bound of the interval.</span>
<span class="sd">            - upper_bound: upper bound of the interval.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    More information about prediction intervals in forecasting:</span>
<span class="sd">    https://otexts.com/fpp2/prediction-intervals.html</span>
<span class="sd">    Forecasting: Principles and Practice (2nd ed) Rob J Hyndman and</span>
<span class="sd">    George Athanasopoulos.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">check_interval</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="n">interval</span><span class="p">)</span>

    <span class="n">predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
                      <span class="n">steps</span>       <span class="o">=</span> <span class="n">steps</span><span class="p">,</span>
                      <span class="n">last_window</span> <span class="o">=</span> <span class="n">last_window</span><span class="p">,</span>
                      <span class="n">exog</span>        <span class="o">=</span> <span class="n">exog</span>
                  <span class="p">)</span>

    <span class="n">boot_predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict_bootstrapping</span><span class="p">(</span>
                           <span class="n">steps</span>               <span class="o">=</span> <span class="n">steps</span><span class="p">,</span>
                           <span class="n">last_window</span>         <span class="o">=</span> <span class="n">last_window</span><span class="p">,</span>
                           <span class="n">exog</span>                <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
                           <span class="n">n_boot</span>              <span class="o">=</span> <span class="n">n_boot</span><span class="p">,</span>
                           <span class="n">random_state</span>        <span class="o">=</span> <span class="n">random_state</span><span class="p">,</span>
                           <span class="n">in_sample_residuals</span> <span class="o">=</span> <span class="n">in_sample_residuals</span>
                       <span class="p">)</span>

    <span class="n">interval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span><span class="o">/</span><span class="mi">100</span>
    <span class="n">predictions_interval</span> <span class="o">=</span> <span class="n">boot_predictions</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="n">interval</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
    <span class="n">predictions_interval</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;lower_bound&#39;</span><span class="p">,</span> <span class="s1">&#39;upper_bound&#39;</span><span class="p">]</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="n">predictions</span><span class="p">,</span> <span class="n">predictions_interval</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">predictions</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom.predict_dist" class="doc doc-heading">
<code class="highlight language-python"><span class="n">predict_dist</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="n">distribution</span><span class="p">,</span> <span class="n">last_window</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_boot</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span> <span class="n">in_sample_residuals</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom.predict_dist" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Fit a given probability distribution for each step. After generating 
multiple forecasting predictions through a bootstrapping process, each 
step is fitted to the given distribution.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>steps</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Number of future steps predicted.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>distribution</code></td>
          <td>
                <code>Object</code>
          </td>
          <td><p>A distribution object from scipy.stats.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>last_window</code></td>
          <td>
                <code>pandas Series</code>
          </td>
          <td><p>Series values used to create the predictors (lags) needed in the 
first iteration of the prediction (t + 1).
If <code>last_window = None</code>, the values stored in<code>self.last_window</code> are
used to calculate the initial predictors, and the predictions start
right after training data.</p></td>
          <td>
                <code>`None`</code>
          </td>
        </tr>
        <tr>
          <td><code>exog</code></td>
          <td>
                <code>pandas Series, pandas DataFrame</code>
          </td>
          <td><p>Exogenous variable/s included as predictor/s.</p></td>
          <td>
                <code>`None`</code>
          </td>
        </tr>
        <tr>
          <td><code>n_boot</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Number of bootstrapping iterations used to estimate prediction
intervals.</p></td>
          <td>
                <code>`500`</code>
          </td>
        </tr>
        <tr>
          <td><code>random_state</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Sets a seed to the random generator, so that boot intervals are always 
deterministic.</p></td>
          <td>
                <code>`123`</code>
          </td>
        </tr>
        <tr>
          <td><code>in_sample_residuals</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>If <code>True</code>, residuals from the training data are used as proxy of
prediction error to create prediction intervals. If <code>False</code>, out of
sample residuals are used. In the latter case, the user should have
calculated and stored the residuals within the forecaster (see
<code>set_out_sample_residuals()</code>).</p></td>
          <td>
                <code>`True`</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>predictions</code></td>          <td>
                <code>pandas DataFrame</code>
          </td>
          <td><p>Distribution parameters estimated for each step.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>skforecast\ForecasterAutoregCustom\ForecasterAutoregCustom.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">predict_dist</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">distribution</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
    <span class="n">last_window</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">n_boot</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
    <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
    <span class="n">in_sample_residuals</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fit a given probability distribution for each step. After generating </span>
<span class="sd">    multiple forecasting predictions through a bootstrapping process, each </span>
<span class="sd">    step is fitted to the given distribution.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    steps : int</span>
<span class="sd">        Number of future steps predicted.</span>
<span class="sd">    distribution : Object</span>
<span class="sd">        A distribution object from scipy.stats.</span>
<span class="sd">    last_window : pandas Series, default `None`</span>
<span class="sd">        Series values used to create the predictors (lags) needed in the </span>
<span class="sd">        first iteration of the prediction (t + 1).</span>
<span class="sd">        If `last_window = None`, the values stored in` self.last_window` are</span>
<span class="sd">        used to calculate the initial predictors, and the predictions start</span>
<span class="sd">        right after training data.</span>
<span class="sd">    exog : pandas Series, pandas DataFrame, default `None`</span>
<span class="sd">        Exogenous variable/s included as predictor/s.</span>
<span class="sd">    n_boot : int, default `500`</span>
<span class="sd">        Number of bootstrapping iterations used to estimate prediction</span>
<span class="sd">        intervals.</span>
<span class="sd">    random_state : int, default `123`</span>
<span class="sd">        Sets a seed to the random generator, so that boot intervals are always </span>
<span class="sd">        deterministic.</span>
<span class="sd">    in_sample_residuals : bool, default `True`</span>
<span class="sd">        If `True`, residuals from the training data are used as proxy of</span>
<span class="sd">        prediction error to create prediction intervals. If `False`, out of</span>
<span class="sd">        sample residuals are used. In the latter case, the user should have</span>
<span class="sd">        calculated and stored the residuals within the forecaster (see</span>
<span class="sd">        `set_out_sample_residuals()`).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    predictions : pandas DataFrame</span>
<span class="sd">        Distribution parameters estimated for each step.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">boot_samples</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict_bootstrapping</span><span class="p">(</span>
                       <span class="n">steps</span>               <span class="o">=</span> <span class="n">steps</span><span class="p">,</span>
                       <span class="n">last_window</span>         <span class="o">=</span> <span class="n">last_window</span><span class="p">,</span>
                       <span class="n">exog</span>                <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
                       <span class="n">n_boot</span>              <span class="o">=</span> <span class="n">n_boot</span><span class="p">,</span>
                       <span class="n">random_state</span>        <span class="o">=</span> <span class="n">random_state</span><span class="p">,</span>
                       <span class="n">in_sample_residuals</span> <span class="o">=</span> <span class="n">in_sample_residuals</span>
                   <span class="p">)</span>

    <span class="n">param_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">distribution</span><span class="o">.</span><span class="n">_pdf</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span>
                   <span class="k">if</span> <span class="ow">not</span> <span class="n">p</span><span class="o">==</span><span class="s1">&#39;x&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;loc&quot;</span><span class="p">,</span><span class="s2">&quot;scale&quot;</span><span class="p">]</span>
    <span class="n">param_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">apply_along_axis</span><span class="p">(</span>
                        <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">distribution</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">),</span>
                        <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                        <span class="n">arr</span>  <span class="o">=</span> <span class="n">boot_samples</span>
                   <span class="p">)</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
                      <span class="n">data</span>    <span class="o">=</span> <span class="n">param_values</span><span class="p">,</span>
                      <span class="n">columns</span> <span class="o">=</span> <span class="n">param_names</span><span class="p">,</span>
                      <span class="n">index</span>   <span class="o">=</span> <span class="n">boot_samples</span><span class="o">.</span><span class="n">index</span>
                  <span class="p">)</span>

    <span class="k">return</span> <span class="n">predictions</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom.set_params" class="doc doc-heading">
<code class="highlight language-python"><span class="n">set_params</span><span class="p">(</span><span class="n">params</span><span class="p">)</span></code>

<a href="#skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom.set_params" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Set new values to the parameters of the scikit learn model stored in the
forecaster.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>params</code></td>
          <td>
                <code>dict</code>
          </td>
          <td><p>Parameters values.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>None</code>
          </td>
          <td></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>skforecast\ForecasterAutoregCustom\ForecasterAutoregCustom.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_params</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> 
    <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set new values to the parameters of the scikit learn model stored in the</span>
<span class="sd">    forecaster.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    params : dict</span>
<span class="sd">        Parameters values.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">regressor</span> <span class="o">=</span> <span class="n">clone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regressor</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">regressor</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom.set_fit_kwargs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">set_fit_kwargs</span><span class="p">(</span><span class="n">fit_kwargs</span><span class="p">)</span></code>

<a href="#skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom.set_fit_kwargs" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Set new values for the additional keyword arguments passed to the <code>fit</code> 
method of the regressor.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>fit_kwargs</code></td>
          <td>
                <code>dict</code>
          </td>
          <td><p>Dict of the form {"argument": new_value}.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>None</code>
          </td>
          <td></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>skforecast\ForecasterAutoregCustom\ForecasterAutoregCustom.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_fit_kwargs</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> 
    <span class="n">fit_kwargs</span><span class="p">:</span> <span class="nb">dict</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set new values for the additional keyword arguments passed to the `fit` </span>
<span class="sd">    method of the regressor.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    fit_kwargs : dict</span>
<span class="sd">        Dict of the form {&quot;argument&quot;: new_value}.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">fit_kwargs</span> <span class="o">=</span> <span class="n">check_select_fit_kwargs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regressor</span><span class="p">,</span> <span class="n">fit_kwargs</span><span class="o">=</span><span class="n">fit_kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom.set_out_sample_residuals" class="doc doc-heading">
<code class="highlight language-python"><span class="n">set_out_sample_residuals</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">append</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span></code>

<a href="#skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom.set_out_sample_residuals" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Set new values to the attribute <code>out_sample_residuals</code>. Out of sample
residuals are meant to be calculated using observations that did not
participate in the training process.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>residuals</code></td>
          <td>
                <code>numpy ndarray</code>
          </td>
          <td><p>Values of residuals. If len(residuals) &gt; 1000, only a random sample
of 1000 values are stored.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>append</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>If <code>True</code>, new residuals are added to the once already stored in the
attribute <code>out_sample_residuals</code>. Once the limit of 1000 values is
reached, no more values are appended. If False, <code>out_sample_residuals</code>
is overwritten with the new residuals.</p></td>
          <td>
                <code>`True`</code>
          </td>
        </tr>
        <tr>
          <td><code>transform</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>If <code>True</code>, new residuals are transformed using self.transformer_y.</p></td>
          <td>
                <code>`True`</code>
          </td>
        </tr>
        <tr>
          <td><code>random_state</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Sets a seed to the random sampling for reproducible output.</p></td>
          <td>
                <code>`123`</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>None</code>
          </td>
          <td></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>skforecast\ForecasterAutoregCustom\ForecasterAutoregCustom.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_out_sample_residuals</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> 
    <span class="n">residuals</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> 
    <span class="n">append</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">transform</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">123</span>
<span class="p">)</span><span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set new values to the attribute `out_sample_residuals`. Out of sample</span>
<span class="sd">    residuals are meant to be calculated using observations that did not</span>
<span class="sd">    participate in the training process.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    residuals : numpy ndarray</span>
<span class="sd">        Values of residuals. If len(residuals) &gt; 1000, only a random sample</span>
<span class="sd">        of 1000 values are stored.</span>
<span class="sd">    append : bool, default `True`</span>
<span class="sd">        If `True`, new residuals are added to the once already stored in the</span>
<span class="sd">        attribute `out_sample_residuals`. Once the limit of 1000 values is</span>
<span class="sd">        reached, no more values are appended. If False, `out_sample_residuals`</span>
<span class="sd">        is overwritten with the new residuals.</span>
<span class="sd">    transform : bool, default `True`</span>
<span class="sd">        If `True`, new residuals are transformed using self.transformer_y.</span>
<span class="sd">    random_state : int, default `123`</span>
<span class="sd">        Sets a seed to the random sampling for reproducible output.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;`residuals` argument must be `numpy ndarray`. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">residuals</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">transform</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformer_y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Argument `transform` is set to `False` but forecaster was trained &quot;</span>
             <span class="sa">f</span><span class="s2">&quot;using a transformer </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">transformer_y</span><span class="si">}</span><span class="s2">. Ensure that the new residuals &quot;</span>
             <span class="sa">f</span><span class="s2">&quot;are already transformed or set `transform=True`.&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">transform</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformer_y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Residuals will be transformed using the same transformer used &quot;</span>
             <span class="sa">f</span><span class="s2">&quot;when training the forecaster (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">transformer_y</span><span class="si">}</span><span class="s2">). Ensure that the &quot;</span>
             <span class="sa">f</span><span class="s2">&quot;new residuals are on the same scale as the original time series.&quot;</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="n">residuals</span> <span class="o">=</span> <span class="n">transform_series</span><span class="p">(</span>
                        <span class="n">series</span>            <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;residuals&#39;</span><span class="p">),</span>
                        <span class="n">transformer</span>       <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformer_y</span><span class="p">,</span>
                        <span class="n">fit</span>               <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                        <span class="n">inverse_transform</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="p">)</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">residuals</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1000</span><span class="p">:</span>
        <span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">random_state</span><span class="p">)</span>
        <span class="n">residuals</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">residuals</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">append</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">free_space</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">residuals</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">free_space</span><span class="p">:</span>
            <span class="n">residuals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals</span><span class="p">,</span>
                            <span class="n">residuals</span>
                        <span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">residuals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals</span><span class="p">,</span>
                            <span class="n">residuals</span><span class="p">[:</span><span class="n">free_space</span><span class="p">]</span>
                        <span class="p">))</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals</span> <span class="o">=</span> <span class="n">residuals</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom.get_feature_importances" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_feature_importances</span><span class="p">()</span></code>

<a href="#skforecast.ForecasterAutoregCustom.ForecasterAutoregCustom.ForecasterAutoregCustom.get_feature_importances" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Return feature importances of the regressor stored in the forecaster.
Only valid when regressor stores internally the feature importances in the
attribute <code>feature_importances_</code> or <code>coef_</code>. Otherwise, returns <code>None</code>.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>self</code></td>
          <td>
          </td>
          <td></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>feature_importances</code></td>          <td>
                <code>pandas DataFrame</code>
          </td>
          <td><p>Feature importances associated with each predictor.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>skforecast\ForecasterAutoregCustom\ForecasterAutoregCustom.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_feature_importances</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return feature importances of the regressor stored in the forecaster.</span>
<span class="sd">    Only valid when regressor stores internally the feature importances in the</span>
<span class="sd">    attribute `feature_importances_` or `coef_`. Otherwise, returns `None`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    self</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    feature_importances : pandas DataFrame</span>
<span class="sd">        Feature importances associated with each predictor.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">fitted</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">NotFittedError</span><span class="p">(</span>
            <span class="p">(</span><span class="s2">&quot;This forecaster is not fitted yet. Call `fit` with appropriate &quot;</span>
             <span class="s2">&quot;arguments before using `get_feature_importances()`.&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regressor</span><span class="p">,</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">pipeline</span><span class="o">.</span><span class="n">Pipeline</span><span class="p">):</span>
        <span class="n">estimator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">regressor</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">estimator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">regressor</span>

    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span> <span class="s1">&#39;feature_importances_&#39;</span><span class="p">):</span>
        <span class="n">feature_importances</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">feature_importances_</span>
    <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span> <span class="s1">&#39;coef_&#39;</span><span class="p">):</span>
        <span class="n">feature_importances</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">coef_</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Impossible to access feature importances for regressor of type &quot;</span>
             <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">estimator</span><span class="p">)</span><span class="si">}</span><span class="s2">. This method is only valid when the &quot;</span>
             <span class="sa">f</span><span class="s2">&quot;regressor stores internally the feature importances in the &quot;</span>
             <span class="sa">f</span><span class="s2">&quot;attribute `feature_importances_` or `coef_`.&quot;</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">feature_importances</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">feature_importances</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">feature_importances</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
                                  <span class="s1">&#39;feature&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_train_col_names</span><span class="p">,</span>
                                  <span class="s1">&#39;importance&#39;</span><span class="p">:</span> <span class="n">feature_importances</span>
                              <span class="p">})</span>

    <span class="k">return</span> <span class="n">feature_importances</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>


  




                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2021 - 2023 Joaqun Amat Rodrigo, Javier Escobar Ortiz
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            

  
    
  


  
    
  



  


<h4>Cookie consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
      
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="analytics" checked>
          <span class="task-list-indicator"></span>
          Google Analytics
        </label>
      </li>
    
      
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="github" checked>
          <span class="task-list-indicator"></span>
          GitHub
        </label>
      </li>
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout(function(){document.querySelector("[data-md-component=consent]").hidden=!1},250);var action,form=document.forms.consent;for(action of["submit","reset"])form.addEventListener(action,function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map(function(e){return[e,!0]}))),location.hash="",location.reload()})</script>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.top"], "search": "../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.b4d07000.min.js"></script>
      
    
  </body>
</html>