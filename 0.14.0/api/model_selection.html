
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Python library for time series forecasting using machine learning models. It works with any regressor compatible with the scikit-learn API, including popular options like LightGBM, XGBoost, CatBoost, Keras, and many others.">
      
      
        <meta name="author" content="Joaquin Amat Rodrigo and Javier Escobar Ortiz">
      
      
        <link rel="canonical" href="https://skforecast.org/0.14.0/api/model_selection.html">
      
      
        <link rel="prev" href="ForecasterEquivalentDate.html">
      
      
        <link rel="next" href="preprocessing.html">
      
      
      <link rel="icon" href="../img/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.39">
    
    
      
        <title>model_selection - Skforecast Docs</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.8c3ca2c6.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,700,700i%7CUbuntu+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Open Sans";--md-code-font:"Ubuntu Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-GR8X9Z9LKL"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-GR8X9Z9LKL",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-GR8X9Z9LKL",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>if("undefined"!=typeof __md_analytics){var consent=__md_get("__consent");consent&&consent.analytics&&__md_analytics()}</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="light" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#model_selection" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
This is documentation for an unstable development version.
  <a href="../..">
    <strong>Switch to latest stable version.</strong>
  </a>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),outdated=__md_get("__outdated",sessionStorage);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Skforecast Docs" class="md-header__button md-logo" aria-label="Skforecast Docs" data-md-component="logo">
      
  <img src="../img/logo-skforecast.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Skforecast Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              model_selection
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="light" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/skforecast/skforecast" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../index.html" class="md-tabs__link">
          
  
  Home

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../introduction-forecasting/introduction-forecasting.html" class="md-tabs__link">
        
  
    
  
  Intro to Forecasting

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../quick-start/quick-start-skforecast.html" class="md-tabs__link">
          
  
  Quick start

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../user_guides/table-of-contents.html" class="md-tabs__link">
          
  
  User Guides

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../examples/examples_english.html" class="md-tabs__link">
          
  
  Examples and tutorials

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="ForecasterRecursive.html" class="md-tabs__link">
          
  
  API Reference

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../faq/faq.html" class="md-tabs__link">
          
  
  FAQ and Tips

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../releases/releases.html" class="md-tabs__link">
        
  
    
  
  Releases

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../authors/authors.html" class="md-tabs__link">
        
  
    
  
  Authors

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Skforecast Docs" class="md-nav__button md-logo" aria-label="Skforecast Docs" data-md-component="logo">
      
  <img src="../img/logo-skforecast.png" alt="logo">

    </a>
    Skforecast Docs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/skforecast/skforecast" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Home
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Home
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome to skforecast
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../introduction-forecasting/introduction-forecasting.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intro to Forecasting
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Quick start
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Quick start
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../quick-start/quick-start-skforecast.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quick start
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../quick-start/forecaster-parameters.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Forecaster Parameters
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../quick-start/forecaster-attributes.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Forecaster Attributes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../quick-start/how-to-install.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to install
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    User Guides
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            User Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/table-of-contents.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Table of contents
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/migration-guide.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Skforecast 0.14 Migration guide
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/input-data.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Input data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Single series Forecasters
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            Single series Forecasters
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/autoregresive-forecaster.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Recursive multi-step forecasting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/direct-multi-step-forecasting.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Direct multi-step forecasting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/forecasting-sarimax-arima.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ARIMA and SARIMAX forecasting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/forecasting-baseline.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Foreasting baseline
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_5" >
        
          
          <label class="md-nav__link" for="__nav_4_5" id="__nav_4_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Global Forecasters (multiple series)
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_5">
            <span class="md-nav__icon md-icon"></span>
            Global Forecasters (multiple series)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/independent-multi-time-series-forecasting.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Independent multi-time series forecasting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/multi-series-with-different-length-and-different_exog.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Series with different lengths and different exogenous variables
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/dependent-multi-series-multivariate-forecasting.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dependent multivariate series forecasting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/forecasting-with-deep-learning-rnn-lstm.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deep learning Recurrent Neural Networks
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_6" >
        
          
          <label class="md-nav__link" for="__nav_4_6" id="__nav_4_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Feature Engineering
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_6">
            <span class="md-nav__icon md-icon"></span>
            Feature Engineering
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/exogenous-variables.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Exogenous variables
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/window-features-and-custom-features.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Window and custom features
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/categorical-features.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Categorical features
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/calendar-features.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Calendars features
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/sklearn-transformers-and-pipeline.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data transformation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/time-series-differentiation.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Differentiation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/feature-selection.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Feature selection
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_7" >
        
          
          <label class="md-nav__link" for="__nav_4_7" id="__nav_4_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Model Evaluation and Tuning
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_7">
            <span class="md-nav__icon md-icon"></span>
            Model Evaluation and Tuning
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/metrics.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Metrics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/backtesting.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Backtesting forecaster
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/hyperparameter-tuning-and-lags-selection.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hyperparameter tuning and lags selection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/feature-selection.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Feature selection
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_8" >
        
          
          <label class="md-nav__link" for="__nav_4_8" id="__nav_4_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Probabilistic Forecasting
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_8">
            <span class="md-nav__icon md-icon"></span>
            Probabilistic Forecasting
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/probabilistic-forecasting.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Probabilistic forecasting
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_9" >
        
          
          <label class="md-nav__link" for="__nav_4_9" id="__nav_4_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Model Explainability
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_9">
            <span class="md-nav__icon md-icon"></span>
            Model Explainability
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/explainability.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Explainability
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_10" >
        
          
          <label class="md-nav__link" for="__nav_4_10" id="__nav_4_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Model deployment
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_10">
            <span class="md-nav__icon md-icon"></span>
            Model deployment
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/save-load-forecaster.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Save and load forecaster
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/forecaster-in-production.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Forecaster in production
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_11" >
        
          
          <label class="md-nav__link" for="__nav_4_11" id="__nav_4_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Plotting
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_11">
            <span class="md-nav__icon md-icon"></span>
            Plotting
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/plotting.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Plotting
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_12" >
        
          
          <label class="md-nav__link" for="__nav_4_12" id="__nav_4_12_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Datasets
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_12">
            <span class="md-nav__icon md-icon"></span>
            Datasets
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/datasets.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Datasets
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_13" >
        
          
          <label class="md-nav__link" for="__nav_4_13" id="__nav_4_13_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Additional Resources
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_13">
            <span class="md-nav__icon md-icon"></span>
            Additional Resources
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/weighted-time-series-forecasting.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Weighted time series forecasting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/stacking-ensemble-models-forecasting.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Stacking multiple models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/forecasting-xgboost-lightgbm.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Forecasting with XGBoost and LightGBM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/skforecast-in-GPU.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Skforecast in GPU
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_14" >
        
          
          <label class="md-nav__link" for="__nav_4_14" id="__nav_4_14_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    FAQ and forecasting tips
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_14">
            <span class="md-nav__icon md-icon"></span>
            FAQ and forecasting tips
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/forecasting-time-series-with-missing-values.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Time series with missing values
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/non-negative-predictions.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Non negative predictions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/forecasting-with-delayed-historical-data.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Forecasting with delayed data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/parallelization-skforecast.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parallelization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/time-series-aggregation.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Time series aggregation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/profiling-skforecast.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Profiling skforecast
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/parameters-search-backetesting-vs-one-step-ahead.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Backtesting vs One-step-ahead
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Examples and tutorials
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Examples and tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/examples_english.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    English
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/examples_spanish.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spanish
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterRecursive.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ForecasterRecursive
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterDirect.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ForecasterDirect
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterRecursiveMultiSeries.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ForecasterRecursiveMultiSeries
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterDirectMultiVariate.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ForecasterDirectMultiVariate
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterRnn.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ForecasterRnn
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Sarimax.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sarimax
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterSarimax.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ForecasterSarimax
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterEquivalentDate.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ForecasterEquivalentDate
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    model_selection
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="model_selection.html" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    model_selection
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection._validation.backtesting_forecaster" class="md-nav__link">
    <span class="md-ellipsis">
      backtesting_forecaster
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection._search.grid_search_forecaster" class="md-nav__link">
    <span class="md-ellipsis">
      grid_search_forecaster
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection._search.random_search_forecaster" class="md-nav__link">
    <span class="md-ellipsis">
      random_search_forecaster
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection._search.bayesian_search_forecaster" class="md-nav__link">
    <span class="md-ellipsis">
      bayesian_search_forecaster
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection._validation.backtesting_forecaster_multiseries" class="md-nav__link">
    <span class="md-ellipsis">
      backtesting_forecaster_multiseries
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection._search.grid_search_forecaster_multiseries" class="md-nav__link">
    <span class="md-ellipsis">
      grid_search_forecaster_multiseries
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection._search.random_search_forecaster_multiseries" class="md-nav__link">
    <span class="md-ellipsis">
      random_search_forecaster_multiseries
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection._search.bayesian_search_forecaster_multiseries" class="md-nav__link">
    <span class="md-ellipsis">
      bayesian_search_forecaster_multiseries
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection._validation.backtesting_sarimax" class="md-nav__link">
    <span class="md-ellipsis">
      backtesting_sarimax
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection._search.grid_search_sarimax" class="md-nav__link">
    <span class="md-ellipsis">
      grid_search_sarimax
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection._search.random_search_sarimax" class="md-nav__link">
    <span class="md-ellipsis">
      random_search_sarimax
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection._split.BaseFold" class="md-nav__link">
    <span class="md-ellipsis">
      BaseFold
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BaseFold">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.model_selection._split.BaseFold._validate_params" class="md-nav__link">
    <span class="md-ellipsis">
      _validate_params
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.model_selection._split.BaseFold._extract_index" class="md-nav__link">
    <span class="md-ellipsis">
      _extract_index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.model_selection._split.BaseFold.set_params" class="md-nav__link">
    <span class="md-ellipsis">
      set_params
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection._split.TimeSeriesFold" class="md-nav__link">
    <span class="md-ellipsis">
      TimeSeriesFold
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TimeSeriesFold">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.model_selection._split.TimeSeriesFold.split" class="md-nav__link">
    <span class="md-ellipsis">
      split
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.model_selection._split.TimeSeriesFold._print_info" class="md-nav__link">
    <span class="md-ellipsis">
      _print_info
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection._split.OneStepAheadFold" class="md-nav__link">
    <span class="md-ellipsis">
      OneStepAheadFold
    </span>
  </a>
  
    <nav class="md-nav" aria-label="OneStepAheadFold">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.model_selection._split.OneStepAheadFold.split" class="md-nav__link">
    <span class="md-ellipsis">
      split
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.model_selection._split.OneStepAheadFold._print_info" class="md-nav__link">
    <span class="md-ellipsis">
      _print_info
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection._utils.initialize_lags_grid" class="md-nav__link">
    <span class="md-ellipsis">
      initialize_lags_grid
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection._utils.check_backtesting_input" class="md-nav__link">
    <span class="md-ellipsis">
      check_backtesting_input
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection._utils.select_n_jobs_backtesting" class="md-nav__link">
    <span class="md-ellipsis">
      select_n_jobs_backtesting
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="preprocessing.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    preprocessing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="metrics.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    metrics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="plot.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    plot
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="utils.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="datasets.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    datasets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="exceptions.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    exceptions
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    FAQ and Tips
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            FAQ and Tips
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/faq.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Table of contents
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/non-negative-predictions.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Non negative predictions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/forecasting-time-series-with-missing-values.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Time series with missing values
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/cyclical-features-time-series.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cyclical features in time series
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/forecasting-with-delayed-historical-data.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Forecasting with delayed data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/time-series-aggregation.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Time series aggregation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/parallelization-skforecast.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parallelization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/profiling-skforecast.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Profiling skforecast
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../releases/releases.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Releases
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../authors/authors.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Authors
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="model_selection"><code>model_selection</code><a class="headerlink" href="#model_selection" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-function">


<h2 id="skforecast.model_selection._validation.backtesting_forecaster" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">skforecast</span><span class="o">.</span><span class="n">model_selection</span><span class="o">.</span><span class="n">_validation</span><span class="o">.</span><span class="n">backtesting_forecaster</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="p">,</span> <span class="n">metric</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_boot</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span> <span class="n">use_in_sample_residuals</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_binned_residuals</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#skforecast.model_selection._validation.backtesting_forecaster" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">

        <p>Backtesting of forecaster model following the folds generated by the TimeSeriesFold
class and using the metric(s) provided.</p>
<p>If <code>forecaster</code> is already trained and <code>initial_train_size</code> is set to <code>None</code> in the
TimeSeriesFold class, no initial train will be done and all data will be used
to evaluate the model. However, the first <code>len(forecaster.last_window)</code> observations
are needed to create the initial predictors, so no predictions are calculated for
them.</p>
<p>A copy of the original forecaster is created so that it is not modified during 
the process.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>forecaster</code></td>
            <td>
                  <code>(ForecasterRecursive, ForecasterDirect)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Forecaster model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>y</code></td>
            <td>
                  <code>pandas Series</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training time series.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>cv</code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="skforecast.model_selection._split.TimeSeriesFold" href="#skforecast.model_selection._split.TimeSeriesFold">TimeSeriesFold</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>TimeSeriesFold object with the information needed to split the data into folds.
<strong>New in version 0.14.0</strong></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>metric</code></td>
            <td>
                  <code>(str, <span title="typing.Callable">Callable</span>, list)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Metric used to quantify the goodness of fit of the model.</p>
<ul>
<li>If <code>string</code>: {'mean_squared_error', 'mean_absolute_error',
'mean_absolute_percentage_error', 'mean_squared_log_error',
'mean_absolute_scaled_error', 'root_mean_squared_scaled_error'}</li>
<li>If <code>Callable</code>: Function with arguments <code>y_true</code>, <code>y_pred</code> and <code>y_train</code>
(Optional) that returns a float.</li>
<li>If <code>list</code>: List containing multiple strings and/or Callables.</li>
</ul>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>exog</code></td>
            <td>
                  <code>pandas Series, pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variable/s included as predictor/s. Must have the same
number of observations as <code>y</code> and should be aligned so that y[i] is
regressed on exog[i].</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>interval</code></td>
            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Confidence of the prediction interval estimated. Sequence of percentiles
to compute, which must be between 0 and 100 inclusive. For example, 
interval of 95% should be as <code>interval = [2.5, 97.5]</code>. If <code>None</code>, no
intervals are estimated.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>n_boot</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of bootstrapping iterations used to estimate prediction
intervals.</p>
              </div>
            </td>
            <td>
                  <code>`250`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>random_state</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sets a seed to the random generator, so that boot intervals are always 
deterministic.</p>
              </div>
            </td>
            <td>
                  <code>`123`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>use_in_sample_residuals</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, residuals from the training data are used as proxy of prediction 
error to create prediction intervals. If <code>False</code>, out_sample_residuals 
are used if they are already stored inside the forecaster.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>use_binned_residuals</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, residuals used in each bootstrapping iteration are selected
conditioning on the predicted values. If <code>False</code>, residuals are selected
randomly without conditioning on the predicted values.</p>
              </div>
            </td>
            <td>
                  <code>`False`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>n_jobs</code></td>
            <td>
                  <code>(int, auto)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of jobs to run in parallel. If <code>-1</code>, then the number of jobs is 
set to the number of cores. If 'auto', <code>n_jobs</code> is set using the function
skforecast.utils.select_n_jobs_backtesting.</p>
              </div>
            </td>
            <td>
                  <code>`&#39;auto&#39;`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>verbose</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Print number of folds and index of training and validation sets used 
for backtesting.</p>
              </div>
            </td>
            <td>
                  <code>`False`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>show_progress</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to show a progress bar.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>metric_values</code></td>            <td>
                  <code>pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Value(s) of the metric(s).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>backtest_predictions</code></td>            <td>
                  <code>pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Value of predictions and their estimated interval if <code>interval</code> is not <code>None</code>.</p>
<ul>
<li>column pred: predictions.</li>
<li>column lower_bound: lower bound of the interval.</li>
<li>column upper_bound: upper bound of the interval.</li>
</ul>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>skforecast\model_selection\_validation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">backtesting_forecaster</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
    <span class="n">cv</span><span class="p">:</span> <span class="n">TimeSeriesFold</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="nb">list</span><span class="p">],</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">interval</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">n_boot</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span>
    <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
    <span class="n">use_in_sample_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">use_binned_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Backtesting of forecaster model following the folds generated by the TimeSeriesFold</span>
<span class="sd">    class and using the metric(s) provided.</span>

<span class="sd">    If `forecaster` is already trained and `initial_train_size` is set to `None` in the</span>
<span class="sd">    TimeSeriesFold class, no initial train will be done and all data will be used</span>
<span class="sd">    to evaluate the model. However, the first `len(forecaster.last_window)` observations</span>
<span class="sd">    are needed to create the initial predictors, so no predictions are calculated for</span>
<span class="sd">    them.</span>

<span class="sd">    A copy of the original forecaster is created so that it is not modified during </span>
<span class="sd">    the process.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    forecaster : ForecasterRecursive, ForecasterDirect</span>
<span class="sd">        Forecaster model.</span>
<span class="sd">    y : pandas Series</span>
<span class="sd">        Training time series.</span>
<span class="sd">    cv : TimeSeriesFold</span>
<span class="sd">        TimeSeriesFold object with the information needed to split the data into folds.</span>
<span class="sd">        **New in version 0.14.0**</span>
<span class="sd">    metric : str, Callable, list</span>
<span class="sd">        Metric used to quantify the goodness of fit of the model.</span>

<span class="sd">        - If `string`: {&#39;mean_squared_error&#39;, &#39;mean_absolute_error&#39;,</span>
<span class="sd">        &#39;mean_absolute_percentage_error&#39;, &#39;mean_squared_log_error&#39;,</span>
<span class="sd">        &#39;mean_absolute_scaled_error&#39;, &#39;root_mean_squared_scaled_error&#39;}</span>
<span class="sd">        - If `Callable`: Function with arguments `y_true`, `y_pred` and `y_train`</span>
<span class="sd">        (Optional) that returns a float.</span>
<span class="sd">        - If `list`: List containing multiple strings and/or Callables.</span>
<span class="sd">    exog : pandas Series, pandas DataFrame, default `None`</span>
<span class="sd">        Exogenous variable/s included as predictor/s. Must have the same</span>
<span class="sd">        number of observations as `y` and should be aligned so that y[i] is</span>
<span class="sd">        regressed on exog[i].</span>
<span class="sd">    interval : list, default `None`</span>
<span class="sd">        Confidence of the prediction interval estimated. Sequence of percentiles</span>
<span class="sd">        to compute, which must be between 0 and 100 inclusive. For example, </span>
<span class="sd">        interval of 95% should be as `interval = [2.5, 97.5]`. If `None`, no</span>
<span class="sd">        intervals are estimated.</span>
<span class="sd">    n_boot : int, default `250`</span>
<span class="sd">        Number of bootstrapping iterations used to estimate prediction</span>
<span class="sd">        intervals.</span>
<span class="sd">    random_state : int, default `123`</span>
<span class="sd">        Sets a seed to the random generator, so that boot intervals are always </span>
<span class="sd">        deterministic.</span>
<span class="sd">    use_in_sample_residuals : bool, default `True`</span>
<span class="sd">        If `True`, residuals from the training data are used as proxy of prediction </span>
<span class="sd">        error to create prediction intervals. If `False`, out_sample_residuals </span>
<span class="sd">        are used if they are already stored inside the forecaster.</span>
<span class="sd">    use_binned_residuals : bool, default `False`</span>
<span class="sd">        If `True`, residuals used in each bootstrapping iteration are selected</span>
<span class="sd">        conditioning on the predicted values. If `False`, residuals are selected</span>
<span class="sd">        randomly without conditioning on the predicted values.</span>
<span class="sd">    n_jobs : int, &#39;auto&#39;, default `&#39;auto&#39;`</span>
<span class="sd">        The number of jobs to run in parallel. If `-1`, then the number of jobs is </span>
<span class="sd">        set to the number of cores. If &#39;auto&#39;, `n_jobs` is set using the function</span>
<span class="sd">        skforecast.utils.select_n_jobs_backtesting.</span>
<span class="sd">    verbose : bool, default `False`</span>
<span class="sd">        Print number of folds and index of training and validation sets used </span>
<span class="sd">        for backtesting.</span>
<span class="sd">    show_progress : bool, default `True`</span>
<span class="sd">        Whether to show a progress bar.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    metric_values : pandas DataFrame</span>
<span class="sd">        Value(s) of the metric(s).</span>
<span class="sd">    backtest_predictions : pandas DataFrame</span>
<span class="sd">        Value of predictions and their estimated interval if `interval` is not `None`.</span>

<span class="sd">        - column pred: predictions.</span>
<span class="sd">        - column lower_bound: lower bound of the interval.</span>
<span class="sd">        - column upper_bound: upper bound of the interval.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">forecaters_allowed</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;ForecasterRecursive&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;ForecasterDirect&#39;</span><span class="p">,</span>
        <span class="s1">&#39;ForecasterEquivalentDate&#39;</span>
    <span class="p">]</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">forecaster</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">forecaters_allowed</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`forecaster` must be of type </span><span class="si">{</span><span class="n">forecaters_allowed</span><span class="si">}</span><span class="s2">, for all other types of &quot;</span>
             <span class="sa">f</span><span class="s2">&quot; forecasters use the functions available in the other `model_selection` &quot;</span>
             <span class="sa">f</span><span class="s2">&quot;modules.&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="n">check_backtesting_input</span><span class="p">(</span>
        <span class="n">forecaster</span>              <span class="o">=</span> <span class="n">forecaster</span><span class="p">,</span>
        <span class="n">cv</span>                      <span class="o">=</span> <span class="n">cv</span><span class="p">,</span>
        <span class="n">y</span>                       <span class="o">=</span> <span class="n">y</span><span class="p">,</span>
        <span class="n">metric</span>                  <span class="o">=</span> <span class="n">metric</span><span class="p">,</span>
        <span class="n">interval</span>                <span class="o">=</span> <span class="n">interval</span><span class="p">,</span>
        <span class="n">n_boot</span>                  <span class="o">=</span> <span class="n">n_boot</span><span class="p">,</span>
        <span class="n">random_state</span>            <span class="o">=</span> <span class="n">random_state</span><span class="p">,</span>
        <span class="n">use_in_sample_residuals</span> <span class="o">=</span> <span class="n">use_in_sample_residuals</span><span class="p">,</span>
        <span class="n">use_binned_residuals</span>    <span class="o">=</span> <span class="n">use_binned_residuals</span><span class="p">,</span>
        <span class="n">n_jobs</span>                  <span class="o">=</span> <span class="n">n_jobs</span><span class="p">,</span>
        <span class="n">show_progress</span>           <span class="o">=</span> <span class="n">show_progress</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">forecaster</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;ForecasterDirect&#39;</span> <span class="ow">and</span> \
       <span class="n">forecaster</span><span class="o">.</span><span class="n">steps</span> <span class="o">&lt;</span> <span class="n">cv</span><span class="o">.</span><span class="n">steps</span> <span class="o">+</span> <span class="n">cv</span><span class="o">.</span><span class="n">gap</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;When using a ForecasterDirect, the combination of steps &quot;</span>
             <span class="sa">f</span><span class="s2">&quot;+ gap (</span><span class="si">{</span><span class="n">cv</span><span class="o">.</span><span class="n">steps</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">cv</span><span class="o">.</span><span class="n">gap</span><span class="si">}</span><span class="s2">) cannot be greater than the `steps` parameter &quot;</span>
             <span class="sa">f</span><span class="s2">&quot;declared when the forecaster is initialized (</span><span class="si">{</span><span class="n">forecaster</span><span class="o">.</span><span class="n">steps</span><span class="si">}</span><span class="s2">).&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="n">metric_values</span><span class="p">,</span> <span class="n">backtest_predictions</span> <span class="o">=</span> <span class="n">_backtesting_forecaster</span><span class="p">(</span>
        <span class="n">forecaster</span>              <span class="o">=</span> <span class="n">forecaster</span><span class="p">,</span>
        <span class="n">y</span>                       <span class="o">=</span> <span class="n">y</span><span class="p">,</span>
        <span class="n">cv</span>                      <span class="o">=</span> <span class="n">cv</span><span class="p">,</span>
        <span class="n">metric</span>                  <span class="o">=</span> <span class="n">metric</span><span class="p">,</span>
        <span class="n">exog</span>                    <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
        <span class="n">interval</span>                <span class="o">=</span> <span class="n">interval</span><span class="p">,</span>
        <span class="n">n_boot</span>                  <span class="o">=</span> <span class="n">n_boot</span><span class="p">,</span>
        <span class="n">random_state</span>            <span class="o">=</span> <span class="n">random_state</span><span class="p">,</span>
        <span class="n">use_in_sample_residuals</span> <span class="o">=</span> <span class="n">use_in_sample_residuals</span><span class="p">,</span>
        <span class="n">use_binned_residuals</span>    <span class="o">=</span> <span class="n">use_binned_residuals</span><span class="p">,</span>
        <span class="n">n_jobs</span>                  <span class="o">=</span> <span class="n">n_jobs</span><span class="p">,</span>
        <span class="n">verbose</span>                 <span class="o">=</span> <span class="n">verbose</span><span class="p">,</span>
        <span class="n">show_progress</span>           <span class="o">=</span> <span class="n">show_progress</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">metric_values</span><span class="p">,</span> <span class="n">backtest_predictions</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="skforecast.model_selection._search.grid_search_forecaster" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">skforecast</span><span class="o">.</span><span class="n">model_selection</span><span class="o">.</span><span class="n">_search</span><span class="o">.</span><span class="n">grid_search_forecaster</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="p">,</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">metric</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lags_grid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_best</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">output_file</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#skforecast.model_selection._search.grid_search_forecaster" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">

        <p>Exhaustive search over specified parameter values for a Forecaster object.
Validation is done using time series backtesting.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>forecaster</code></td>
            <td>
                  <code>(ForecasterRecursive, ForecasterDirect)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Forecaster model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>y</code></td>
            <td>
                  <code>pandas Series</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training time series.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>cv</code></td>
            <td>
                  <code>(<a class="autorefs autorefs-internal" title="skforecast.model_selection._split.TimeSeriesFold" href="#skforecast.model_selection._split.TimeSeriesFold">TimeSeriesFold</a>, <a class="autorefs autorefs-internal" title="skforecast.model_selection._split.OneStepAheadFold" href="#skforecast.model_selection._split.OneStepAheadFold">OneStepAheadFold</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>TimeSeriesFold or OneStepAheadFold object with the information needed to split
the data into folds.
<strong>New in version 0.14.0</strong></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>param_grid</code></td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary with parameters names (<code>str</code>) as keys and lists of parameter
settings to try as values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>metric</code></td>
            <td>
                  <code>(str, <span title="typing.Callable">Callable</span>, list)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Metric used to quantify the goodness of fit of the model.</p>
<ul>
<li>If <code>string</code>: {'mean_squared_error', 'mean_absolute_error',
'mean_absolute_percentage_error', 'mean_squared_log_error',
'mean_absolute_scaled_error', 'root_mean_squared_scaled_error'}</li>
<li>If <code>Callable</code>: Function with arguments <code>y_true</code>, <code>y_pred</code> and <code>y_train</code>
(Optional) that returns a float.</li>
<li>If <code>list</code>: List containing multiple strings and/or Callables.</li>
</ul>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>exog</code></td>
            <td>
                  <code>pandas Series, pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variable/s included as predictor/s. Must have the same
number of observations as <code>y</code> and should be aligned so that y[i] is
regressed on exog[i].</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>lags_grid</code></td>
            <td>
                  <code>(list, dict)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Lists of lags to try, containing int, lists, numpy ndarray, or range 
objects. If <code>dict</code>, the keys are used as labels in the <code>results</code> 
DataFrame, and the values are used as the lists of lags to try.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>return_best</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Refit the <code>forecaster</code> using the best found parameters on the whole data.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>n_jobs</code></td>
            <td>
                  <code>(int, auto)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of jobs to run in parallel. If <code>-1</code>, then the number of jobs is 
set to the number of cores. If 'auto', <code>n_jobs</code> is set using the function
skforecast.utils.select_n_jobs_backtesting.</p>
              </div>
            </td>
            <td>
                  <code>`&#39;auto&#39;`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>verbose</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Print number of folds used for cv or backtesting.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>show_progress</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to show a progress bar.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>output_file</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specifies the filename or full path where the results should be saved. 
The results will be saved in a tab-separated values (TSV) format. If 
<code>None</code>, the results will not be saved to a file.
<strong>New in version 0.12.0</strong></p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>results</code></td>            <td>
                  <code>pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Results for each combination of parameters.</p>
<ul>
<li>column lags: lags configuration for each iteration.</li>
<li>column lags_label: descriptive label or alias for the lags.</li>
<li>column params: parameters configuration for each iteration.</li>
<li>column metric: metric value estimated for each iteration.</li>
<li>additional n columns with param = value.</li>
</ul>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>skforecast\model_selection\_search.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">grid_search_forecaster</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
    <span class="n">cv</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">TimeSeriesFold</span><span class="p">,</span> <span class="n">OneStepAheadFold</span><span class="p">],</span>
    <span class="n">param_grid</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="nb">list</span><span class="p">],</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">lags_grid</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">return_best</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">output_file</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Exhaustive search over specified parameter values for a Forecaster object.</span>
<span class="sd">    Validation is done using time series backtesting.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    forecaster : ForecasterRecursive, ForecasterDirect</span>
<span class="sd">        Forecaster model.</span>
<span class="sd">    y : pandas Series</span>
<span class="sd">        Training time series.</span>
<span class="sd">    cv : TimeSeriesFold, OneStepAheadFold</span>
<span class="sd">        TimeSeriesFold or OneStepAheadFold object with the information needed to split</span>
<span class="sd">        the data into folds.</span>
<span class="sd">        **New in version 0.14.0**</span>
<span class="sd">    param_grid : dict</span>
<span class="sd">        Dictionary with parameters names (`str`) as keys and lists of parameter</span>
<span class="sd">        settings to try as values.</span>
<span class="sd">    metric : str, Callable, list</span>
<span class="sd">        Metric used to quantify the goodness of fit of the model.</span>

<span class="sd">        - If `string`: {&#39;mean_squared_error&#39;, &#39;mean_absolute_error&#39;,</span>
<span class="sd">        &#39;mean_absolute_percentage_error&#39;, &#39;mean_squared_log_error&#39;,</span>
<span class="sd">        &#39;mean_absolute_scaled_error&#39;, &#39;root_mean_squared_scaled_error&#39;}</span>
<span class="sd">        - If `Callable`: Function with arguments `y_true`, `y_pred` and `y_train`</span>
<span class="sd">        (Optional) that returns a float.</span>
<span class="sd">        - If `list`: List containing multiple strings and/or Callables.</span>
<span class="sd">    exog : pandas Series, pandas DataFrame, default `None`</span>
<span class="sd">        Exogenous variable/s included as predictor/s. Must have the same</span>
<span class="sd">        number of observations as `y` and should be aligned so that y[i] is</span>
<span class="sd">        regressed on exog[i].</span>
<span class="sd">    lags_grid : list, dict, default `None`</span>
<span class="sd">        Lists of lags to try, containing int, lists, numpy ndarray, or range </span>
<span class="sd">        objects. If `dict`, the keys are used as labels in the `results` </span>
<span class="sd">        DataFrame, and the values are used as the lists of lags to try.</span>
<span class="sd">    return_best : bool, default `True`</span>
<span class="sd">        Refit the `forecaster` using the best found parameters on the whole data.</span>
<span class="sd">    n_jobs : int, &#39;auto&#39;, default `&#39;auto&#39;`</span>
<span class="sd">        The number of jobs to run in parallel. If `-1`, then the number of jobs is </span>
<span class="sd">        set to the number of cores. If &#39;auto&#39;, `n_jobs` is set using the function</span>
<span class="sd">        skforecast.utils.select_n_jobs_backtesting.</span>
<span class="sd">    verbose : bool, default `True`</span>
<span class="sd">        Print number of folds used for cv or backtesting.</span>
<span class="sd">    show_progress : bool, default `True`</span>
<span class="sd">        Whether to show a progress bar.</span>
<span class="sd">    output_file : str, default `None`</span>
<span class="sd">        Specifies the filename or full path where the results should be saved. </span>
<span class="sd">        The results will be saved in a tab-separated values (TSV) format. If </span>
<span class="sd">        `None`, the results will not be saved to a file.</span>
<span class="sd">        **New in version 0.12.0**</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    results : pandas DataFrame</span>
<span class="sd">        Results for each combination of parameters.</span>

<span class="sd">        - column lags: lags configuration for each iteration.</span>
<span class="sd">        - column lags_label: descriptive label or alias for the lags.</span>
<span class="sd">        - column params: parameters configuration for each iteration.</span>
<span class="sd">        - column metric: metric value estimated for each iteration.</span>
<span class="sd">        - additional n columns with param = value.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">param_grid</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ParameterGrid</span><span class="p">(</span><span class="n">param_grid</span><span class="p">))</span>

    <span class="n">results</span> <span class="o">=</span> <span class="n">_evaluate_grid_hyperparameters</span><span class="p">(</span>
        <span class="n">forecaster</span>            <span class="o">=</span> <span class="n">forecaster</span><span class="p">,</span>
        <span class="n">y</span>                     <span class="o">=</span> <span class="n">y</span><span class="p">,</span>
        <span class="n">cv</span>                    <span class="o">=</span> <span class="n">cv</span><span class="p">,</span>
        <span class="n">param_grid</span>            <span class="o">=</span> <span class="n">param_grid</span><span class="p">,</span>
        <span class="n">metric</span>                <span class="o">=</span> <span class="n">metric</span><span class="p">,</span>
        <span class="n">exog</span>                  <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
        <span class="n">lags_grid</span>             <span class="o">=</span> <span class="n">lags_grid</span><span class="p">,</span>
        <span class="n">return_best</span>           <span class="o">=</span> <span class="n">return_best</span><span class="p">,</span>
        <span class="n">n_jobs</span>                <span class="o">=</span> <span class="n">n_jobs</span><span class="p">,</span>
        <span class="n">verbose</span>               <span class="o">=</span> <span class="n">verbose</span><span class="p">,</span>
        <span class="n">show_progress</span>         <span class="o">=</span> <span class="n">show_progress</span><span class="p">,</span>
        <span class="n">output_file</span>           <span class="o">=</span> <span class="n">output_file</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">results</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="skforecast.model_selection._search.random_search_forecaster" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">skforecast</span><span class="o">.</span><span class="n">model_selection</span><span class="o">.</span><span class="n">_search</span><span class="o">.</span><span class="n">random_search_forecaster</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="p">,</span> <span class="n">param_distributions</span><span class="p">,</span> <span class="n">metric</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lags_grid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_iter</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span> <span class="n">return_best</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">output_file</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#skforecast.model_selection._search.random_search_forecaster" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">

        <p>Random search over specified parameter values or distributions for a Forecaster 
object. Validation is done using time series backtesting.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>forecaster</code></td>
            <td>
                  <code>(ForecasterRecursive, ForecasterDirect)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Forecaster model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>y</code></td>
            <td>
                  <code>pandas Series</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training time series.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>cv</code></td>
            <td>
                  <code>(<a class="autorefs autorefs-internal" title="skforecast.model_selection._split.TimeSeriesFold" href="#skforecast.model_selection._split.TimeSeriesFold">TimeSeriesFold</a>, <a class="autorefs autorefs-internal" title="skforecast.model_selection._split.OneStepAheadFold" href="#skforecast.model_selection._split.OneStepAheadFold">OneStepAheadFold</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>TimeSeriesFold or OneStepAheadFold object with the information needed to split
the data into folds.
<strong>New in version 0.14.0</strong></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>param_distributions</code></td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary with parameters names (<code>str</code>) as keys and 
distributions or lists of parameters to try.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>metric</code></td>
            <td>
                  <code>(str, <span title="typing.Callable">Callable</span>, list)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Metric used to quantify the goodness of fit of the model.</p>
<ul>
<li>If <code>string</code>: {'mean_squared_error', 'mean_absolute_error',
'mean_absolute_percentage_error', 'mean_squared_log_error',
'mean_absolute_scaled_error', 'root_mean_squared_scaled_error'}</li>
<li>If <code>Callable</code>: Function with arguments <code>y_true</code>, <code>y_pred</code> and <code>y_train</code>
(Optional) that returns a float.</li>
<li>If <code>list</code>: List containing multiple strings and/or Callables.</li>
</ul>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>exog</code></td>
            <td>
                  <code>pandas Series, pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variable/s included as predictor/s. Must have the same
number of observations as <code>y</code> and should be aligned so that y[i] is
regressed on exog[i].</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>lags_grid</code></td>
            <td>
                  <code>(list, dict)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Lists of lags to try, containing int, lists, numpy ndarray, or range 
objects. If <code>dict</code>, the keys are used as labels in the <code>results</code> 
DataFrame, and the values are used as the lists of lags to try.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>n_iter</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of parameter settings that are sampled per lags configuration. 
n_iter trades off runtime vs quality of the solution.</p>
              </div>
            </td>
            <td>
                  <code>`10`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>random_state</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sets a seed to the random sampling for reproducible output.</p>
              </div>
            </td>
            <td>
                  <code>`123`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>return_best</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Refit the <code>forecaster</code> using the best found parameters on the whole data.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>n_jobs</code></td>
            <td>
                  <code>(int, auto)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of jobs to run in parallel. If <code>-1</code>, then the number of jobs is 
set to the number of cores. If 'auto', <code>n_jobs</code> is set using the function
skforecast.utils.select_n_jobs_backtesting.</p>
              </div>
            </td>
            <td>
                  <code>`&#39;auto&#39;`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>verbose</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Print number of folds used for cv or backtesting.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>show_progress</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to show a progress bar.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>output_file</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specifies the filename or full path where the results should be saved. 
The results will be saved in a tab-separated values (TSV) format. If 
<code>None</code>, the results will not be saved to a file.
<strong>New in version 0.12.0</strong></p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>results</code></td>            <td>
                  <code>pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Results for each combination of parameters.</p>
<ul>
<li>column lags: lags configuration for each iteration.</li>
<li>column lags_label: descriptive label or alias for the lags.</li>
<li>column params: parameters configuration for each iteration.</li>
<li>column metric: metric value estimated for each iteration.</li>
<li>additional n columns with param = value.</li>
</ul>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>skforecast\model_selection\_search.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">random_search_forecaster</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
    <span class="n">cv</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">TimeSeriesFold</span><span class="p">,</span> <span class="n">OneStepAheadFold</span><span class="p">],</span>
    <span class="n">param_distributions</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="nb">list</span><span class="p">],</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">lags_grid</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">n_iter</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
    <span class="n">return_best</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">output_file</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Random search over specified parameter values or distributions for a Forecaster </span>
<span class="sd">    object. Validation is done using time series backtesting.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    forecaster : ForecasterRecursive, ForecasterDirect</span>
<span class="sd">        Forecaster model.</span>
<span class="sd">    y : pandas Series</span>
<span class="sd">        Training time series.</span>
<span class="sd">    cv : TimeSeriesFold, OneStepAheadFold</span>
<span class="sd">        TimeSeriesFold or OneStepAheadFold object with the information needed to split</span>
<span class="sd">        the data into folds.</span>
<span class="sd">        **New in version 0.14.0**</span>
<span class="sd">    param_distributions : dict</span>
<span class="sd">        Dictionary with parameters names (`str`) as keys and </span>
<span class="sd">        distributions or lists of parameters to try.</span>
<span class="sd">    metric : str, Callable, list</span>
<span class="sd">        Metric used to quantify the goodness of fit of the model.</span>

<span class="sd">        - If `string`: {&#39;mean_squared_error&#39;, &#39;mean_absolute_error&#39;,</span>
<span class="sd">        &#39;mean_absolute_percentage_error&#39;, &#39;mean_squared_log_error&#39;,</span>
<span class="sd">        &#39;mean_absolute_scaled_error&#39;, &#39;root_mean_squared_scaled_error&#39;}</span>
<span class="sd">        - If `Callable`: Function with arguments `y_true`, `y_pred` and `y_train`</span>
<span class="sd">        (Optional) that returns a float.</span>
<span class="sd">        - If `list`: List containing multiple strings and/or Callables.</span>
<span class="sd">    exog : pandas Series, pandas DataFrame, default `None`</span>
<span class="sd">        Exogenous variable/s included as predictor/s. Must have the same</span>
<span class="sd">        number of observations as `y` and should be aligned so that y[i] is</span>
<span class="sd">        regressed on exog[i]. </span>
<span class="sd">    lags_grid : list, dict, default `None`</span>
<span class="sd">        Lists of lags to try, containing int, lists, numpy ndarray, or range </span>
<span class="sd">        objects. If `dict`, the keys are used as labels in the `results` </span>
<span class="sd">        DataFrame, and the values are used as the lists of lags to try.</span>
<span class="sd">    n_iter : int, default `10`</span>
<span class="sd">        Number of parameter settings that are sampled per lags configuration. </span>
<span class="sd">        n_iter trades off runtime vs quality of the solution.</span>
<span class="sd">    random_state : int, default `123`</span>
<span class="sd">        Sets a seed to the random sampling for reproducible output.</span>
<span class="sd">    return_best : bool, default `True`</span>
<span class="sd">        Refit the `forecaster` using the best found parameters on the whole data.</span>
<span class="sd">    n_jobs : int, &#39;auto&#39;, default `&#39;auto&#39;`</span>
<span class="sd">        The number of jobs to run in parallel. If `-1`, then the number of jobs is </span>
<span class="sd">        set to the number of cores. If &#39;auto&#39;, `n_jobs` is set using the function</span>
<span class="sd">        skforecast.utils.select_n_jobs_backtesting.</span>
<span class="sd">    verbose : bool, default `True`</span>
<span class="sd">        Print number of folds used for cv or backtesting.</span>
<span class="sd">    show_progress : bool, default `True`</span>
<span class="sd">        Whether to show a progress bar.</span>
<span class="sd">    output_file : str, default `None`</span>
<span class="sd">        Specifies the filename or full path where the results should be saved. </span>
<span class="sd">        The results will be saved in a tab-separated values (TSV) format. If </span>
<span class="sd">        `None`, the results will not be saved to a file.</span>
<span class="sd">        **New in version 0.12.0**</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    results : pandas DataFrame</span>
<span class="sd">        Results for each combination of parameters.</span>

<span class="sd">        - column lags: lags configuration for each iteration.</span>
<span class="sd">        - column lags_label: descriptive label or alias for the lags.</span>
<span class="sd">        - column params: parameters configuration for each iteration.</span>
<span class="sd">        - column metric: metric value estimated for each iteration.</span>
<span class="sd">        - additional n columns with param = value.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">param_grid</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ParameterSampler</span><span class="p">(</span><span class="n">param_distributions</span><span class="p">,</span> <span class="n">n_iter</span><span class="o">=</span><span class="n">n_iter</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">))</span>

    <span class="n">results</span> <span class="o">=</span> <span class="n">_evaluate_grid_hyperparameters</span><span class="p">(</span>
        <span class="n">forecaster</span>            <span class="o">=</span> <span class="n">forecaster</span><span class="p">,</span>
        <span class="n">y</span>                     <span class="o">=</span> <span class="n">y</span><span class="p">,</span>
        <span class="n">cv</span>                    <span class="o">=</span> <span class="n">cv</span><span class="p">,</span>
        <span class="n">param_grid</span>            <span class="o">=</span> <span class="n">param_grid</span><span class="p">,</span>
        <span class="n">metric</span>                <span class="o">=</span> <span class="n">metric</span><span class="p">,</span>
        <span class="n">exog</span>                  <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
        <span class="n">lags_grid</span>             <span class="o">=</span> <span class="n">lags_grid</span><span class="p">,</span>
        <span class="n">return_best</span>           <span class="o">=</span> <span class="n">return_best</span><span class="p">,</span>
        <span class="n">n_jobs</span>                <span class="o">=</span> <span class="n">n_jobs</span><span class="p">,</span>
        <span class="n">verbose</span>               <span class="o">=</span> <span class="n">verbose</span><span class="p">,</span>
        <span class="n">show_progress</span>         <span class="o">=</span> <span class="n">show_progress</span><span class="p">,</span>
        <span class="n">output_file</span>           <span class="o">=</span> <span class="n">output_file</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">results</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="skforecast.model_selection._search.bayesian_search_forecaster" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">skforecast</span><span class="o">.</span><span class="n">model_selection</span><span class="o">.</span><span class="n">_search</span><span class="o">.</span><span class="n">bayesian_search_forecaster</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="p">,</span> <span class="n">search_space</span><span class="p">,</span> <span class="n">metric</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_trials</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span> <span class="n">return_best</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">output_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">kwargs_create_study</span><span class="o">=</span><span class="p">{},</span> <span class="n">kwargs_study_optimize</span><span class="o">=</span><span class="p">{})</span></code>

<a href="#skforecast.model_selection._search.bayesian_search_forecaster" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">

        <p>Bayesian search for hyperparameters of a Forecaster object.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>forecaster</code></td>
            <td>
                  <code>(ForecasterRecursive, ForecasterDirect)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Forecaster model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>y</code></td>
            <td>
                  <code>pandas Series</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training time series.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>cv</code></td>
            <td>
                  <code>(<a class="autorefs autorefs-internal" title="skforecast.model_selection._split.TimeSeriesFold" href="#skforecast.model_selection._split.TimeSeriesFold">TimeSeriesFold</a>, <a class="autorefs autorefs-internal" title="skforecast.model_selection._split.OneStepAheadFold" href="#skforecast.model_selection._split.OneStepAheadFold">OneStepAheadFold</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>TimeSeriesFold or OneStepAheadFold object with the information needed to split
the data into folds.
<strong>New in version 0.14.0</strong></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>search_space</code></td>
            <td>
                  <code><span title="typing.Callable">Callable</span>(optuna)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function with argument <code>trial</code> which returns a dictionary with parameters names 
(<code>str</code>) as keys and Trial object from optuna (trial.suggest_float, 
trial.suggest_int, trial.suggest_categorical) as values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>metric</code></td>
            <td>
                  <code>(str, <span title="typing.Callable">Callable</span>, list)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Metric used to quantify the goodness of fit of the model.</p>
<ul>
<li>If <code>string</code>: {'mean_squared_error', 'mean_absolute_error',
'mean_absolute_percentage_error', 'mean_squared_log_error',
'mean_absolute_scaled_error', 'root_mean_squared_scaled_error'}</li>
<li>If <code>Callable</code>: Function with arguments <code>y_true</code>, <code>y_pred</code> and <code>y_train</code>
(Optional) that returns a float.</li>
<li>If <code>list</code>: List containing multiple strings and/or Callables.</li>
</ul>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>exog</code></td>
            <td>
                  <code>pandas Series, pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variable/s included as predictor/s. Must have the same
number of observations as <code>y</code> and should be aligned so that y[i] is
regressed on exog[i].</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>n_trials</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of parameter settings that are sampled in each lag configuration.</p>
              </div>
            </td>
            <td>
                  <code>`10`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>random_state</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sets a seed to the sampling for reproducible output. When a new sampler 
is passed in <code>kwargs_create_study</code>, the seed must be set within the 
sampler. For example <code>{'sampler': TPESampler(seed=145)}</code>.</p>
              </div>
            </td>
            <td>
                  <code>`123`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>return_best</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Refit the <code>forecaster</code> using the best found parameters on the whole data.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>n_jobs</code></td>
            <td>
                  <code>(int, auto)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of jobs to run in parallel. If <code>-1</code>, then the number of jobs is 
set to the number of cores. If 'auto', <code>n_jobs</code> is set using the function
skforecast.utils.select_n_jobs_backtesting.</p>
              </div>
            </td>
            <td>
                  <code>`&#39;auto&#39;`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>verbose</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Print number of folds used for cv or backtesting.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>show_progress</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to show a progress bar.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>output_file</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specifies the filename or full path where the results should be saved. 
The results will be saved in a tab-separated values (TSV) format. If 
<code>None</code>, the results will not be saved to a file.
<strong>New in version 0.12.0</strong></p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>kwargs_create_study</code></td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Keyword arguments (key, value mappings) to pass to optuna.create_study().
If default, the direction is set to 'minimize' and a TPESampler(seed=123) 
sampler is used during optimization.</p>
              </div>
            </td>
            <td>
                  <code>`{}`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>kwargs_study_optimize</code></td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Other keyword arguments (key, value mappings) to pass to study.optimize().</p>
              </div>
            </td>
            <td>
                  <code>`{}`</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>results</code></td>            <td>
                  <code>pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Results for each combination of parameters.</p>
<ul>
<li>column lags: lags configuration for each iteration.</li>
<li>column params: parameters configuration for each iteration.</li>
<li>column metric: metric value estimated for each iteration.</li>
<li>additional n columns with param = value.</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>best_trial</code></td>            <td>
                  <code>optuna object</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The best optimization result returned as a FrozenTrial optuna object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>skforecast\model_selection\_search.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">bayesian_search_forecaster</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
    <span class="n">cv</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">TimeSeriesFold</span><span class="p">,</span> <span class="n">OneStepAheadFold</span><span class="p">],</span>
    <span class="n">search_space</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="nb">list</span><span class="p">],</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">n_trials</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
    <span class="n">return_best</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">output_file</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">kwargs_create_study</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">kwargs_study_optimize</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">object</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Bayesian search for hyperparameters of a Forecaster object.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    forecaster : ForecasterRecursive, ForecasterDirect</span>
<span class="sd">        Forecaster model.</span>
<span class="sd">    y : pandas Series</span>
<span class="sd">        Training time series.</span>
<span class="sd">    cv : TimeSeriesFold, OneStepAheadFold</span>
<span class="sd">        TimeSeriesFold or OneStepAheadFold object with the information needed to split</span>
<span class="sd">        the data into folds.</span>
<span class="sd">        **New in version 0.14.0**</span>
<span class="sd">    search_space : Callable (optuna)</span>
<span class="sd">        Function with argument `trial` which returns a dictionary with parameters names </span>
<span class="sd">        (`str`) as keys and Trial object from optuna (trial.suggest_float, </span>
<span class="sd">        trial.suggest_int, trial.suggest_categorical) as values.</span>
<span class="sd">    metric : str, Callable, list</span>
<span class="sd">        Metric used to quantify the goodness of fit of the model.</span>

<span class="sd">        - If `string`: {&#39;mean_squared_error&#39;, &#39;mean_absolute_error&#39;,</span>
<span class="sd">        &#39;mean_absolute_percentage_error&#39;, &#39;mean_squared_log_error&#39;,</span>
<span class="sd">        &#39;mean_absolute_scaled_error&#39;, &#39;root_mean_squared_scaled_error&#39;}</span>
<span class="sd">        - If `Callable`: Function with arguments `y_true`, `y_pred` and `y_train`</span>
<span class="sd">        (Optional) that returns a float.</span>
<span class="sd">        - If `list`: List containing multiple strings and/or Callables.</span>
<span class="sd">    exog : pandas Series, pandas DataFrame, default `None`</span>
<span class="sd">        Exogenous variable/s included as predictor/s. Must have the same</span>
<span class="sd">        number of observations as `y` and should be aligned so that y[i] is</span>
<span class="sd">        regressed on exog[i].</span>
<span class="sd">    n_trials : int, default `10`</span>
<span class="sd">        Number of parameter settings that are sampled in each lag configuration.</span>
<span class="sd">    random_state : int, default `123`</span>
<span class="sd">        Sets a seed to the sampling for reproducible output. When a new sampler </span>
<span class="sd">        is passed in `kwargs_create_study`, the seed must be set within the </span>
<span class="sd">        sampler. For example `{&#39;sampler&#39;: TPESampler(seed=145)}`.</span>
<span class="sd">    return_best : bool, default `True`</span>
<span class="sd">        Refit the `forecaster` using the best found parameters on the whole data.</span>
<span class="sd">    n_jobs : int, &#39;auto&#39;, default `&#39;auto&#39;`</span>
<span class="sd">        The number of jobs to run in parallel. If `-1`, then the number of jobs is </span>
<span class="sd">        set to the number of cores. If &#39;auto&#39;, `n_jobs` is set using the function</span>
<span class="sd">        skforecast.utils.select_n_jobs_backtesting.</span>
<span class="sd">    verbose : bool, default `True`</span>
<span class="sd">        Print number of folds used for cv or backtesting.</span>
<span class="sd">    show_progress : bool, default `True`</span>
<span class="sd">        Whether to show a progress bar.</span>
<span class="sd">    output_file : str, default `None`</span>
<span class="sd">        Specifies the filename or full path where the results should be saved. </span>
<span class="sd">        The results will be saved in a tab-separated values (TSV) format. If </span>
<span class="sd">        `None`, the results will not be saved to a file.</span>
<span class="sd">        **New in version 0.12.0**</span>
<span class="sd">    kwargs_create_study : dict, default `{}`</span>
<span class="sd">        Keyword arguments (key, value mappings) to pass to optuna.create_study().</span>
<span class="sd">        If default, the direction is set to &#39;minimize&#39; and a TPESampler(seed=123) </span>
<span class="sd">        sampler is used during optimization.</span>
<span class="sd">    kwargs_study_optimize : dict, default `{}`</span>
<span class="sd">        Other keyword arguments (key, value mappings) to pass to study.optimize().</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    results : pandas DataFrame</span>
<span class="sd">        Results for each combination of parameters.</span>

<span class="sd">        - column lags: lags configuration for each iteration.</span>
<span class="sd">        - column params: parameters configuration for each iteration.</span>
<span class="sd">        - column metric: metric value estimated for each iteration.</span>
<span class="sd">        - additional n columns with param = value.</span>
<span class="sd">    best_trial : optuna object</span>
<span class="sd">        The best optimization result returned as a FrozenTrial optuna object.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">return_best</span> <span class="ow">and</span> <span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`exog` must have same number of samples as `y`. &quot;</span>
             <span class="sa">f</span><span class="s2">&quot;length `exog`: (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span><span class="si">}</span><span class="s2">), length `y`: (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="n">results</span><span class="p">,</span> <span class="n">best_trial</span> <span class="o">=</span> <span class="n">_bayesian_search_optuna</span><span class="p">(</span>
                                <span class="n">forecaster</span>            <span class="o">=</span> <span class="n">forecaster</span><span class="p">,</span>
                                <span class="n">y</span>                     <span class="o">=</span> <span class="n">y</span><span class="p">,</span>
                                <span class="n">cv</span>                    <span class="o">=</span> <span class="n">cv</span><span class="p">,</span>
                                <span class="n">exog</span>                  <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
                                <span class="n">search_space</span>          <span class="o">=</span> <span class="n">search_space</span><span class="p">,</span>
                                <span class="n">metric</span>                <span class="o">=</span> <span class="n">metric</span><span class="p">,</span>
                                <span class="n">n_trials</span>              <span class="o">=</span> <span class="n">n_trials</span><span class="p">,</span>
                                <span class="n">random_state</span>          <span class="o">=</span> <span class="n">random_state</span><span class="p">,</span>
                                <span class="n">return_best</span>           <span class="o">=</span> <span class="n">return_best</span><span class="p">,</span>
                                <span class="n">n_jobs</span>                <span class="o">=</span> <span class="n">n_jobs</span><span class="p">,</span>
                                <span class="n">verbose</span>               <span class="o">=</span> <span class="n">verbose</span><span class="p">,</span>
                                <span class="n">show_progress</span>         <span class="o">=</span> <span class="n">show_progress</span><span class="p">,</span>
                                <span class="n">output_file</span>           <span class="o">=</span> <span class="n">output_file</span><span class="p">,</span>
                                <span class="n">kwargs_create_study</span>   <span class="o">=</span> <span class="n">kwargs_create_study</span><span class="p">,</span>
                                <span class="n">kwargs_study_optimize</span> <span class="o">=</span> <span class="n">kwargs_study_optimize</span>
                          <span class="p">)</span>

    <span class="k">return</span> <span class="n">results</span><span class="p">,</span> <span class="n">best_trial</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="skforecast.model_selection._validation.backtesting_forecaster_multiseries" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">skforecast</span><span class="o">.</span><span class="n">model_selection</span><span class="o">.</span><span class="n">_validation</span><span class="o">.</span><span class="n">backtesting_forecaster_multiseries</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">series</span><span class="p">,</span> <span class="n">cv</span><span class="p">,</span> <span class="n">metric</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">add_aggregated_metric</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_boot</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span> <span class="n">use_in_sample_residuals</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">suppress_warnings</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#skforecast.model_selection._validation.backtesting_forecaster_multiseries" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">

        <p>Backtesting of forecaster model following the folds generated by the TimeSeriesFold
class and using the metric(s) provided.</p>
<p>If <code>forecaster</code> is already trained and <code>initial_train_size</code> is set to <code>None</code> in the
TimeSeriesFold class, no initial train will be done and all data will be used
to evaluate the model. However, the first <code>len(forecaster.last_window)</code> observations
are needed to create the initial predictors, so no predictions are calculated for
them.</p>
<p>A copy of the original forecaster is created so that it is not modified during 
the process.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>forecaster</code></td>
            <td>
                  <code>(ForecasterRecursiveMultiSeries, ForecasterDirectMultiVariate, ForecasterRnn)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Forecaster model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>series</code></td>
            <td>
                  <code>pandas DataFrame, dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training time series.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>cv</code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="skforecast.model_selection._split.TimeSeriesFold" href="#skforecast.model_selection._split.TimeSeriesFold">TimeSeriesFold</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>TimeSeriesFold object with the information needed to split the data into folds.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>metric</code></td>
            <td>
                  <code>(str, <span title="typing.Callable">Callable</span>, list)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Metric used to quantify the goodness of fit of the model.</p>
<ul>
<li>If <code>string</code>: {'mean_squared_error', 'mean_absolute_error',
'mean_absolute_percentage_error', 'mean_squared_log_error',
'mean_absolute_scaled_error', 'root_mean_squared_scaled_error'}</li>
<li>If <code>Callable</code>: Function with arguments <code>y_true</code>, <code>y_pred</code> and <code>y_train</code>
(Optional) that returns a float.</li>
<li>If <code>list</code>: List containing multiple strings and/or Callables.</li>
</ul>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>levels</code></td>
            <td>
                  <code>(str, list)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time series to be predicted. If <code>None</code> all levels will be predicted.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>add_aggregated_metric</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, and multiple series (<code>levels</code>) are predicted, the aggregated
metrics (average, weighted average and pooled) are also returned.</p>
<ul>
<li>'average': the average (arithmetic mean) of all levels.</li>
<li>'weighted_average': the average of the metrics weighted by the number of
predicted values of each level.</li>
<li>'pooling': the values of all levels are pooled and then the metric is
calculated.</li>
</ul>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>exog</code></td>
            <td>
                  <code>pandas Series, pandas DataFrame, dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variables.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>interval</code></td>
            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Confidence of the prediction interval estimated. Sequence of percentiles
to compute, which must be between 0 and 100 inclusive. If <code>None</code>, no
intervals are estimated.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>n_boot</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of bootstrapping iterations used to estimate prediction
intervals.</p>
              </div>
            </td>
            <td>
                  <code>`250`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>random_state</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sets a seed to the random generator, so that boot intervals are always 
deterministic.</p>
              </div>
            </td>
            <td>
                  <code>`123`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>use_in_sample_residuals</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, residuals from the training data are used as proxy of prediction 
error to create prediction intervals. If <code>False</code>, out_sample_residuals 
are used if they are already stored inside the forecaster.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>n_jobs</code></td>
            <td>
                  <code>(int, auto)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of jobs to run in parallel. If <code>-1</code>, then the number of jobs is 
set to the number of cores. If 'auto', <code>n_jobs</code> is set using the function
skforecast.utils.select_n_jobs_backtesting.</p>
              </div>
            </td>
            <td>
                  <code>`&#39;auto&#39;`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>verbose</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Print number of folds and index of training and validation sets used 
for backtesting.</p>
              </div>
            </td>
            <td>
                  <code>`False`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>show_progress</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to show a progress bar.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>suppress_warnings</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, skforecast warnings will be suppressed during the backtesting 
process. See skforecast.exceptions.warn_skforecast_categories for more
information.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>metrics_levels</code></td>            <td>
                  <code>pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Value(s) of the metric(s). Index are the levels and columns the metrics.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>backtest_predictions</code></td>            <td>
                  <code>pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Value of predictions and their estimated interval if <code>interval</code> is not <code>None</code>.
If there is more than one level, this structure will be repeated for each of them.</p>
<ul>
<li>column pred: predictions.</li>
<li>column lower_bound: lower bound of the interval.</li>
<li>column upper_bound: upper bound of the interval.</li>
</ul>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>skforecast\model_selection\_validation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">backtesting_forecaster_multiseries</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
    <span class="n">series</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">dict</span><span class="p">],</span>
    <span class="n">cv</span><span class="p">:</span> <span class="n">TimeSeriesFold</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="nb">list</span><span class="p">],</span>
    <span class="n">levels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">add_aggregated_metric</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">interval</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">n_boot</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span>
    <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
    <span class="n">use_in_sample_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">suppress_warnings</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Backtesting of forecaster model following the folds generated by the TimeSeriesFold</span>
<span class="sd">    class and using the metric(s) provided.</span>

<span class="sd">    If `forecaster` is already trained and `initial_train_size` is set to `None` in the</span>
<span class="sd">    TimeSeriesFold class, no initial train will be done and all data will be used</span>
<span class="sd">    to evaluate the model. However, the first `len(forecaster.last_window)` observations</span>
<span class="sd">    are needed to create the initial predictors, so no predictions are calculated for</span>
<span class="sd">    them.</span>

<span class="sd">    A copy of the original forecaster is created so that it is not modified during </span>
<span class="sd">    the process.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    forecaster : ForecasterRecursiveMultiSeries, ForecasterDirectMultiVariate, ForecasterRnn</span>
<span class="sd">        Forecaster model.</span>
<span class="sd">    series : pandas DataFrame, dict</span>
<span class="sd">        Training time series.</span>
<span class="sd">    cv : TimeSeriesFold</span>
<span class="sd">        TimeSeriesFold object with the information needed to split the data into folds.</span>
<span class="sd">    metric : str, Callable, list</span>
<span class="sd">        Metric used to quantify the goodness of fit of the model.</span>

<span class="sd">        - If `string`: {&#39;mean_squared_error&#39;, &#39;mean_absolute_error&#39;,</span>
<span class="sd">        &#39;mean_absolute_percentage_error&#39;, &#39;mean_squared_log_error&#39;,</span>
<span class="sd">        &#39;mean_absolute_scaled_error&#39;, &#39;root_mean_squared_scaled_error&#39;}</span>
<span class="sd">        - If `Callable`: Function with arguments `y_true`, `y_pred` and `y_train`</span>
<span class="sd">        (Optional) that returns a float.</span>
<span class="sd">        - If `list`: List containing multiple strings and/or Callables.</span>
<span class="sd">    levels : str, list, default `None`</span>
<span class="sd">        Time series to be predicted. If `None` all levels will be predicted.</span>
<span class="sd">    add_aggregated_metric : bool, default `True`</span>
<span class="sd">        If `True`, and multiple series (`levels`) are predicted, the aggregated</span>
<span class="sd">        metrics (average, weighted average and pooled) are also returned.</span>

<span class="sd">        - &#39;average&#39;: the average (arithmetic mean) of all levels.</span>
<span class="sd">        - &#39;weighted_average&#39;: the average of the metrics weighted by the number of</span>
<span class="sd">        predicted values of each level.</span>
<span class="sd">        - &#39;pooling&#39;: the values of all levels are pooled and then the metric is</span>
<span class="sd">        calculated.</span>
<span class="sd">    exog : pandas Series, pandas DataFrame, dict, default `None`</span>
<span class="sd">        Exogenous variables.</span>
<span class="sd">    interval : list, default `None`</span>
<span class="sd">        Confidence of the prediction interval estimated. Sequence of percentiles</span>
<span class="sd">        to compute, which must be between 0 and 100 inclusive. If `None`, no</span>
<span class="sd">        intervals are estimated.</span>
<span class="sd">    n_boot : int, default `250`</span>
<span class="sd">        Number of bootstrapping iterations used to estimate prediction</span>
<span class="sd">        intervals.</span>
<span class="sd">    random_state : int, default `123`</span>
<span class="sd">        Sets a seed to the random generator, so that boot intervals are always </span>
<span class="sd">        deterministic.</span>
<span class="sd">    use_in_sample_residuals : bool, default `True`</span>
<span class="sd">        If `True`, residuals from the training data are used as proxy of prediction </span>
<span class="sd">        error to create prediction intervals. If `False`, out_sample_residuals </span>
<span class="sd">        are used if they are already stored inside the forecaster.</span>
<span class="sd">    n_jobs : int, &#39;auto&#39;, default `&#39;auto&#39;`</span>
<span class="sd">        The number of jobs to run in parallel. If `-1`, then the number of jobs is </span>
<span class="sd">        set to the number of cores. If &#39;auto&#39;, `n_jobs` is set using the function</span>
<span class="sd">        skforecast.utils.select_n_jobs_backtesting.</span>
<span class="sd">    verbose : bool, default `False`</span>
<span class="sd">        Print number of folds and index of training and validation sets used </span>
<span class="sd">        for backtesting.</span>
<span class="sd">    show_progress : bool, default `True`</span>
<span class="sd">        Whether to show a progress bar.</span>
<span class="sd">    suppress_warnings: bool, default `False`</span>
<span class="sd">        If `True`, skforecast warnings will be suppressed during the backtesting </span>
<span class="sd">        process. See skforecast.exceptions.warn_skforecast_categories for more</span>
<span class="sd">        information.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    metrics_levels : pandas DataFrame</span>
<span class="sd">        Value(s) of the metric(s). Index are the levels and columns the metrics.</span>
<span class="sd">    backtest_predictions : pandas DataFrame</span>
<span class="sd">        Value of predictions and their estimated interval if `interval` is not `None`.</span>
<span class="sd">        If there is more than one level, this structure will be repeated for each of them.</span>

<span class="sd">        - column pred: predictions.</span>
<span class="sd">        - column lower_bound: lower bound of the interval.</span>
<span class="sd">        - column upper_bound: upper bound of the interval.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">multi_series_forecasters</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;ForecasterRecursiveMultiSeries&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;ForecasterDirectMultiVariate&#39;</span><span class="p">,</span>
        <span class="s1">&#39;ForecasterRnn&#39;</span>
    <span class="p">]</span>

    <span class="n">forecaster_name</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">forecaster</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>

    <span class="k">if</span> <span class="n">forecaster_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">multi_series_forecasters</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`forecaster` must be of type </span><span class="si">{</span><span class="n">multi_series_forecasters</span><span class="si">}</span><span class="s2">, &quot;</span>
             <span class="sa">f</span><span class="s2">&quot;for all other types of forecasters use the functions available in &quot;</span>
             <span class="sa">f</span><span class="s2">&quot;the `model_selection` module. Got </span><span class="si">{</span><span class="n">forecaster_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="n">check_backtesting_input</span><span class="p">(</span>
        <span class="n">forecaster</span>              <span class="o">=</span> <span class="n">forecaster</span><span class="p">,</span>
        <span class="n">cv</span>                      <span class="o">=</span> <span class="n">cv</span><span class="p">,</span>
        <span class="n">metric</span>                  <span class="o">=</span> <span class="n">metric</span><span class="p">,</span>
        <span class="n">add_aggregated_metric</span>   <span class="o">=</span> <span class="n">add_aggregated_metric</span><span class="p">,</span>
        <span class="n">series</span>                  <span class="o">=</span> <span class="n">series</span><span class="p">,</span>
        <span class="n">exog</span>                    <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
        <span class="n">interval</span>                <span class="o">=</span> <span class="n">interval</span><span class="p">,</span>
        <span class="n">n_boot</span>                  <span class="o">=</span> <span class="n">n_boot</span><span class="p">,</span>
        <span class="n">random_state</span>            <span class="o">=</span> <span class="n">random_state</span><span class="p">,</span>
        <span class="n">use_in_sample_residuals</span> <span class="o">=</span> <span class="n">use_in_sample_residuals</span><span class="p">,</span>
        <span class="n">n_jobs</span>                  <span class="o">=</span> <span class="n">n_jobs</span><span class="p">,</span>
        <span class="n">show_progress</span>           <span class="o">=</span> <span class="n">show_progress</span><span class="p">,</span>
        <span class="n">suppress_warnings</span>       <span class="o">=</span> <span class="n">suppress_warnings</span>
    <span class="p">)</span>

    <span class="n">metrics_levels</span><span class="p">,</span> <span class="n">backtest_predictions</span> <span class="o">=</span> <span class="n">_backtesting_forecaster_multiseries</span><span class="p">(</span>
        <span class="n">forecaster</span>              <span class="o">=</span> <span class="n">forecaster</span><span class="p">,</span>
        <span class="n">series</span>                  <span class="o">=</span> <span class="n">series</span><span class="p">,</span>
        <span class="n">cv</span>                      <span class="o">=</span> <span class="n">cv</span><span class="p">,</span>
        <span class="n">levels</span>                  <span class="o">=</span> <span class="n">levels</span><span class="p">,</span>
        <span class="n">metric</span>                  <span class="o">=</span> <span class="n">metric</span><span class="p">,</span>
        <span class="n">add_aggregated_metric</span>   <span class="o">=</span> <span class="n">add_aggregated_metric</span><span class="p">,</span>
        <span class="n">exog</span>                    <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
        <span class="n">interval</span>                <span class="o">=</span> <span class="n">interval</span><span class="p">,</span>
        <span class="n">n_boot</span>                  <span class="o">=</span> <span class="n">n_boot</span><span class="p">,</span>
        <span class="n">random_state</span>            <span class="o">=</span> <span class="n">random_state</span><span class="p">,</span>
        <span class="n">use_in_sample_residuals</span> <span class="o">=</span> <span class="n">use_in_sample_residuals</span><span class="p">,</span>
        <span class="n">n_jobs</span>                  <span class="o">=</span> <span class="n">n_jobs</span><span class="p">,</span>
        <span class="n">verbose</span>                 <span class="o">=</span> <span class="n">verbose</span><span class="p">,</span>
        <span class="n">show_progress</span>           <span class="o">=</span> <span class="n">show_progress</span><span class="p">,</span>
        <span class="n">suppress_warnings</span>       <span class="o">=</span> <span class="n">suppress_warnings</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">metrics_levels</span><span class="p">,</span> <span class="n">backtest_predictions</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="skforecast.model_selection._search.grid_search_forecaster_multiseries" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">skforecast</span><span class="o">.</span><span class="n">model_selection</span><span class="o">.</span><span class="n">_search</span><span class="o">.</span><span class="n">grid_search_forecaster_multiseries</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">series</span><span class="p">,</span> <span class="n">cv</span><span class="p">,</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">metric</span><span class="p">,</span> <span class="n">aggregate_metric</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;weighted_average&#39;</span><span class="p">,</span> <span class="s1">&#39;average&#39;</span><span class="p">,</span> <span class="s1">&#39;pooling&#39;</span><span class="p">],</span> <span class="n">levels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lags_grid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_best</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">suppress_warnings</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">output_file</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#skforecast.model_selection._search.grid_search_forecaster_multiseries" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">

        <p>Exhaustive search over specified parameter values for a Forecaster object.
Validation is done using multi-series backtesting.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>forecaster</code></td>
            <td>
                  <code>(ForecasterRecursiveMultiSeries, ForecasterDirectMultiVariate)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Forecaster model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>series</code></td>
            <td>
                  <code>pandas DataFrame, dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training time series.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>cv</code></td>
            <td>
                  <code>(<a class="autorefs autorefs-internal" title="skforecast.model_selection._split.TimeSeriesFold" href="#skforecast.model_selection._split.TimeSeriesFold">TimeSeriesFold</a>, <a class="autorefs autorefs-internal" title="skforecast.model_selection._split.OneStepAheadFold" href="#skforecast.model_selection._split.OneStepAheadFold">OneStepAheadFold</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>TimeSeriesFold or OneStepAheadFold object with the information needed to split
the data into folds.
<strong>New in version 0.14.0</strong></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>param_grid</code></td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary with parameters names (<code>str</code>) as keys and lists of parameter
settings to try as values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>metric</code></td>
            <td>
                  <code>(str, <span title="typing.Callable">Callable</span>, list)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Metric used to quantify the goodness of fit of the model.</p>
<ul>
<li>If <code>string</code>: {'mean_squared_error', 'mean_absolute_error',
'mean_absolute_percentage_error', 'mean_squared_log_error',
'mean_absolute_scaled_error', 'root_mean_squared_scaled_error'}</li>
<li>If <code>Callable</code>: Function with arguments <code>y_true</code>, <code>y_pred</code> and <code>y_train</code>
(Optional) that returns a float.</li>
<li>If <code>list</code>: List containing multiple strings and/or Callables.</li>
</ul>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>aggregate_metric</code></td>
            <td>
                  <code>(str, list)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Aggregation method/s used to combine the metric/s of all levels (series)
when multiple levels are predicted. If list, the first aggregation method
is used to select the best parameters.</p>
<ul>
<li>'average': the average (arithmetic mean) of all levels.</li>
<li>'weighted_average': the average of the metrics weighted by the number of
predicted values of each level.</li>
<li>'pooling': the values of all levels are pooled and then the metric is
calculated.</li>
</ul>
              </div>
            </td>
            <td>
                  <code>`[&#39;weighted_average&#39;, &#39;average&#39;, &#39;pooling&#39;]`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>levels</code></td>
            <td>
                  <code>(str, list)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>level (<code>str</code>) or levels (<code>list</code>) at which the forecaster is optimized. 
If <code>None</code>, all levels are taken into account.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>exog</code></td>
            <td>
                  <code>pandas Series, pandas DataFrame, dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variables.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>lags_grid</code></td>
            <td>
                  <code>(list, dict)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Lists of lags to try, containing int, lists, numpy ndarray, or range 
objects. If <code>dict</code>, the keys are used as labels in the <code>results</code> 
DataFrame, and the values are used as the lists of lags to try.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>return_best</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Refit the <code>forecaster</code> using the best found parameters on the whole data.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>n_jobs</code></td>
            <td>
                  <code>(int, auto)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of jobs to run in parallel. If <code>-1</code>, then the number of jobs is 
set to the number of cores. If 'auto', <code>n_jobs</code> is set using the function
skforecast.utils.select_n_jobs_backtesting.</p>
              </div>
            </td>
            <td>
                  <code>`&#39;auto&#39;`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>verbose</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Print number of folds used for cv or backtesting.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>show_progress</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to show a progress bar.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>suppress_warnings</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, skforecast warnings will be suppressed during the hyperparameter 
search. See skforecast.exceptions.warn_skforecast_categories for more
information.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>output_file</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specifies the filename or full path where the results should be saved. 
The results will be saved in a tab-separated values (TSV) format. If 
<code>None</code>, the results will not be saved to a file.
<strong>New in version 0.12.0</strong></p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>results</code></td>            <td>
                  <code>pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Results for each combination of parameters.</p>
<ul>
<li>column levels: levels configuration for each iteration.</li>
<li>column lags: lags configuration for each iteration.</li>
<li>column lags_label: descriptive label or alias for the lags.</li>
<li>column params: parameters configuration for each iteration.</li>
<li>column metric: metric value estimated for each iteration. The resulting 
metric will be the average of the optimization of all levels.</li>
<li>additional n columns with param = value.</li>
</ul>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>skforecast\model_selection\_search.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">grid_search_forecaster_multiseries</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
    <span class="n">series</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">dict</span><span class="p">],</span>
    <span class="n">cv</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">TimeSeriesFold</span><span class="p">,</span> <span class="n">OneStepAheadFold</span><span class="p">],</span>
    <span class="n">param_grid</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="nb">list</span><span class="p">],</span>
    <span class="n">aggregate_metric</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;weighted_average&#39;</span><span class="p">,</span> <span class="s1">&#39;average&#39;</span><span class="p">,</span> <span class="s1">&#39;pooling&#39;</span><span class="p">],</span>
    <span class="n">levels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">lags_grid</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">return_best</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">suppress_warnings</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">output_file</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Exhaustive search over specified parameter values for a Forecaster object.</span>
<span class="sd">    Validation is done using multi-series backtesting.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    forecaster : ForecasterRecursiveMultiSeries, ForecasterDirectMultiVariate</span>
<span class="sd">        Forecaster model.</span>
<span class="sd">    series : pandas DataFrame, dict</span>
<span class="sd">        Training time series.</span>
<span class="sd">    cv : TimeSeriesFold, OneStepAheadFold</span>
<span class="sd">        TimeSeriesFold or OneStepAheadFold object with the information needed to split</span>
<span class="sd">        the data into folds.</span>
<span class="sd">        **New in version 0.14.0**</span>
<span class="sd">    param_grid : dict</span>
<span class="sd">        Dictionary with parameters names (`str`) as keys and lists of parameter</span>
<span class="sd">        settings to try as values.</span>
<span class="sd">    metric : str, Callable, list</span>
<span class="sd">        Metric used to quantify the goodness of fit of the model.</span>

<span class="sd">        - If `string`: {&#39;mean_squared_error&#39;, &#39;mean_absolute_error&#39;,</span>
<span class="sd">        &#39;mean_absolute_percentage_error&#39;, &#39;mean_squared_log_error&#39;,</span>
<span class="sd">        &#39;mean_absolute_scaled_error&#39;, &#39;root_mean_squared_scaled_error&#39;}</span>
<span class="sd">        - If `Callable`: Function with arguments `y_true`, `y_pred` and `y_train`</span>
<span class="sd">        (Optional) that returns a float.</span>
<span class="sd">        - If `list`: List containing multiple strings and/or Callables.</span>
<span class="sd">    aggregate_metric : str, list, default `[&#39;weighted_average&#39;, &#39;average&#39;, &#39;pooling&#39;]`</span>
<span class="sd">        Aggregation method/s used to combine the metric/s of all levels (series)</span>
<span class="sd">        when multiple levels are predicted. If list, the first aggregation method</span>
<span class="sd">        is used to select the best parameters.</span>

<span class="sd">        - &#39;average&#39;: the average (arithmetic mean) of all levels.</span>
<span class="sd">        - &#39;weighted_average&#39;: the average of the metrics weighted by the number of</span>
<span class="sd">        predicted values of each level.</span>
<span class="sd">        - &#39;pooling&#39;: the values of all levels are pooled and then the metric is</span>
<span class="sd">        calculated.</span>
<span class="sd">    levels : str, list, default `None`</span>
<span class="sd">        level (`str`) or levels (`list`) at which the forecaster is optimized. </span>
<span class="sd">        If `None`, all levels are taken into account.</span>
<span class="sd">    exog : pandas Series, pandas DataFrame, dict, default `None`</span>
<span class="sd">        Exogenous variables.</span>
<span class="sd">    lags_grid : list, dict, default `None`</span>
<span class="sd">        Lists of lags to try, containing int, lists, numpy ndarray, or range </span>
<span class="sd">        objects. If `dict`, the keys are used as labels in the `results` </span>
<span class="sd">        DataFrame, and the values are used as the lists of lags to try.</span>
<span class="sd">    return_best : bool, default `True`</span>
<span class="sd">        Refit the `forecaster` using the best found parameters on the whole data.</span>
<span class="sd">    n_jobs : int, &#39;auto&#39;, default `&#39;auto&#39;`</span>
<span class="sd">        The number of jobs to run in parallel. If `-1`, then the number of jobs is </span>
<span class="sd">        set to the number of cores. If &#39;auto&#39;, `n_jobs` is set using the function</span>
<span class="sd">        skforecast.utils.select_n_jobs_backtesting.</span>
<span class="sd">    verbose : bool, default `True`</span>
<span class="sd">        Print number of folds used for cv or backtesting.</span>
<span class="sd">    show_progress : bool, default `True`</span>
<span class="sd">        Whether to show a progress bar.</span>
<span class="sd">    suppress_warnings: bool, default `False`</span>
<span class="sd">        If `True`, skforecast warnings will be suppressed during the hyperparameter </span>
<span class="sd">        search. See skforecast.exceptions.warn_skforecast_categories for more</span>
<span class="sd">        information.</span>
<span class="sd">    output_file : str, default `None`</span>
<span class="sd">        Specifies the filename or full path where the results should be saved. </span>
<span class="sd">        The results will be saved in a tab-separated values (TSV) format. If </span>
<span class="sd">        `None`, the results will not be saved to a file.</span>
<span class="sd">        **New in version 0.12.0**</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    results : pandas DataFrame</span>
<span class="sd">        Results for each combination of parameters.</span>

<span class="sd">        - column levels: levels configuration for each iteration.</span>
<span class="sd">        - column lags: lags configuration for each iteration.</span>
<span class="sd">        - column lags_label: descriptive label or alias for the lags.</span>
<span class="sd">        - column params: parameters configuration for each iteration.</span>
<span class="sd">        - column metric: metric value estimated for each iteration. The resulting </span>
<span class="sd">        metric will be the average of the optimization of all levels.</span>
<span class="sd">        - additional n columns with param = value.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">param_grid</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ParameterGrid</span><span class="p">(</span><span class="n">param_grid</span><span class="p">))</span>

    <span class="n">results</span> <span class="o">=</span> <span class="n">_evaluate_grid_hyperparameters_multiseries</span><span class="p">(</span>
                <span class="n">forecaster</span>            <span class="o">=</span> <span class="n">forecaster</span><span class="p">,</span>
                <span class="n">series</span>                <span class="o">=</span> <span class="n">series</span><span class="p">,</span>
                <span class="n">cv</span>                    <span class="o">=</span> <span class="n">cv</span><span class="p">,</span>
                <span class="n">param_grid</span>            <span class="o">=</span> <span class="n">param_grid</span><span class="p">,</span>
                <span class="n">metric</span>                <span class="o">=</span> <span class="n">metric</span><span class="p">,</span>
                <span class="n">aggregate_metric</span>      <span class="o">=</span> <span class="n">aggregate_metric</span><span class="p">,</span>
                <span class="n">levels</span>                <span class="o">=</span> <span class="n">levels</span><span class="p">,</span>
                <span class="n">exog</span>                  <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
                <span class="n">lags_grid</span>             <span class="o">=</span> <span class="n">lags_grid</span><span class="p">,</span>
                <span class="n">n_jobs</span>                <span class="o">=</span> <span class="n">n_jobs</span><span class="p">,</span>
                <span class="n">return_best</span>           <span class="o">=</span> <span class="n">return_best</span><span class="p">,</span>
                <span class="n">verbose</span>               <span class="o">=</span> <span class="n">verbose</span><span class="p">,</span>
                <span class="n">show_progress</span>         <span class="o">=</span> <span class="n">show_progress</span><span class="p">,</span>
                <span class="n">suppress_warnings</span>     <span class="o">=</span> <span class="n">suppress_warnings</span><span class="p">,</span>
                <span class="n">output_file</span>           <span class="o">=</span> <span class="n">output_file</span>
            <span class="p">)</span>

    <span class="k">return</span> <span class="n">results</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="skforecast.model_selection._search.random_search_forecaster_multiseries" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">skforecast</span><span class="o">.</span><span class="n">model_selection</span><span class="o">.</span><span class="n">_search</span><span class="o">.</span><span class="n">random_search_forecaster_multiseries</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">series</span><span class="p">,</span> <span class="n">cv</span><span class="p">,</span> <span class="n">param_distributions</span><span class="p">,</span> <span class="n">metric</span><span class="p">,</span> <span class="n">aggregate_metric</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;weighted_average&#39;</span><span class="p">,</span> <span class="s1">&#39;average&#39;</span><span class="p">,</span> <span class="s1">&#39;pooling&#39;</span><span class="p">],</span> <span class="n">levels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lags_grid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_iter</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span> <span class="n">return_best</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">suppress_warnings</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">output_file</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#skforecast.model_selection._search.random_search_forecaster_multiseries" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">

        <p>Random search over specified parameter values or distributions for a Forecaster 
object. Validation is done using multi-series backtesting.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>forecaster</code></td>
            <td>
                  <code>(ForecasterRecursiveMultiSeries, ForecasterDirectMultiVariate)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Forecaster model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>series</code></td>
            <td>
                  <code>pandas DataFrame, dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training time series.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>cv</code></td>
            <td>
                  <code>(<a class="autorefs autorefs-internal" title="skforecast.model_selection._split.TimeSeriesFold" href="#skforecast.model_selection._split.TimeSeriesFold">TimeSeriesFold</a>, <a class="autorefs autorefs-internal" title="skforecast.model_selection._split.OneStepAheadFold" href="#skforecast.model_selection._split.OneStepAheadFold">OneStepAheadFold</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>TimeSeriesFold or OneStepAheadFold object with the information needed to split
the data into folds.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>param_distributions</code></td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary with parameters names (<code>str</code>) as keys and distributions or 
lists of parameters to try.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>metric</code></td>
            <td>
                  <code>(str, <span title="typing.Callable">Callable</span>, list)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Metric used to quantify the goodness of fit of the model.</p>
<ul>
<li>If <code>string</code>: {'mean_squared_error', 'mean_absolute_error',
'mean_absolute_percentage_error', 'mean_squared_log_error',
'mean_absolute_scaled_error', 'root_mean_squared_scaled_error'}</li>
<li>If <code>Callable</code>: Function with arguments <code>y_true</code>, <code>y_pred</code> and <code>y_train</code>
(Optional) that returns a float.</li>
<li>If <code>list</code>: List containing multiple strings and/or Callables.</li>
</ul>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>aggregate_metric</code></td>
            <td>
                  <code>(str, list)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Aggregation method/s used to combine the metric/s of all levels (series)
when multiple levels are predicted. If list, the first aggregation method
is used to select the best parameters.</p>
<ul>
<li>'average': the average (arithmetic mean) of all levels.</li>
<li>'weighted_average': the average of the metrics weighted by the number of
predicted values of each level.</li>
<li>'pooling': the values of all levels are pooled and then the metric is
calculated.</li>
</ul>
              </div>
            </td>
            <td>
                  <code>`[&#39;weighted_average&#39;, &#39;average&#39;, &#39;pooling&#39;]`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>levels</code></td>
            <td>
                  <code>(str, list)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>level (<code>str</code>) or levels (<code>list</code>) at which the forecaster is optimized. 
If <code>None</code>, all levels are taken into account.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>exog</code></td>
            <td>
                  <code>pandas Series, pandas DataFrame, dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variables.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>lags_grid</code></td>
            <td>
                  <code>(list, dict)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Lists of lags to try, containing int, lists, numpy ndarray, or range 
objects. If <code>dict</code>, the keys are used as labels in the <code>results</code> 
DataFrame, and the values are used as the lists of lags to try.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>n_iter</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of parameter settings that are sampled per lags configuration. 
n_iter trades off runtime vs quality of the solution.</p>
              </div>
            </td>
            <td>
                  <code>`10`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>random_state</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sets a seed to the random sampling for reproducible output.</p>
              </div>
            </td>
            <td>
                  <code>`123`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>return_best</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Refit the <code>forecaster</code> using the best found parameters on the whole data.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>n_jobs</code></td>
            <td>
                  <code>(int, auto)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of jobs to run in parallel. If <code>-1</code>, then the number of jobs is 
set to the number of cores. If 'auto', <code>n_jobs</code> is set using the function
skforecast.utils.select_n_jobs_backtesting.</p>
              </div>
            </td>
            <td>
                  <code>`&#39;auto&#39;`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>verbose</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Print number of folds used for cv or backtesting.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>show_progress</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to show a progress bar.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>suppress_warnings</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, skforecast warnings will be suppressed during the hyperparameter 
search. See skforecast.exceptions.warn_skforecast_categories for more
information.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>output_file</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specifies the filename or full path where the results should be saved. 
The results will be saved in a tab-separated values (TSV) format. If 
<code>None</code>, the results will not be saved to a file.
<strong>New in version 0.12.0</strong></p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>results</code></td>            <td>
                  <code>pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Results for each combination of parameters.</p>
<ul>
<li>column levels: levels configuration for each iteration.</li>
<li>column lags: lags configuration for each iteration.</li>
<li>column lags_label: descriptive label or alias for the lags.</li>
<li>column params: parameters configuration for each iteration.</li>
<li>column metric: metric value estimated for each iteration. The resulting 
metric will be the average of the optimization of all levels.</li>
<li>additional n columns with param = value.</li>
</ul>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>skforecast\model_selection\_search.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">random_search_forecaster_multiseries</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
    <span class="n">series</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">dict</span><span class="p">],</span>
    <span class="n">cv</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">TimeSeriesFold</span><span class="p">,</span> <span class="n">OneStepAheadFold</span><span class="p">],</span>
    <span class="n">param_distributions</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="nb">list</span><span class="p">],</span>
    <span class="n">aggregate_metric</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;weighted_average&#39;</span><span class="p">,</span> <span class="s1">&#39;average&#39;</span><span class="p">,</span> <span class="s1">&#39;pooling&#39;</span><span class="p">],</span>
    <span class="n">levels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">lags_grid</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">n_iter</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
    <span class="n">return_best</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">suppress_warnings</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">output_file</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Random search over specified parameter values or distributions for a Forecaster </span>
<span class="sd">    object. Validation is done using multi-series backtesting.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    forecaster : ForecasterRecursiveMultiSeries, ForecasterDirectMultiVariate</span>
<span class="sd">        Forecaster model.</span>
<span class="sd">    series : pandas DataFrame, dict</span>
<span class="sd">        Training time series.</span>
<span class="sd">    cv : TimeSeriesFold, OneStepAheadFold</span>
<span class="sd">        TimeSeriesFold or OneStepAheadFold object with the information needed to split</span>
<span class="sd">        the data into folds.</span>
<span class="sd">    param_distributions : dict</span>
<span class="sd">        Dictionary with parameters names (`str`) as keys and distributions or </span>
<span class="sd">        lists of parameters to try.</span>
<span class="sd">    metric : str, Callable, list</span>
<span class="sd">        Metric used to quantify the goodness of fit of the model.</span>

<span class="sd">        - If `string`: {&#39;mean_squared_error&#39;, &#39;mean_absolute_error&#39;,</span>
<span class="sd">        &#39;mean_absolute_percentage_error&#39;, &#39;mean_squared_log_error&#39;,</span>
<span class="sd">        &#39;mean_absolute_scaled_error&#39;, &#39;root_mean_squared_scaled_error&#39;}</span>
<span class="sd">        - If `Callable`: Function with arguments `y_true`, `y_pred` and `y_train`</span>
<span class="sd">        (Optional) that returns a float.</span>
<span class="sd">        - If `list`: List containing multiple strings and/or Callables.</span>
<span class="sd">    aggregate_metric : str, list, default `[&#39;weighted_average&#39;, &#39;average&#39;, &#39;pooling&#39;]`</span>
<span class="sd">        Aggregation method/s used to combine the metric/s of all levels (series)</span>
<span class="sd">        when multiple levels are predicted. If list, the first aggregation method</span>
<span class="sd">        is used to select the best parameters.</span>

<span class="sd">        - &#39;average&#39;: the average (arithmetic mean) of all levels.</span>
<span class="sd">        - &#39;weighted_average&#39;: the average of the metrics weighted by the number of</span>
<span class="sd">        predicted values of each level.</span>
<span class="sd">        - &#39;pooling&#39;: the values of all levels are pooled and then the metric is</span>
<span class="sd">        calculated.</span>
<span class="sd">    levels : str, list, default `None`</span>
<span class="sd">        level (`str`) or levels (`list`) at which the forecaster is optimized. </span>
<span class="sd">        If `None`, all levels are taken into account.</span>
<span class="sd">    exog : pandas Series, pandas DataFrame, dict, default `None`</span>
<span class="sd">        Exogenous variables.</span>
<span class="sd">    lags_grid : list, dict, default `None`</span>
<span class="sd">        Lists of lags to try, containing int, lists, numpy ndarray, or range </span>
<span class="sd">        objects. If `dict`, the keys are used as labels in the `results` </span>
<span class="sd">        DataFrame, and the values are used as the lists of lags to try.</span>
<span class="sd">    n_iter : int, default `10`</span>
<span class="sd">        Number of parameter settings that are sampled per lags configuration. </span>
<span class="sd">        n_iter trades off runtime vs quality of the solution.</span>
<span class="sd">    random_state : int, default `123`</span>
<span class="sd">        Sets a seed to the random sampling for reproducible output.</span>
<span class="sd">    return_best : bool, default `True`</span>
<span class="sd">        Refit the `forecaster` using the best found parameters on the whole data.</span>
<span class="sd">    n_jobs : int, &#39;auto&#39;, default `&#39;auto&#39;`</span>
<span class="sd">        The number of jobs to run in parallel. If `-1`, then the number of jobs is </span>
<span class="sd">        set to the number of cores. If &#39;auto&#39;, `n_jobs` is set using the function</span>
<span class="sd">        skforecast.utils.select_n_jobs_backtesting.</span>
<span class="sd">    verbose : bool, default `True`</span>
<span class="sd">        Print number of folds used for cv or backtesting.</span>
<span class="sd">    show_progress : bool, default `True`</span>
<span class="sd">        Whether to show a progress bar.</span>
<span class="sd">    suppress_warnings: bool, default `False`</span>
<span class="sd">        If `True`, skforecast warnings will be suppressed during the hyperparameter </span>
<span class="sd">        search. See skforecast.exceptions.warn_skforecast_categories for more</span>
<span class="sd">        information.</span>
<span class="sd">    output_file : str, default `None`</span>
<span class="sd">        Specifies the filename or full path where the results should be saved. </span>
<span class="sd">        The results will be saved in a tab-separated values (TSV) format. If </span>
<span class="sd">        `None`, the results will not be saved to a file.</span>
<span class="sd">        **New in version 0.12.0**</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    results : pandas DataFrame</span>
<span class="sd">        Results for each combination of parameters.</span>

<span class="sd">        - column levels: levels configuration for each iteration.</span>
<span class="sd">        - column lags: lags configuration for each iteration.</span>
<span class="sd">        - column lags_label: descriptive label or alias for the lags.</span>
<span class="sd">        - column params: parameters configuration for each iteration.</span>
<span class="sd">        - column metric: metric value estimated for each iteration. The resulting </span>
<span class="sd">        metric will be the average of the optimization of all levels.</span>
<span class="sd">        - additional n columns with param = value.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">param_grid</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ParameterSampler</span><span class="p">(</span><span class="n">param_distributions</span><span class="p">,</span> <span class="n">n_iter</span><span class="o">=</span><span class="n">n_iter</span><span class="p">,</span> 
                                       <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">))</span>

    <span class="n">results</span> <span class="o">=</span> <span class="n">_evaluate_grid_hyperparameters_multiseries</span><span class="p">(</span>
                <span class="n">forecaster</span>            <span class="o">=</span> <span class="n">forecaster</span><span class="p">,</span>
                <span class="n">series</span>                <span class="o">=</span> <span class="n">series</span><span class="p">,</span>
                <span class="n">cv</span>                    <span class="o">=</span> <span class="n">cv</span><span class="p">,</span>
                <span class="n">param_grid</span>            <span class="o">=</span> <span class="n">param_grid</span><span class="p">,</span>
                <span class="n">metric</span>                <span class="o">=</span> <span class="n">metric</span><span class="p">,</span>
                <span class="n">aggregate_metric</span>      <span class="o">=</span> <span class="n">aggregate_metric</span><span class="p">,</span>
                <span class="n">levels</span>                <span class="o">=</span> <span class="n">levels</span><span class="p">,</span>
                <span class="n">exog</span>                  <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
                <span class="n">lags_grid</span>             <span class="o">=</span> <span class="n">lags_grid</span><span class="p">,</span>
                <span class="n">return_best</span>           <span class="o">=</span> <span class="n">return_best</span><span class="p">,</span>
                <span class="n">n_jobs</span>                <span class="o">=</span> <span class="n">n_jobs</span><span class="p">,</span>
                <span class="n">verbose</span>               <span class="o">=</span> <span class="n">verbose</span><span class="p">,</span>
                <span class="n">show_progress</span>         <span class="o">=</span> <span class="n">show_progress</span><span class="p">,</span>
                <span class="n">suppress_warnings</span>     <span class="o">=</span> <span class="n">suppress_warnings</span><span class="p">,</span>
                <span class="n">output_file</span>           <span class="o">=</span> <span class="n">output_file</span>
            <span class="p">)</span>

    <span class="k">return</span> <span class="n">results</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="skforecast.model_selection._search.bayesian_search_forecaster_multiseries" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">skforecast</span><span class="o">.</span><span class="n">model_selection</span><span class="o">.</span><span class="n">_search</span><span class="o">.</span><span class="n">bayesian_search_forecaster_multiseries</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">series</span><span class="p">,</span> <span class="n">cv</span><span class="p">,</span> <span class="n">search_space</span><span class="p">,</span> <span class="n">metric</span><span class="p">,</span> <span class="n">aggregate_metric</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;weighted_average&#39;</span><span class="p">,</span> <span class="s1">&#39;average&#39;</span><span class="p">,</span> <span class="s1">&#39;pooling&#39;</span><span class="p">],</span> <span class="n">levels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_trials</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span> <span class="n">return_best</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">suppress_warnings</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">output_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">kwargs_create_study</span><span class="o">=</span><span class="p">{},</span> <span class="n">kwargs_study_optimize</span><span class="o">=</span><span class="p">{})</span></code>

<a href="#skforecast.model_selection._search.bayesian_search_forecaster_multiseries" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">

        <p>Bayesian search for hyperparameters of a Forecaster object using optuna library.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>forecaster</code></td>
            <td>
                  <code>(ForecasterRecursiveMultiSeries, ForecasterDirectMultiVariate)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Forecaster model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>series</code></td>
            <td>
                  <code>pandas DataFrame, dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training time series.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>search_space</code></td>
            <td>
                  <code><span title="typing.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function with argument <code>trial</code> which returns a dictionary with parameters names 
(<code>str</code>) as keys and Trial object from optuna (trial.suggest_float, 
trial.suggest_int, trial.suggest_categorical) as values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>metric</code></td>
            <td>
                  <code>(str, <span title="typing.Callable">Callable</span>, list)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Metric used to quantify the goodness of fit of the model.</p>
<ul>
<li>If <code>string</code>: {'mean_squared_error', 'mean_absolute_error',
'mean_absolute_percentage_error', 'mean_squared_log_error',
'mean_absolute_scaled_error', 'root_mean_squared_scaled_error'}</li>
<li>If <code>Callable</code>: Function with arguments <code>y_true</code>, <code>y_pred</code> and <code>y_train</code>
(Optional) that returns a float.</li>
<li>If <code>list</code>: List containing multiple strings and/or Callables.</li>
</ul>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>aggregate_metric</code></td>
            <td>
                  <code>(str, list)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Aggregation method/s used to combine the metric/s of all levels (series)
when multiple levels are predicted. If list, the first aggregation method
is used to select the best parameters.</p>
<ul>
<li>'average': the average (arithmetic mean) of all levels.</li>
<li>'weighted_average': the average of the metrics weighted by the number of
predicted values of each level.</li>
<li>'pooling': the values of all levels are pooled and then the metric is
calculated.</li>
</ul>
              </div>
            </td>
            <td>
                  <code>`[&#39;weighted_average&#39;, &#39;average&#39;, &#39;pooling&#39;]`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>levels</code></td>
            <td>
                  <code>(str, list)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>level (<code>str</code>) or levels (<code>list</code>) at which the forecaster is optimized. 
If <code>None</code>, all levels are taken into account.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>exog</code></td>
            <td>
                  <code>pandas Series, pandas DataFrame, dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variables.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>n_trials</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of parameter settings that are sampled in each lag configuration.</p>
              </div>
            </td>
            <td>
                  <code>`10`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>random_state</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sets a seed to the sampling for reproducible output.</p>
              </div>
            </td>
            <td>
                  <code>`123`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>return_best</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Refit the <code>forecaster</code> using the best found parameters on the whole data.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>n_jobs</code></td>
            <td>
                  <code>(int, auto)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of jobs to run in parallel. If <code>-1</code>, then the number of jobs is 
set to the number of cores. If 'auto', <code>n_jobs</code> is set using the function
skforecast.utils.select_n_jobs_backtesting.</p>
              </div>
            </td>
            <td>
                  <code>`&#39;auto&#39;`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>verbose</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Print number of folds used for cv or backtesting.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>show_progress</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to show a progress bar.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>suppress_warnings</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, skforecast warnings will be suppressed during the hyperparameter
search. See skforecast.exceptions.warn_skforecast_categories for more
information.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>output_file</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specifies the filename or full path where the results should be saved. 
The results will be saved in a tab-separated values (TSV) format. If 
<code>None</code>, the results will not be saved to a file.
<strong>New in version 0.12.0</strong></p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>kwargs_create_study</code></td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Keyword arguments (key, value mappings) to pass to optuna.create_study().
If default, the direction is set to 'minimize' and a TPESampler(seed=123) 
sampler is used during optimization.</p>
              </div>
            </td>
            <td>
                  <code>`{}`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>kwargs_study_optimize</code></td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Other keyword arguments (key, value mappings) to pass to study.optimize().</p>
              </div>
            </td>
            <td>
                  <code>`{}`</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>results</code></td>            <td>
                  <code>pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Results for each combination of parameters.</p>
<ul>
<li>column levels: levels configuration for each iteration.</li>
<li>column lags: lags configuration for each iteration.</li>
<li>column params: parameters configuration for each iteration.</li>
<li>column metric: metric value estimated for each iteration. The resulting 
metric will be the average of the optimization of all levels.</li>
<li>additional n columns with param = value.</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>best_trial</code></td>            <td>
                  <code>optuna object</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The best optimization result returned as a FrozenTrial optuna object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>skforecast\model_selection\_search.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">bayesian_search_forecaster_multiseries</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
    <span class="n">series</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">dict</span><span class="p">],</span>
    <span class="n">cv</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">TimeSeriesFold</span><span class="p">,</span> <span class="n">OneStepAheadFold</span><span class="p">],</span>
    <span class="n">search_space</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="nb">list</span><span class="p">],</span>
    <span class="n">aggregate_metric</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;weighted_average&#39;</span><span class="p">,</span> <span class="s1">&#39;average&#39;</span><span class="p">,</span> <span class="s1">&#39;pooling&#39;</span><span class="p">],</span>
    <span class="n">levels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">n_trials</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
    <span class="n">return_best</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">suppress_warnings</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">output_file</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">kwargs_create_study</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">kwargs_study_optimize</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">object</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Bayesian search for hyperparameters of a Forecaster object using optuna library.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    forecaster : ForecasterRecursiveMultiSeries, ForecasterDirectMultiVariate</span>
<span class="sd">        Forecaster model.</span>
<span class="sd">    series : pandas DataFrame, dict</span>
<span class="sd">        Training time series.</span>
<span class="sd">    search_space : Callable</span>
<span class="sd">        Function with argument `trial` which returns a dictionary with parameters names </span>
<span class="sd">        (`str`) as keys and Trial object from optuna (trial.suggest_float, </span>
<span class="sd">        trial.suggest_int, trial.suggest_categorical) as values.</span>
<span class="sd">    metric : str, Callable, list</span>
<span class="sd">        Metric used to quantify the goodness of fit of the model.</span>

<span class="sd">        - If `string`: {&#39;mean_squared_error&#39;, &#39;mean_absolute_error&#39;,</span>
<span class="sd">        &#39;mean_absolute_percentage_error&#39;, &#39;mean_squared_log_error&#39;,</span>
<span class="sd">        &#39;mean_absolute_scaled_error&#39;, &#39;root_mean_squared_scaled_error&#39;}</span>
<span class="sd">        - If `Callable`: Function with arguments `y_true`, `y_pred` and `y_train`</span>
<span class="sd">        (Optional) that returns a float.</span>
<span class="sd">        - If `list`: List containing multiple strings and/or Callables.</span>
<span class="sd">    aggregate_metric : str, list, default `[&#39;weighted_average&#39;, &#39;average&#39;, &#39;pooling&#39;]`</span>
<span class="sd">        Aggregation method/s used to combine the metric/s of all levels (series)</span>
<span class="sd">        when multiple levels are predicted. If list, the first aggregation method</span>
<span class="sd">        is used to select the best parameters.</span>

<span class="sd">        - &#39;average&#39;: the average (arithmetic mean) of all levels.</span>
<span class="sd">        - &#39;weighted_average&#39;: the average of the metrics weighted by the number of</span>
<span class="sd">        predicted values of each level.</span>
<span class="sd">        - &#39;pooling&#39;: the values of all levels are pooled and then the metric is</span>
<span class="sd">        calculated.</span>
<span class="sd">    levels : str, list, default `None`</span>
<span class="sd">        level (`str`) or levels (`list`) at which the forecaster is optimized. </span>
<span class="sd">        If `None`, all levels are taken into account.</span>
<span class="sd">    exog : pandas Series, pandas DataFrame, dict, default `None`</span>
<span class="sd">        Exogenous variables.</span>
<span class="sd">    n_trials : int, default `10`</span>
<span class="sd">        Number of parameter settings that are sampled in each lag configuration.</span>
<span class="sd">    random_state : int, default `123`</span>
<span class="sd">        Sets a seed to the sampling for reproducible output.</span>
<span class="sd">    return_best : bool, default `True`</span>
<span class="sd">        Refit the `forecaster` using the best found parameters on the whole data.</span>
<span class="sd">    n_jobs : int, &#39;auto&#39;, default `&#39;auto&#39;`</span>
<span class="sd">        The number of jobs to run in parallel. If `-1`, then the number of jobs is </span>
<span class="sd">        set to the number of cores. If &#39;auto&#39;, `n_jobs` is set using the function</span>
<span class="sd">        skforecast.utils.select_n_jobs_backtesting.</span>
<span class="sd">    verbose : bool, default `True`</span>
<span class="sd">        Print number of folds used for cv or backtesting.</span>
<span class="sd">    show_progress : bool, default `True`</span>
<span class="sd">        Whether to show a progress bar.</span>
<span class="sd">    suppress_warnings: bool, default `False`</span>
<span class="sd">        If `True`, skforecast warnings will be suppressed during the hyperparameter</span>
<span class="sd">        search. See skforecast.exceptions.warn_skforecast_categories for more</span>
<span class="sd">        information.</span>
<span class="sd">    output_file : str, default `None`</span>
<span class="sd">        Specifies the filename or full path where the results should be saved. </span>
<span class="sd">        The results will be saved in a tab-separated values (TSV) format. If </span>
<span class="sd">        `None`, the results will not be saved to a file.</span>
<span class="sd">        **New in version 0.12.0**</span>
<span class="sd">    kwargs_create_study : dict, default `{}`</span>
<span class="sd">        Keyword arguments (key, value mappings) to pass to optuna.create_study().</span>
<span class="sd">        If default, the direction is set to &#39;minimize&#39; and a TPESampler(seed=123) </span>
<span class="sd">        sampler is used during optimization.</span>
<span class="sd">    kwargs_study_optimize : dict, default `{}`</span>
<span class="sd">        Other keyword arguments (key, value mappings) to pass to study.optimize().</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    results : pandas DataFrame</span>
<span class="sd">        Results for each combination of parameters.</span>

<span class="sd">        - column levels: levels configuration for each iteration.</span>
<span class="sd">        - column lags: lags configuration for each iteration.</span>
<span class="sd">        - column params: parameters configuration for each iteration.</span>
<span class="sd">        - column metric: metric value estimated for each iteration. The resulting </span>
<span class="sd">        metric will be the average of the optimization of all levels.</span>
<span class="sd">        - additional n columns with param = value.</span>
<span class="sd">    best_trial : optuna object</span>
<span class="sd">        The best optimization result returned as a FrozenTrial optuna object.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">return_best</span> <span class="ow">and</span> <span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">series</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`exog` must have same number of samples as `series`. &quot;</span>
             <span class="sa">f</span><span class="s2">&quot;length `exog`: (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span><span class="si">}</span><span class="s2">), length `series`: (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">series</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="n">results</span><span class="p">,</span> <span class="n">best_trial</span> <span class="o">=</span> <span class="n">_bayesian_search_optuna_multiseries</span><span class="p">(</span>
                            <span class="n">forecaster</span>            <span class="o">=</span> <span class="n">forecaster</span><span class="p">,</span>
                            <span class="n">series</span>                <span class="o">=</span> <span class="n">series</span><span class="p">,</span>
                            <span class="n">cv</span>                    <span class="o">=</span> <span class="n">cv</span><span class="p">,</span>
                            <span class="n">exog</span>                  <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
                            <span class="n">levels</span>                <span class="o">=</span> <span class="n">levels</span><span class="p">,</span> 
                            <span class="n">search_space</span>          <span class="o">=</span> <span class="n">search_space</span><span class="p">,</span>
                            <span class="n">metric</span>                <span class="o">=</span> <span class="n">metric</span><span class="p">,</span>
                            <span class="n">aggregate_metric</span>      <span class="o">=</span> <span class="n">aggregate_metric</span><span class="p">,</span>
                            <span class="n">n_trials</span>              <span class="o">=</span> <span class="n">n_trials</span><span class="p">,</span>
                            <span class="n">random_state</span>          <span class="o">=</span> <span class="n">random_state</span><span class="p">,</span>
                            <span class="n">return_best</span>           <span class="o">=</span> <span class="n">return_best</span><span class="p">,</span>
                            <span class="n">n_jobs</span>                <span class="o">=</span> <span class="n">n_jobs</span><span class="p">,</span>
                            <span class="n">verbose</span>               <span class="o">=</span> <span class="n">verbose</span><span class="p">,</span>
                            <span class="n">show_progress</span>         <span class="o">=</span> <span class="n">show_progress</span><span class="p">,</span>
                            <span class="n">suppress_warnings</span>     <span class="o">=</span> <span class="n">suppress_warnings</span><span class="p">,</span>
                            <span class="n">output_file</span>           <span class="o">=</span> <span class="n">output_file</span><span class="p">,</span>
                            <span class="n">kwargs_create_study</span>   <span class="o">=</span> <span class="n">kwargs_create_study</span><span class="p">,</span>
                            <span class="n">kwargs_study_optimize</span> <span class="o">=</span> <span class="n">kwargs_study_optimize</span>
                        <span class="p">)</span>

    <span class="k">return</span> <span class="n">results</span><span class="p">,</span> <span class="n">best_trial</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="skforecast.model_selection._validation.backtesting_sarimax" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">skforecast</span><span class="o">.</span><span class="n">model_selection</span><span class="o">.</span><span class="n">_validation</span><span class="o">.</span><span class="n">backtesting_sarimax</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="p">,</span> <span class="n">metric</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">suppress_warnings_fit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#skforecast.model_selection._validation.backtesting_sarimax" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">

        <p>Backtesting of ForecasterSarimax.</p>
<p>A copy of the original forecaster is created so that it is not modified during 
the process.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>forecaster</code></td>
            <td>
                  <code>ForecasterSarimax</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Forecaster model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>y</code></td>
            <td>
                  <code>pandas Series</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training time series.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>cv</code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="skforecast.model_selection._split.TimeSeriesFold" href="#skforecast.model_selection._split.TimeSeriesFold">TimeSeriesFold</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>TimeSeriesFold object with the information needed to split the data into folds.
<strong>New in version 0.14.0</strong></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>metric</code></td>
            <td>
                  <code>(str, <span title="typing.Callable">Callable</span>, list)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Metric used to quantify the goodness of fit of the model.</p>
<ul>
<li>If <code>string</code>: {'mean_squared_error', 'mean_absolute_error',
'mean_absolute_percentage_error', 'mean_squared_log_error',
'mean_absolute_scaled_error', 'root_mean_squared_scaled_error'}</li>
<li>If <code>Callable</code>: Function with arguments <code>y_true</code>, <code>y_pred</code> and <code>y_train</code>
(Optional) that returns a float.</li>
<li>If <code>list</code>: List containing multiple strings and/or Callables.</li>
</ul>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>exog</code></td>
            <td>
                  <code>pandas Series, pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variable/s included as predictor/s. Must have the same
number of observations as <code>y</code> and should be aligned so that y[i] is
regressed on exog[i].</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>alpha</code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The confidence intervals for the forecasts are (1 - alpha) %.
If both, <code>alpha</code> and <code>interval</code> are provided, <code>alpha</code> will be used.</p>
              </div>
            </td>
            <td>
                  <code>`0.05`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>interval</code></td>
            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Confidence of the prediction interval estimated. The values must be
symmetric. Sequence of percentiles to compute, which must be between 
0 and 100 inclusive. For example, interval of 95% should be as 
<code>interval = [2.5, 97.5]</code>. If both, <code>alpha</code> and <code>interval</code> are 
provided, <code>alpha</code> will be used.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>n_jobs</code></td>
            <td>
                  <code>(int, auto)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of jobs to run in parallel. If <code>-1</code>, then the number of jobs is 
set to the number of cores. If 'auto', <code>n_jobs</code> is set using the function
skforecast.utils.select_n_jobs_backtesting.</p>
              </div>
            </td>
            <td>
                  <code>`&#39;auto&#39;`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>verbose</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Print number of folds and index of training and validation sets used 
for backtesting.</p>
              </div>
            </td>
            <td>
                  <code>`False`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>suppress_warnings_fit</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, warnings generated during fitting will be ignored.</p>
              </div>
            </td>
            <td>
                  <code>`False`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>show_progress</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to show a progress bar.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>metric_values</code></td>            <td>
                  <code>pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Value(s) of the metric(s).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>backtest_predictions</code></td>            <td>
                  <code>pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Value of predictions and their estimated interval if <code>interval</code> is not <code>None</code>.</p>
<ul>
<li>column pred: predictions.</li>
<li>column lower_bound: lower bound of the interval.</li>
<li>column upper_bound: upper bound of the interval.</li>
</ul>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>skforecast\model_selection\_validation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">backtesting_sarimax</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
    <span class="n">cv</span><span class="p">:</span> <span class="n">TimeSeriesFold</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="nb">list</span><span class="p">],</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">alpha</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">interval</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">suppress_warnings_fit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Backtesting of ForecasterSarimax.</span>

<span class="sd">    A copy of the original forecaster is created so that it is not modified during </span>
<span class="sd">    the process.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    forecaster : ForecasterSarimax</span>
<span class="sd">        Forecaster model.</span>
<span class="sd">    y : pandas Series</span>
<span class="sd">        Training time series.</span>
<span class="sd">    cv : TimeSeriesFold</span>
<span class="sd">        TimeSeriesFold object with the information needed to split the data into folds.</span>
<span class="sd">        **New in version 0.14.0**</span>
<span class="sd">    metric : str, Callable, list</span>
<span class="sd">        Metric used to quantify the goodness of fit of the model.</span>

<span class="sd">        - If `string`: {&#39;mean_squared_error&#39;, &#39;mean_absolute_error&#39;,</span>
<span class="sd">        &#39;mean_absolute_percentage_error&#39;, &#39;mean_squared_log_error&#39;,</span>
<span class="sd">        &#39;mean_absolute_scaled_error&#39;, &#39;root_mean_squared_scaled_error&#39;}</span>
<span class="sd">        - If `Callable`: Function with arguments `y_true`, `y_pred` and `y_train`</span>
<span class="sd">        (Optional) that returns a float.</span>
<span class="sd">        - If `list`: List containing multiple strings and/or Callables.</span>
<span class="sd">    exog : pandas Series, pandas DataFrame, default `None`</span>
<span class="sd">        Exogenous variable/s included as predictor/s. Must have the same</span>
<span class="sd">        number of observations as `y` and should be aligned so that y[i] is</span>
<span class="sd">        regressed on exog[i].</span>
<span class="sd">    alpha : float, default `0.05`</span>
<span class="sd">        The confidence intervals for the forecasts are (1 - alpha) %.</span>
<span class="sd">        If both, `alpha` and `interval` are provided, `alpha` will be used.</span>
<span class="sd">    interval : list, default `None`</span>
<span class="sd">        Confidence of the prediction interval estimated. The values must be</span>
<span class="sd">        symmetric. Sequence of percentiles to compute, which must be between </span>
<span class="sd">        0 and 100 inclusive. For example, interval of 95% should be as </span>
<span class="sd">        `interval = [2.5, 97.5]`. If both, `alpha` and `interval` are </span>
<span class="sd">        provided, `alpha` will be used.</span>
<span class="sd">    n_jobs : int, &#39;auto&#39;, default `&#39;auto&#39;`</span>
<span class="sd">        The number of jobs to run in parallel. If `-1`, then the number of jobs is </span>
<span class="sd">        set to the number of cores. If &#39;auto&#39;, `n_jobs` is set using the function</span>
<span class="sd">        skforecast.utils.select_n_jobs_backtesting. </span>
<span class="sd">    verbose : bool, default `False`</span>
<span class="sd">        Print number of folds and index of training and validation sets used </span>
<span class="sd">        for backtesting.</span>
<span class="sd">    suppress_warnings_fit : bool, default `False`</span>
<span class="sd">        If `True`, warnings generated during fitting will be ignored.</span>
<span class="sd">    show_progress : bool, default `True`</span>
<span class="sd">        Whether to show a progress bar.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    metric_values : pandas DataFrame</span>
<span class="sd">        Value(s) of the metric(s).</span>
<span class="sd">    backtest_predictions : pandas DataFrame</span>
<span class="sd">        Value of predictions and their estimated interval if `interval` is not `None`.</span>

<span class="sd">        - column pred: predictions.</span>
<span class="sd">        - column lower_bound: lower bound of the interval.</span>
<span class="sd">        - column upper_bound: upper bound of the interval.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">forecaster</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ForecasterSarimax&#39;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="p">(</span><span class="s2">&quot;`forecaster` must be of type `ForecasterSarimax`, for all other &quot;</span>
             <span class="s2">&quot;types of forecasters use the functions available in the other &quot;</span>
             <span class="s2">&quot;`model_selection` modules.&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="n">check_backtesting_input</span><span class="p">(</span>
        <span class="n">forecaster</span>            <span class="o">=</span> <span class="n">forecaster</span><span class="p">,</span>
        <span class="n">cv</span>                    <span class="o">=</span> <span class="n">cv</span><span class="p">,</span>
        <span class="n">y</span>                     <span class="o">=</span> <span class="n">y</span><span class="p">,</span>
        <span class="n">metric</span>                <span class="o">=</span> <span class="n">metric</span><span class="p">,</span>
        <span class="n">interval</span>              <span class="o">=</span> <span class="n">interval</span><span class="p">,</span>
        <span class="n">alpha</span>                 <span class="o">=</span> <span class="n">alpha</span><span class="p">,</span>
        <span class="n">n_jobs</span>                <span class="o">=</span> <span class="n">n_jobs</span><span class="p">,</span>
        <span class="n">show_progress</span>         <span class="o">=</span> <span class="n">show_progress</span><span class="p">,</span>
        <span class="n">suppress_warnings_fit</span> <span class="o">=</span> <span class="n">suppress_warnings_fit</span>
    <span class="p">)</span>

    <span class="n">metric_values</span><span class="p">,</span> <span class="n">backtest_predictions</span> <span class="o">=</span> <span class="n">_backtesting_sarimax</span><span class="p">(</span>
        <span class="n">forecaster</span>            <span class="o">=</span> <span class="n">forecaster</span><span class="p">,</span>
        <span class="n">y</span>                     <span class="o">=</span> <span class="n">y</span><span class="p">,</span>
        <span class="n">cv</span>                    <span class="o">=</span> <span class="n">cv</span><span class="p">,</span>
        <span class="n">metric</span>                <span class="o">=</span> <span class="n">metric</span><span class="p">,</span>
        <span class="n">exog</span>                  <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
        <span class="n">alpha</span>                 <span class="o">=</span> <span class="n">alpha</span><span class="p">,</span>
        <span class="n">interval</span>              <span class="o">=</span> <span class="n">interval</span><span class="p">,</span>
        <span class="n">n_jobs</span>                <span class="o">=</span> <span class="n">n_jobs</span><span class="p">,</span>
        <span class="n">verbose</span>               <span class="o">=</span> <span class="n">verbose</span><span class="p">,</span>
        <span class="n">suppress_warnings_fit</span> <span class="o">=</span> <span class="n">suppress_warnings_fit</span><span class="p">,</span>
        <span class="n">show_progress</span>         <span class="o">=</span> <span class="n">show_progress</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">metric_values</span><span class="p">,</span> <span class="n">backtest_predictions</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="skforecast.model_selection._search.grid_search_sarimax" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">skforecast</span><span class="o">.</span><span class="n">model_selection</span><span class="o">.</span><span class="n">_search</span><span class="o">.</span><span class="n">grid_search_sarimax</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="p">,</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">metric</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_best</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">suppress_warnings_fit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">output_file</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#skforecast.model_selection._search.grid_search_sarimax" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">

        <p>Exhaustive search over specified parameter values for a ForecasterSarimax object.
Validation is done using time series backtesting.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>forecaster</code></td>
            <td>
                  <code>ForecasterSarimax</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Forecaster model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>y</code></td>
            <td>
                  <code>pandas Series</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training time series.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>cv</code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="skforecast.model_selection._split.TimeSeriesFold" href="#skforecast.model_selection._split.TimeSeriesFold">TimeSeriesFold</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>TimeSeriesFold object with the information needed to split the data into folds.
<strong>New in version 0.14.0</strong></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>param_grid</code></td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary with parameters names (<code>str</code>) as keys and lists of parameter
settings to try as values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>metric</code></td>
            <td>
                  <code>(str, <span title="typing.Callable">Callable</span>, list)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Metric used to quantify the goodness of fit of the model.</p>
<ul>
<li>If <code>string</code>: {'mean_squared_error', 'mean_absolute_error',
'mean_absolute_percentage_error', 'mean_squared_log_error',
'mean_absolute_scaled_error', 'root_mean_squared_scaled_error'}</li>
<li>If <code>Callable</code>: Function with arguments <code>y_true</code>, <code>y_pred</code> and <code>y_train</code>
(Optional) that returns a float.</li>
<li>If <code>list</code>: List containing multiple strings and/or Callables.</li>
</ul>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>exog</code></td>
            <td>
                  <code>pandas Series, pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variable/s included as predictor/s. Must have the same
number of observations as <code>y</code> and should be aligned so that y[i] is
regressed on exog[i].</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>return_best</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Refit the <code>forecaster</code> using the best found parameters on the whole data.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>n_jobs</code></td>
            <td>
                  <code>(int, auto)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of jobs to run in parallel. If <code>-1</code>, then the number of jobs is 
set to the number of cores. If 'auto', <code>n_jobs</code> is set using the function
skforecast.utils.select_n_jobs_backtesting.</p>
              </div>
            </td>
            <td>
                  <code>`&#39;auto&#39;`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>verbose</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Print number of folds used for cv or backtesting.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>suppress_warnings_fit</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, warnings generated during fitting will be ignored.</p>
              </div>
            </td>
            <td>
                  <code>`False`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>show_progress</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to show a progress bar.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>output_file</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specifies the filename or full path where the results should be saved. 
The results will be saved in a tab-separated values (TSV) format. If 
<code>None</code>, the results will not be saved to a file.
<strong>New in version 0.12.0</strong></p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>results</code></td>            <td>
                  <code>pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Results for each combination of parameters.</p>
<ul>
<li>column params: parameters configuration for each iteration.</li>
<li>column metric: metric value estimated for each iteration.</li>
<li>additional n columns with param = value.</li>
</ul>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>skforecast\model_selection\_search.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2090</span>
<span class="normal">2091</span>
<span class="normal">2092</span>
<span class="normal">2093</span>
<span class="normal">2094</span>
<span class="normal">2095</span>
<span class="normal">2096</span>
<span class="normal">2097</span>
<span class="normal">2098</span>
<span class="normal">2099</span>
<span class="normal">2100</span>
<span class="normal">2101</span>
<span class="normal">2102</span>
<span class="normal">2103</span>
<span class="normal">2104</span>
<span class="normal">2105</span>
<span class="normal">2106</span>
<span class="normal">2107</span>
<span class="normal">2108</span>
<span class="normal">2109</span>
<span class="normal">2110</span>
<span class="normal">2111</span>
<span class="normal">2112</span>
<span class="normal">2113</span>
<span class="normal">2114</span>
<span class="normal">2115</span>
<span class="normal">2116</span>
<span class="normal">2117</span>
<span class="normal">2118</span>
<span class="normal">2119</span>
<span class="normal">2120</span>
<span class="normal">2121</span>
<span class="normal">2122</span>
<span class="normal">2123</span>
<span class="normal">2124</span>
<span class="normal">2125</span>
<span class="normal">2126</span>
<span class="normal">2127</span>
<span class="normal">2128</span>
<span class="normal">2129</span>
<span class="normal">2130</span>
<span class="normal">2131</span>
<span class="normal">2132</span>
<span class="normal">2133</span>
<span class="normal">2134</span>
<span class="normal">2135</span>
<span class="normal">2136</span>
<span class="normal">2137</span>
<span class="normal">2138</span>
<span class="normal">2139</span>
<span class="normal">2140</span>
<span class="normal">2141</span>
<span class="normal">2142</span>
<span class="normal">2143</span>
<span class="normal">2144</span>
<span class="normal">2145</span>
<span class="normal">2146</span>
<span class="normal">2147</span>
<span class="normal">2148</span>
<span class="normal">2149</span>
<span class="normal">2150</span>
<span class="normal">2151</span>
<span class="normal">2152</span>
<span class="normal">2153</span>
<span class="normal">2154</span>
<span class="normal">2155</span>
<span class="normal">2156</span>
<span class="normal">2157</span>
<span class="normal">2158</span>
<span class="normal">2159</span>
<span class="normal">2160</span>
<span class="normal">2161</span>
<span class="normal">2162</span>
<span class="normal">2163</span>
<span class="normal">2164</span>
<span class="normal">2165</span>
<span class="normal">2166</span>
<span class="normal">2167</span>
<span class="normal">2168</span>
<span class="normal">2169</span>
<span class="normal">2170</span>
<span class="normal">2171</span>
<span class="normal">2172</span>
<span class="normal">2173</span>
<span class="normal">2174</span>
<span class="normal">2175</span>
<span class="normal">2176</span>
<span class="normal">2177</span>
<span class="normal">2178</span>
<span class="normal">2179</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">grid_search_sarimax</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
    <span class="n">cv</span><span class="p">:</span> <span class="n">TimeSeriesFold</span><span class="p">,</span>
    <span class="n">param_grid</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="nb">list</span><span class="p">],</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">return_best</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">suppress_warnings_fit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">output_file</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Exhaustive search over specified parameter values for a ForecasterSarimax object.</span>
<span class="sd">    Validation is done using time series backtesting.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    forecaster : ForecasterSarimax</span>
<span class="sd">        Forecaster model.</span>
<span class="sd">    y : pandas Series</span>
<span class="sd">        Training time series. </span>
<span class="sd">    cv : TimeSeriesFold</span>
<span class="sd">        TimeSeriesFold object with the information needed to split the data into folds.</span>
<span class="sd">        **New in version 0.14.0**</span>
<span class="sd">    param_grid : dict</span>
<span class="sd">        Dictionary with parameters names (`str`) as keys and lists of parameter</span>
<span class="sd">        settings to try as values.</span>
<span class="sd">    metric : str, Callable, list</span>
<span class="sd">        Metric used to quantify the goodness of fit of the model.</span>

<span class="sd">        - If `string`: {&#39;mean_squared_error&#39;, &#39;mean_absolute_error&#39;,</span>
<span class="sd">        &#39;mean_absolute_percentage_error&#39;, &#39;mean_squared_log_error&#39;,</span>
<span class="sd">        &#39;mean_absolute_scaled_error&#39;, &#39;root_mean_squared_scaled_error&#39;}</span>
<span class="sd">        - If `Callable`: Function with arguments `y_true`, `y_pred` and `y_train`</span>
<span class="sd">        (Optional) that returns a float.</span>
<span class="sd">        - If `list`: List containing multiple strings and/or Callables.</span>
<span class="sd">    exog : pandas Series, pandas DataFrame, default `None`</span>
<span class="sd">        Exogenous variable/s included as predictor/s. Must have the same</span>
<span class="sd">        number of observations as `y` and should be aligned so that y[i] is</span>
<span class="sd">        regressed on exog[i].</span>
<span class="sd">    return_best : bool, default `True`</span>
<span class="sd">        Refit the `forecaster` using the best found parameters on the whole data.</span>
<span class="sd">    n_jobs : int, &#39;auto&#39;, default `&#39;auto&#39;`</span>
<span class="sd">        The number of jobs to run in parallel. If `-1`, then the number of jobs is </span>
<span class="sd">        set to the number of cores. If &#39;auto&#39;, `n_jobs` is set using the function</span>
<span class="sd">        skforecast.utils.select_n_jobs_backtesting.</span>
<span class="sd">    verbose : bool, default `True`</span>
<span class="sd">        Print number of folds used for cv or backtesting.</span>
<span class="sd">    suppress_warnings_fit : bool, default `False`</span>
<span class="sd">        If `True`, warnings generated during fitting will be ignored.</span>
<span class="sd">    show_progress : bool, default `True`</span>
<span class="sd">        Whether to show a progress bar.</span>
<span class="sd">    output_file : str, default `None`</span>
<span class="sd">        Specifies the filename or full path where the results should be saved. </span>
<span class="sd">        The results will be saved in a tab-separated values (TSV) format. If </span>
<span class="sd">        `None`, the results will not be saved to a file.</span>
<span class="sd">        **New in version 0.12.0**</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    results : pandas DataFrame</span>
<span class="sd">        Results for each combination of parameters.</span>

<span class="sd">        - column params: parameters configuration for each iteration.</span>
<span class="sd">        - column metric: metric value estimated for each iteration.</span>
<span class="sd">        - additional n columns with param = value.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">param_grid</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ParameterGrid</span><span class="p">(</span><span class="n">param_grid</span><span class="p">))</span>

    <span class="n">results</span> <span class="o">=</span> <span class="n">_evaluate_grid_hyperparameters_sarimax</span><span class="p">(</span>
        <span class="n">forecaster</span>            <span class="o">=</span> <span class="n">forecaster</span><span class="p">,</span>
        <span class="n">y</span>                     <span class="o">=</span> <span class="n">y</span><span class="p">,</span>
        <span class="n">cv</span>                    <span class="o">=</span> <span class="n">cv</span><span class="p">,</span>
        <span class="n">param_grid</span>            <span class="o">=</span> <span class="n">param_grid</span><span class="p">,</span>
        <span class="n">metric</span>                <span class="o">=</span> <span class="n">metric</span><span class="p">,</span>
        <span class="n">exog</span>                  <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
        <span class="n">return_best</span>           <span class="o">=</span> <span class="n">return_best</span><span class="p">,</span>
        <span class="n">n_jobs</span>                <span class="o">=</span> <span class="n">n_jobs</span><span class="p">,</span>
        <span class="n">verbose</span>               <span class="o">=</span> <span class="n">verbose</span><span class="p">,</span>
        <span class="n">suppress_warnings_fit</span> <span class="o">=</span> <span class="n">suppress_warnings_fit</span><span class="p">,</span>
        <span class="n">show_progress</span>         <span class="o">=</span> <span class="n">show_progress</span><span class="p">,</span>
        <span class="n">output_file</span>           <span class="o">=</span> <span class="n">output_file</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">results</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="skforecast.model_selection._search.random_search_sarimax" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">skforecast</span><span class="o">.</span><span class="n">model_selection</span><span class="o">.</span><span class="n">_search</span><span class="o">.</span><span class="n">random_search_sarimax</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="p">,</span> <span class="n">param_distributions</span><span class="p">,</span> <span class="n">metric</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_iter</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span> <span class="n">return_best</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">suppress_warnings_fit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">output_file</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#skforecast.model_selection._search.random_search_sarimax" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">

        <p>Random search over specified parameter values or distributions for a Forecaster 
object. Validation is done using time series backtesting.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>forecaster</code></td>
            <td>
                  <code>ForecasterSarimax</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Forecaster model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>y</code></td>
            <td>
                  <code>pandas Series</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training time series.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>cv</code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="skforecast.model_selection._split.TimeSeriesFold" href="#skforecast.model_selection._split.TimeSeriesFold">TimeSeriesFold</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>TimeSeriesFold object with the information needed to split the data into folds.
<strong>New in version 0.14.0</strong></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>param_distributions</code></td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary with parameters names (<code>str</code>) as keys and 
distributions or lists of parameters to try.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>metric</code></td>
            <td>
                  <code>(str, <span title="typing.Callable">Callable</span>, list)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Metric used to quantify the goodness of fit of the model.</p>
<ul>
<li>If <code>string</code>: {'mean_squared_error', 'mean_absolute_error',
'mean_absolute_percentage_error', 'mean_squared_log_error',
'mean_absolute_scaled_error', 'root_mean_squared_scaled_error'}</li>
<li>If <code>Callable</code>: Function with arguments <code>y_true</code>, <code>y_pred</code> and <code>y_train</code>
(Optional) that returns a float.</li>
<li>If <code>list</code>: List containing multiple strings and/or Callables.</li>
</ul>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>exog</code></td>
            <td>
                  <code>pandas Series, pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variable/s included as predictor/s. Must have the same
number of observations as <code>y</code> and should be aligned so that y[i] is
regressed on exog[i].</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>n_iter</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of parameter settings that are sampled. 
n_iter trades off runtime vs quality of the solution.</p>
              </div>
            </td>
            <td>
                  <code>`10`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>random_state</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sets a seed to the random sampling for reproducible output.</p>
              </div>
            </td>
            <td>
                  <code>`123`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>return_best</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Refit the <code>forecaster</code> using the best found parameters on the whole data.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>n_jobs</code></td>
            <td>
                  <code>(int, auto)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of jobs to run in parallel. If <code>-1</code>, then the number of jobs is 
set to the number of cores. If 'auto', <code>n_jobs</code> is set using the function
skforecast.utils.select_n_jobs_backtesting.</p>
              </div>
            </td>
            <td>
                  <code>`&#39;auto&#39;`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>verbose</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Print number of folds used for cv or backtesting.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>suppress_warnings_fit</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, warnings generated during fitting will be ignored.</p>
              </div>
            </td>
            <td>
                  <code>`False`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>show_progress</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to show a progress bar.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>output_file</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specifies the filename or full path where the results should be saved. 
The results will be saved in a tab-separated values (TSV) format. If 
<code>None</code>, the results will not be saved to a file.
<strong>New in version 0.12.0</strong></p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>results</code></td>            <td>
                  <code>pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Results for each combination of parameters.</p>
<ul>
<li>column params: parameters configuration for each iteration.</li>
<li>column metric: metric value estimated for each iteration.</li>
<li>additional n columns with param = value.</li>
</ul>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>skforecast\model_selection\_search.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2182</span>
<span class="normal">2183</span>
<span class="normal">2184</span>
<span class="normal">2185</span>
<span class="normal">2186</span>
<span class="normal">2187</span>
<span class="normal">2188</span>
<span class="normal">2189</span>
<span class="normal">2190</span>
<span class="normal">2191</span>
<span class="normal">2192</span>
<span class="normal">2193</span>
<span class="normal">2194</span>
<span class="normal">2195</span>
<span class="normal">2196</span>
<span class="normal">2197</span>
<span class="normal">2198</span>
<span class="normal">2199</span>
<span class="normal">2200</span>
<span class="normal">2201</span>
<span class="normal">2202</span>
<span class="normal">2203</span>
<span class="normal">2204</span>
<span class="normal">2205</span>
<span class="normal">2206</span>
<span class="normal">2207</span>
<span class="normal">2208</span>
<span class="normal">2209</span>
<span class="normal">2210</span>
<span class="normal">2211</span>
<span class="normal">2212</span>
<span class="normal">2213</span>
<span class="normal">2214</span>
<span class="normal">2215</span>
<span class="normal">2216</span>
<span class="normal">2217</span>
<span class="normal">2218</span>
<span class="normal">2219</span>
<span class="normal">2220</span>
<span class="normal">2221</span>
<span class="normal">2222</span>
<span class="normal">2223</span>
<span class="normal">2224</span>
<span class="normal">2225</span>
<span class="normal">2226</span>
<span class="normal">2227</span>
<span class="normal">2228</span>
<span class="normal">2229</span>
<span class="normal">2230</span>
<span class="normal">2231</span>
<span class="normal">2232</span>
<span class="normal">2233</span>
<span class="normal">2234</span>
<span class="normal">2235</span>
<span class="normal">2236</span>
<span class="normal">2237</span>
<span class="normal">2238</span>
<span class="normal">2239</span>
<span class="normal">2240</span>
<span class="normal">2241</span>
<span class="normal">2242</span>
<span class="normal">2243</span>
<span class="normal">2244</span>
<span class="normal">2245</span>
<span class="normal">2246</span>
<span class="normal">2247</span>
<span class="normal">2248</span>
<span class="normal">2249</span>
<span class="normal">2250</span>
<span class="normal">2251</span>
<span class="normal">2252</span>
<span class="normal">2253</span>
<span class="normal">2254</span>
<span class="normal">2255</span>
<span class="normal">2256</span>
<span class="normal">2257</span>
<span class="normal">2258</span>
<span class="normal">2259</span>
<span class="normal">2260</span>
<span class="normal">2261</span>
<span class="normal">2262</span>
<span class="normal">2263</span>
<span class="normal">2264</span>
<span class="normal">2265</span>
<span class="normal">2266</span>
<span class="normal">2267</span>
<span class="normal">2268</span>
<span class="normal">2269</span>
<span class="normal">2270</span>
<span class="normal">2271</span>
<span class="normal">2272</span>
<span class="normal">2273</span>
<span class="normal">2274</span>
<span class="normal">2275</span>
<span class="normal">2276</span>
<span class="normal">2277</span>
<span class="normal">2278</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">random_search_sarimax</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
    <span class="n">cv</span><span class="p">:</span> <span class="n">TimeSeriesFold</span><span class="p">,</span>
    <span class="n">param_distributions</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="nb">list</span><span class="p">],</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">n_iter</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
    <span class="n">return_best</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">suppress_warnings_fit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">output_file</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Random search over specified parameter values or distributions for a Forecaster </span>
<span class="sd">    object. Validation is done using time series backtesting.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    forecaster : ForecasterSarimax</span>
<span class="sd">        Forecaster model.</span>
<span class="sd">    y : pandas Series</span>
<span class="sd">        Training time series. </span>
<span class="sd">    cv : TimeSeriesFold</span>
<span class="sd">        TimeSeriesFold object with the information needed to split the data into folds.</span>
<span class="sd">        **New in version 0.14.0**</span>
<span class="sd">    param_distributions : dict</span>
<span class="sd">        Dictionary with parameters names (`str`) as keys and </span>
<span class="sd">        distributions or lists of parameters to try.</span>
<span class="sd">    metric : str, Callable, list</span>
<span class="sd">        Metric used to quantify the goodness of fit of the model.</span>

<span class="sd">        - If `string`: {&#39;mean_squared_error&#39;, &#39;mean_absolute_error&#39;,</span>
<span class="sd">        &#39;mean_absolute_percentage_error&#39;, &#39;mean_squared_log_error&#39;,</span>
<span class="sd">        &#39;mean_absolute_scaled_error&#39;, &#39;root_mean_squared_scaled_error&#39;}</span>
<span class="sd">        - If `Callable`: Function with arguments `y_true`, `y_pred` and `y_train`</span>
<span class="sd">        (Optional) that returns a float.</span>
<span class="sd">        - If `list`: List containing multiple strings and/or Callables.</span>
<span class="sd">    exog : pandas Series, pandas DataFrame, default `None`</span>
<span class="sd">        Exogenous variable/s included as predictor/s. Must have the same</span>
<span class="sd">        number of observations as `y` and should be aligned so that y[i] is</span>
<span class="sd">        regressed on exog[i].</span>
<span class="sd">    n_iter : int, default `10`</span>
<span class="sd">        Number of parameter settings that are sampled. </span>
<span class="sd">        n_iter trades off runtime vs quality of the solution.</span>
<span class="sd">    random_state : int, default `123`</span>
<span class="sd">        Sets a seed to the random sampling for reproducible output.</span>
<span class="sd">    return_best : bool, default `True`</span>
<span class="sd">        Refit the `forecaster` using the best found parameters on the whole data.</span>
<span class="sd">    n_jobs : int, &#39;auto&#39;, default `&#39;auto&#39;`</span>
<span class="sd">        The number of jobs to run in parallel. If `-1`, then the number of jobs is </span>
<span class="sd">        set to the number of cores. If &#39;auto&#39;, `n_jobs` is set using the function</span>
<span class="sd">        skforecast.utils.select_n_jobs_backtesting.</span>
<span class="sd">    verbose : bool, default `True`</span>
<span class="sd">        Print number of folds used for cv or backtesting.</span>
<span class="sd">    suppress_warnings_fit : bool, default `False`</span>
<span class="sd">        If `True`, warnings generated during fitting will be ignored.</span>
<span class="sd">    show_progress : bool, default `True`</span>
<span class="sd">        Whether to show a progress bar.</span>
<span class="sd">    output_file : str, default `None`</span>
<span class="sd">        Specifies the filename or full path where the results should be saved. </span>
<span class="sd">        The results will be saved in a tab-separated values (TSV) format. If </span>
<span class="sd">        `None`, the results will not be saved to a file.</span>
<span class="sd">        **New in version 0.12.0**</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    results : pandas DataFrame</span>
<span class="sd">        Results for each combination of parameters.</span>

<span class="sd">        - column params: parameters configuration for each iteration.</span>
<span class="sd">        - column metric: metric value estimated for each iteration.</span>
<span class="sd">        - additional n columns with param = value.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">param_grid</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ParameterSampler</span><span class="p">(</span><span class="n">param_distributions</span><span class="p">,</span> <span class="n">n_iter</span><span class="o">=</span><span class="n">n_iter</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">))</span>

    <span class="n">results</span> <span class="o">=</span> <span class="n">_evaluate_grid_hyperparameters_sarimax</span><span class="p">(</span>
        <span class="n">forecaster</span>            <span class="o">=</span> <span class="n">forecaster</span><span class="p">,</span>
        <span class="n">y</span>                     <span class="o">=</span> <span class="n">y</span><span class="p">,</span>
        <span class="n">cv</span>                    <span class="o">=</span> <span class="n">cv</span><span class="p">,</span>
        <span class="n">param_grid</span>            <span class="o">=</span> <span class="n">param_grid</span><span class="p">,</span>
        <span class="n">metric</span>                <span class="o">=</span> <span class="n">metric</span><span class="p">,</span>
        <span class="n">exog</span>                  <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
        <span class="n">return_best</span>           <span class="o">=</span> <span class="n">return_best</span><span class="p">,</span>
        <span class="n">n_jobs</span>                <span class="o">=</span> <span class="n">n_jobs</span><span class="p">,</span>
        <span class="n">verbose</span>               <span class="o">=</span> <span class="n">verbose</span><span class="p">,</span>
        <span class="n">suppress_warnings_fit</span> <span class="o">=</span> <span class="n">suppress_warnings_fit</span><span class="p">,</span>
        <span class="n">show_progress</span>         <span class="o">=</span> <span class="n">show_progress</span><span class="p">,</span>
        <span class="n">output_file</span>           <span class="o">=</span> <span class="n">output_file</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">results</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="skforecast.model_selection._split.BaseFold" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">skforecast</span><span class="o">.</span><span class="n">model_selection</span><span class="o">.</span><span class="n">_split</span><span class="o">.</span><span class="n">BaseFold</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">initial_train_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">window_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">differentiation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">refit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fixed_train_size</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">gap</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">skip_folds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">allow_incomplete_fold</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_all_indexes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#skforecast.model_selection._split.BaseFold" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">


        <p>Base class for all Fold classes in skforecast. All fold classes should specify
all the parameters that can be set at the class level in their <code>__init__</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>steps</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations used to be predicted in each fold. This is also commonly
referred to as the forecast horizon or test size.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>initial_train_size</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations used for initial training.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>window_size</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations needed to generate the autoregressive predictors.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>differentiation</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations to use for differentiation. This is used to extend the
<code>last_window</code> as many observations as the differentiation order.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>refit</code></td>
            <td>
                  <code>(bool, int)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to refit the forecaster in each fold.</p>
<ul>
<li>If <code>True</code>, the forecaster is refitted in each fold.</li>
<li>If <code>False</code>, the forecaster is trained only in the first fold.</li>
<li>If an integer, the forecaster is trained in the first fold and then refitted
  every <code>refit</code> folds.</li>
</ul>
              </div>
            </td>
            <td>
                  <code>`False`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>fixed_train_size</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the training size is fixed or increases in each fold.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>gap</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations between the end of the training set and the start of the
test set.</p>
              </div>
            </td>
            <td>
                  <code>`0`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>skip_folds</code></td>
            <td>
                  <code>(int, list)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of folds to skip.</p>
<ul>
<li>If an integer, every 'skip_folds'-th is returned.</li>
<li>If a list, the indexes of the folds to skip.</li>
</ul>
<p>For example, if <code>skip_folds=3</code> and there are 10 folds, the returned folds are
0, 3, 6, and 9. If <code>skip_folds=[1, 2, 3]</code>, the returned folds are 0, 4, 5, 6, 7,
8, and 9.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>allow_incomplete_fold</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to allow the last fold to include fewer observations than <code>steps</code>.
If <code>False</code>, the last fold is excluded if it is incomplete.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>return_all_indexes</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to return all indexes or only the start and end indexes of each fold.</p>
              </div>
            </td>
            <td>
                  <code>`False`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>verbose</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to print information about generated folds.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.model_selection._split.BaseFold.steps">steps</span></code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations used to be predicted in each fold. This is also commonly
referred to as the forecast horizon or test size.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.model_selection._split.BaseFold.initial_train_size">initial_train_size</span></code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations used for initial training.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.model_selection._split.BaseFold.window_size">window_size</span></code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations needed to generate the autoregressive predictors.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.model_selection._split.BaseFold.differentiation">differentiation</span></code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations to use for differentiation. This is used to extend the
<code>last_window</code> as many observations as the differentiation order.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.model_selection._split.BaseFold.refit">refit</span></code></td>
            <td>
                  <code>(bool, int)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to refit the forecaster in each fold.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.model_selection._split.BaseFold.fixed_train_size">fixed_train_size</span></code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the training size is fixed or increases in each fold.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.model_selection._split.BaseFold.gap">gap</span></code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations between the end of the training set and the start of the
test set.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.model_selection._split.BaseFold.skip_folds">skip_folds</span></code></td>
            <td>
                  <code>(int, list)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of folds to skip.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.model_selection._split.BaseFold.allow_incomplete_fold">allow_incomplete_fold</span></code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to allow the last fold to include fewer observations than <code>steps</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.model_selection._split.BaseFold.return_all_indexes">return_all_indexes</span></code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to return all indexes or only the start and end indexes of each fold.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.model_selection._split.BaseFold.verbose">verbose</span></code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to print information about generated folds.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

                  <details class="quote">
                    <summary>Source code in <code>skforecast\model_selection\_split.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">steps</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">initial_train_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">window_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">differentiation</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">refit</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">fixed_train_size</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">gap</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">skip_folds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_incomplete_fold</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">return_all_indexes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_validate_params</span><span class="p">(</span>
        <span class="n">cv_name</span>               <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
        <span class="n">steps</span>                 <span class="o">=</span> <span class="n">steps</span><span class="p">,</span>
        <span class="n">initial_train_size</span>    <span class="o">=</span> <span class="n">initial_train_size</span><span class="p">,</span>
        <span class="n">window_size</span>           <span class="o">=</span> <span class="n">window_size</span><span class="p">,</span>
        <span class="n">differentiation</span>       <span class="o">=</span> <span class="n">differentiation</span><span class="p">,</span>
        <span class="n">refit</span>                 <span class="o">=</span> <span class="n">refit</span><span class="p">,</span>
        <span class="n">fixed_train_size</span>      <span class="o">=</span> <span class="n">fixed_train_size</span><span class="p">,</span>
        <span class="n">gap</span>                   <span class="o">=</span> <span class="n">gap</span><span class="p">,</span>
        <span class="n">skip_folds</span>            <span class="o">=</span> <span class="n">skip_folds</span><span class="p">,</span>
        <span class="n">allow_incomplete_fold</span> <span class="o">=</span> <span class="n">allow_incomplete_fold</span><span class="p">,</span>
        <span class="n">return_all_indexes</span>    <span class="o">=</span> <span class="n">return_all_indexes</span><span class="p">,</span>
        <span class="n">verbose</span>               <span class="o">=</span> <span class="n">verbose</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">steps</span>                 <span class="o">=</span> <span class="n">steps</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span>    <span class="o">=</span> <span class="n">initial_train_size</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span>           <span class="o">=</span> <span class="n">window_size</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span>       <span class="o">=</span> <span class="n">differentiation</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">refit</span>                 <span class="o">=</span> <span class="n">refit</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fixed_train_size</span>      <span class="o">=</span> <span class="n">fixed_train_size</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">gap</span>                   <span class="o">=</span> <span class="n">gap</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">skip_folds</span>            <span class="o">=</span> <span class="n">skip_folds</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">allow_incomplete_fold</span> <span class="o">=</span> <span class="n">allow_incomplete_fold</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">return_all_indexes</span>    <span class="o">=</span> <span class="n">return_all_indexes</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span>               <span class="o">=</span> <span class="n">verbose</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="skforecast.model_selection._split.BaseFold._validate_params" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_validate_params</span><span class="p">(</span><span class="n">cv_name</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">initial_train_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">window_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">differentiation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">refit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fixed_train_size</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">gap</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">skip_folds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">allow_incomplete_fold</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_all_indexes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#skforecast.model_selection._split.BaseFold._validate_params" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Validate all input parameters to ensure correctness.</p>

            <details class="quote">
              <summary>Source code in <code>skforecast\model_selection\_split.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">_validate_params</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">cv_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">steps</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">initial_train_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">window_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">differentiation</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">refit</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">fixed_train_size</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">gap</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">skip_folds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_incomplete_fold</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">return_all_indexes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span> 
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Validate all input parameters to ensure correctness.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">cv_name</span> <span class="o">==</span> <span class="s2">&quot;TimeSeriesFold&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">))</span> <span class="ow">or</span> <span class="n">steps</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;`steps` must be an integer greater than 0. Got </span><span class="si">{</span><span class="n">steps</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">initial_train_size</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;`initial_train_size` must be an integer greater than 0 or None. &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="n">initial_train_size</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">initial_train_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">initial_train_size</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;`initial_train_size` must be an integer greater than 0 or None. &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="n">initial_train_size</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">refit</span><span class="p">,</span> <span class="p">(</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;`refit` must be a boolean or an integer equal or greater than 0. &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="n">refit</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">refit</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">))</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">refit</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="ow">and</span> <span class="n">refit</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;`refit` must be a boolean or an integer equal or greater than 0. &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="n">refit</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fixed_train_size</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`fixed_train_size` must be a boolean: `True`, `False`. &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="n">fixed_train_size</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">gap</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">))</span> <span class="ow">or</span> <span class="n">gap</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;`gap` must be an integer greater than or equal to 0. Got </span><span class="si">{</span><span class="n">gap</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">skip_folds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">skip_folds</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`skip_folds` must be an integer greater than 0, a list of &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;integers or `None`. Got </span><span class="si">{</span><span class="n">skip_folds</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">skip_folds</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">))</span> <span class="ow">and</span> <span class="n">skip_folds</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`skip_folds` must be an integer greater than 0, a list of &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;integers or `None`. Got </span><span class="si">{</span><span class="n">skip_folds</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">skip_folds</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">any</span><span class="p">([</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">skip_folds</span><span class="p">]):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`skip_folds` list must contain integers greater than or &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;equal to 1. The first fold is always needed to train the &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;forecaster. Got </span><span class="si">{</span><span class="n">skip_folds</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
                <span class="p">)</span> 
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">allow_incomplete_fold</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`allow_incomplete_fold` must be a boolean: `True`, `False`. &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="n">allow_incomplete_fold</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="p">)</span>

    <span class="k">if</span> <span class="n">cv_name</span> <span class="o">==</span> <span class="s2">&quot;OneStepAheadFold&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">initial_train_size</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">))</span>
            <span class="ow">or</span> <span class="n">initial_train_size</span> <span class="o">&lt;</span> <span class="mi">1</span>
        <span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;`initial_train_size` must be an integer greater than 0. &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="n">initial_train_size</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span>
        <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">window_size</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DateOffset</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)))</span>
        <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">window_size</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">))</span>
        <span class="ow">and</span> <span class="n">window_size</span> <span class="o">&lt;</span> <span class="mi">1</span>
    <span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;`window_size` must be an integer greater than 0. Got </span><span class="si">{</span><span class="n">window_size</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">return_all_indexes</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`return_all_indexes` must be a boolean: `True`, `False`. &quot;</span>
             <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="n">return_all_indexes</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="n">differentiation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">differentiation</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">))</span> <span class="ow">or</span> <span class="n">differentiation</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`differentiation` must be None or an integer greater than or &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;equal to 0. Got </span><span class="si">{</span><span class="n">differentiation</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">verbose</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`verbose` must be a boolean: `True`, `False`. &quot;</span>
             <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="n">verbose</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="skforecast.model_selection._split.BaseFold._extract_index" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_extract_index</span><span class="p">(</span><span class="n">X</span><span class="p">)</span></code>

<a href="#skforecast.model_selection._split.BaseFold._extract_index" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Extracts and returns the index from the input data X.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>X</code></td>
            <td>
                  <code>pandas Series, pandas DataFrame, pandas Index, dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time series data or index to split.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>idx</code></td>            <td>
                  <code>pandas Index</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Index extracted from the input data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>skforecast\model_selection\_split.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">_extract_index</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">X</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extracts and returns the index from the input data X.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    X : pandas Series, pandas DataFrame, pandas Index, dict</span>
<span class="sd">        Time series data or index to split.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    idx : pandas Index</span>
<span class="sd">        Index extracted from the input data.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)):</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">index</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">freqs</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">freq</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">X</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">freq</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">freqs</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;At least one series must have a frequency.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">f</span> <span class="o">==</span> <span class="n">freqs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">freqs</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;All series with frequency must have the same frequency.&quot;</span>
            <span class="p">)</span>
        <span class="n">min_idx</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span><span class="n">v</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">X</span><span class="o">.</span><span class="n">values</span><span class="p">()])</span>
        <span class="n">max_idx</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">v</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">X</span><span class="o">.</span><span class="n">values</span><span class="p">()])</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="n">min_idx</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">max_idx</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="n">freqs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">X</span>

    <span class="k">return</span> <span class="n">idx</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="skforecast.model_selection._split.BaseFold.set_params" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_params</span><span class="p">(</span><span class="n">params</span><span class="p">)</span></code>

<a href="#skforecast.model_selection._split.BaseFold.set_params" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Set the parameters of the TimeSeriesFold object. Before overwriting the
current parameters, the input parameters are validated to ensure correctness.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>params</code></td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary with the parameters to set.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>skforecast\model_selection\_split.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_params</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> 
    <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set the parameters of the TimeSeriesFold object. Before overwriting the</span>
<span class="sd">    current parameters, the input parameters are validated to ensure correctness.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    params : dict</span>
<span class="sd">        Dictionary with the parameters to set.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;`params` must be a dictionary. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">params</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>

    <span class="n">current_params</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
    <span class="n">unknown_params</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">current_params</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="k">if</span> <span class="n">unknown_params</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Unknown parameters: </span><span class="si">{</span><span class="n">unknown_params</span><span class="si">}</span><span class="s2">. They have been ignored.&quot;</span><span class="p">,</span>
            <span class="n">IgnoredArgumentWarning</span>
        <span class="p">)</span>
    <span class="n">updated_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;cv_name&#39;</span><span class="p">:</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="o">**</span><span class="n">current_params</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_validate_params</span><span class="p">(</span><span class="o">**</span><span class="n">updated_params</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">updated_params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="skforecast.model_selection._split.TimeSeriesFold" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">skforecast</span><span class="o">.</span><span class="n">model_selection</span><span class="o">.</span><span class="n">_split</span><span class="o">.</span><span class="n">TimeSeriesFold</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="n">initial_train_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">window_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">differentiation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">refit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fixed_train_size</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">gap</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">skip_folds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">allow_incomplete_fold</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_all_indexes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#skforecast.model_selection._split.TimeSeriesFold" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="skforecast.model_selection._split.BaseFold" href="#skforecast.model_selection._split.BaseFold">BaseFold</a></code></p>


        <p>Class to split time series data into train and test folds. 
When used within a backtesting or hyperparameter search, the arguments
'initial_train_size', 'window_size' and 'differentiation' are not required
as they are automatically set by the backtesting or hyperparameter search
functions.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>steps</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations used to be predicted in each fold. This is also commonly
referred to as the forecast horizon or test size.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>initial_train_size</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations used for initial training. If <code>None</code> or 0, the initial
forecaster is not trained in the first fold.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>window_size</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations needed to generate the autoregressive predictors.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>differentiation</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations to use for differentiation. This is used to extend the
<code>last_window</code> as many observations as the differentiation order.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>refit</code></td>
            <td>
                  <code>(bool, int)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to refit the forecaster in each fold.</p>
<ul>
<li>If <code>True</code>, the forecaster is refitted in each fold.</li>
<li>If <code>False</code>, the forecaster is trained only in the first fold.</li>
<li>If an integer, the forecaster is trained in the first fold and then refitted
  every <code>refit</code> folds.</li>
</ul>
              </div>
            </td>
            <td>
                  <code>`False`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>fixed_train_size</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the training size is fixed or increases in each fold.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>gap</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations between the end of the training set and the start of the
test set.</p>
              </div>
            </td>
            <td>
                  <code>`0`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>skip_folds</code></td>
            <td>
                  <code>(int, list)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of folds to skip.</p>
<ul>
<li>If an integer, every 'skip_folds'-th is returned.</li>
<li>If a list, the indexes of the folds to skip.</li>
</ul>
<p>For example, if <code>skip_folds=3</code> and there are 10 folds, the returned folds are
0, 3, 6, and 9. If <code>skip_folds=[1, 2, 3]</code>, the returned folds are 0, 4, 5, 6, 7,
8, and 9.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>allow_incomplete_fold</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to allow the last fold to include fewer observations than <code>steps</code>.
If <code>False</code>, the last fold is excluded if it is incomplete.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>return_all_indexes</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to return all indexes or only the start and end indexes of each fold.</p>
              </div>
            </td>
            <td>
                  <code>`False`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>verbose</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to print information about generated folds.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.model_selection._split.TimeSeriesFold.steps">steps</span></code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations used to be predicted in each fold. This is also commonly
referred to as the forecast horizon or test size.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.model_selection._split.TimeSeriesFold.initial_train_size">initial_train_size</span></code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations used for initial training. If <code>None</code> or 0, the initial
forecaster is not trained in the first fold.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.model_selection._split.TimeSeriesFold.window_size">window_size</span></code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations needed to generate the autoregressive predictors.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.model_selection._split.TimeSeriesFold.differentiation">differentiation</span></code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations to use for differentiation. This is used to extend the
<code>last_window</code> as many observations as the differentiation order.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.model_selection._split.TimeSeriesFold.refit">refit</span></code></td>
            <td>
                  <code>(bool, int)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to refit the forecaster in each fold.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.model_selection._split.TimeSeriesFold.fixed_train_size">fixed_train_size</span></code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the training size is fixed or increases in each fold.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.model_selection._split.TimeSeriesFold.gap">gap</span></code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations between the end of the training set and the start of the
test set.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.model_selection._split.TimeSeriesFold.skip_folds">skip_folds</span></code></td>
            <td>
                  <code>(int, list)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of folds to skip.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.model_selection._split.TimeSeriesFold.allow_incomplete_fold">allow_incomplete_fold</span></code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to allow the last fold to include fewer observations than <code>steps</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.model_selection._split.TimeSeriesFold.return_all_indexes">return_all_indexes</span></code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to return all indexes or only the start and end indexes of each fold.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.model_selection._split.TimeSeriesFold.verbose">verbose</span></code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to print information about generated folds.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <p>Returned values are the positions of the observations and not the actual values of
the index, so they can be used to slice the data directly using iloc. For example,
if the input series is <code>X = [10, 11, 12, 13, 14, 15, 16, 17, 18, 19]</code>, the 
<code>initial_train_size = 3</code>, <code>window_size = 2</code>, <code>steps = 4</code>, and <code>gap = 1</code>,
the output of the first fold will: [[0, 3], [1, 3], [3, 8], [4, 8], True].</p>
<p>The first list <code>[0, 3]</code> indicates that the training set goes from the first to the
third observation. The second list <code>[1, 3]</code> indicates that the last window seen by
the forecaster during training goes from the second to the third observation. The
third list <code>[3, 8]</code> indicates that the test set goes from the fourth to the eighth
observation. The fourth list <code>[4, 8]</code> indicates that the test set including the gap
goes from the fifth to the eighth observation. The boolean <code>False</code> indicates that the
forecaster should not be trained in this fold.</p>
<p>Following the python convention, the start index is inclusive and the end index is
exclusive. This means that the last index is not included in the slice.</p>
</details>
                  <details class="quote">
                    <summary>Source code in <code>skforecast\model_selection\_split.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">initial_train_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">window_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">differentiation</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">refit</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">fixed_train_size</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">gap</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">skip_folds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_incomplete_fold</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">return_all_indexes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">steps</span>                 <span class="o">=</span> <span class="n">steps</span><span class="p">,</span>
        <span class="n">initial_train_size</span>    <span class="o">=</span> <span class="n">initial_train_size</span><span class="p">,</span>
        <span class="n">window_size</span>           <span class="o">=</span> <span class="n">window_size</span><span class="p">,</span>
        <span class="n">differentiation</span>       <span class="o">=</span> <span class="n">differentiation</span><span class="p">,</span>
        <span class="n">refit</span>                 <span class="o">=</span> <span class="n">refit</span><span class="p">,</span>
        <span class="n">fixed_train_size</span>      <span class="o">=</span> <span class="n">fixed_train_size</span><span class="p">,</span>
        <span class="n">gap</span>                   <span class="o">=</span> <span class="n">gap</span><span class="p">,</span>
        <span class="n">skip_folds</span>            <span class="o">=</span> <span class="n">skip_folds</span><span class="p">,</span>
        <span class="n">allow_incomplete_fold</span> <span class="o">=</span> <span class="n">allow_incomplete_fold</span><span class="p">,</span>
        <span class="n">return_all_indexes</span>    <span class="o">=</span> <span class="n">return_all_indexes</span><span class="p">,</span>
        <span class="n">verbose</span>               <span class="o">=</span> <span class="n">verbose</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="skforecast.model_selection._split.TimeSeriesFold.split" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">as_pandas</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#skforecast.model_selection._split.TimeSeriesFold.split" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Split the time series data into train and test folds.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>X</code></td>
            <td>
                  <code>pandas Series, pandas DataFrame, pandas Index, dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time series data or index to split.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>as_pandas</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, the folds are returned as a DataFrame. This is useful to visualize
the folds in a more interpretable way.</p>
              </div>
            </td>
            <td>
                  <code>`False`</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>folds</code></td>            <td>
                  <code>list, pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of lists containing the indices (position) for for each fold. Each list
contains 4 lists and a boolean with the following information:</p>
<ul>
<li>[train_start, train_end]: list with the start and end positions of the
training set.</li>
<li>[last_window_start, last_window_end]: list with the start and end positions
of the last window seen by the forecaster during training. The last window
is used to generate the lags use as predictors. If <code>differentiation</code> is
included, the interval is extended as many observations as the
differentiation order. If the argument <code>window_size</code> is <code>None</code>, this list is
empty.</li>
<li>[test_start, test_end]: list with the start and end positions of the test
set. These are the observations used to evaluate the forecaster.</li>
<li>[test_start_with_gap, test_end_with_gap]: list with the start and end
positions of the test set including the gap. The gap is the number of
observations between the end of the training set and the start of the test
set.</li>
<li>fit_forecaster: boolean indicating whether the forecaster should be fitted
in this fold.</li>
</ul>
<p>It is important to note that the returned values are the positions of the
observations and not the actual values of the index, so they can be used to
slice the data directly using iloc.</p>
<p>If <code>as_pandas</code> is <code>True</code>, the folds are returned as a DataFrame with the
following columns: 'fold', 'train_start', 'train_end', 'last_window_start',
'last_window_end', 'test_start', 'test_end', 'test_start_with_gap',
'test_end_with_gap', 'fit_forecaster'.</p>
<p>Following the python convention, the start index is inclusive and the end
index is exclusive. This means that the last index is not included in the
slice.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>skforecast\model_selection\_split.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">split</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">X</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span> <span class="nb">dict</span><span class="p">],</span>
    <span class="n">as_pandas</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Split the time series data into train and test folds.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    X : pandas Series, pandas DataFrame, pandas Index, dict</span>
<span class="sd">        Time series data or index to split.</span>
<span class="sd">    as_pandas : bool, default `False`</span>
<span class="sd">        If True, the folds are returned as a DataFrame. This is useful to visualize</span>
<span class="sd">        the folds in a more interpretable way.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    folds : list, pandas DataFrame</span>
<span class="sd">        A list of lists containing the indices (position) for for each fold. Each list</span>
<span class="sd">        contains 4 lists and a boolean with the following information:</span>

<span class="sd">        - [train_start, train_end]: list with the start and end positions of the</span>
<span class="sd">        training set.</span>
<span class="sd">        - [last_window_start, last_window_end]: list with the start and end positions</span>
<span class="sd">        of the last window seen by the forecaster during training. The last window</span>
<span class="sd">        is used to generate the lags use as predictors. If `differentiation` is</span>
<span class="sd">        included, the interval is extended as many observations as the</span>
<span class="sd">        differentiation order. If the argument `window_size` is `None`, this list is</span>
<span class="sd">        empty.</span>
<span class="sd">        - [test_start, test_end]: list with the start and end positions of the test</span>
<span class="sd">        set. These are the observations used to evaluate the forecaster.</span>
<span class="sd">        - [test_start_with_gap, test_end_with_gap]: list with the start and end</span>
<span class="sd">        positions of the test set including the gap. The gap is the number of</span>
<span class="sd">        observations between the end of the training set and the start of the test</span>
<span class="sd">        set.</span>
<span class="sd">        - fit_forecaster: boolean indicating whether the forecaster should be fitted</span>
<span class="sd">        in this fold.</span>

<span class="sd">        It is important to note that the returned values are the positions of the</span>
<span class="sd">        observations and not the actual values of the index, so they can be used to</span>
<span class="sd">        slice the data directly using iloc.</span>

<span class="sd">        If `as_pandas` is `True`, the folds are returned as a DataFrame with the</span>
<span class="sd">        following columns: &#39;fold&#39;, &#39;train_start&#39;, &#39;train_end&#39;, &#39;last_window_start&#39;,</span>
<span class="sd">        &#39;last_window_end&#39;, &#39;test_start&#39;, &#39;test_end&#39;, &#39;test_start_with_gap&#39;,</span>
<span class="sd">        &#39;test_end_with_gap&#39;, &#39;fit_forecaster&#39;.</span>

<span class="sd">        Following the python convention, the start index is inclusive and the end</span>
<span class="sd">        index is exclusive. This means that the last index is not included in the</span>
<span class="sd">        slice.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;X must be a pandas Series, DataFrame, Index or a dictionary. &quot;</span>
             <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">tseries</span><span class="o">.</span><span class="n">offsets</span><span class="o">.</span><span class="n">DateOffset</span><span class="p">):</span>
        <span class="c1"># Calculate the window_size in steps. This is not a exact calculation</span>
        <span class="c1"># because the offset follows the calendar rules and the distance between</span>
        <span class="c1"># two dates may not be constant.</span>
        <span class="n">first_valid_index</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">window_size_idx_start</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="n">first_valid_index</span><span class="p">)</span>
            <span class="n">window_size_idx_end</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="o">=</span> <span class="n">window_size_idx_end</span> <span class="o">-</span> <span class="n">window_size_idx_start</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;The length of `X` (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="si">}</span><span class="s2">), must be greater than or equal &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;to the window size (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2">). Try to decrease the &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;size of the offset (forecaster.offset), or increase the &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;size of `y`.&quot;</span>
            <span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;To use split method when `initial_train_size` is None, &quot;</span>
                <span class="s2">&quot;`window_size` must be an integer greater than 0. &quot;</span>
                <span class="s2">&quot;Although no initial training is done and all data is used to &quot;</span>
                <span class="s2">&quot;evaluate the model, the first `window_size` observations are &quot;</span>
                <span class="s2">&quot;needed to create the initial predictors. Got `window_size` = None.&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">refit</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;`refit` is only allowed when `initial_train_size` is not `None`. &quot;</span>
                <span class="s2">&quot;Set `refit` to `False` if you want to use `initial_train_size = None`.&quot;</span>
            <span class="p">)</span>
        <span class="n">externally_fitted</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span>  <span class="c1"># Reset to None later</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;Last window cannot be calculated because `window_size` is None.&quot;</span>
            <span class="p">)</span>
        <span class="n">externally_fitted</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extract_index</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">))</span>
    <span class="n">folds</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">last_fold_excluded</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The time series must have at least `initial_train_size + steps` &quot;</span>
             <span class="sa">f</span><span class="s2">&quot;observations. Got </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="si">}</span><span class="s2"> observations.&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">+</span> <span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">gap</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">):</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">refit</span><span class="p">:</span>
            <span class="c1"># If `fixed_train_size` the train size doesn&#39;t increase but moves by </span>
            <span class="c1"># `steps` positions in each iteration. If `False`, the train size</span>
            <span class="c1"># increases by `steps` in each iteration.</span>
            <span class="n">train_iloc_start</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fixed_train_size</span> <span class="k">else</span> <span class="mi">0</span>
            <span class="n">train_iloc_end</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="p">)</span>
            <span class="n">test_iloc_start</span> <span class="o">=</span> <span class="n">train_iloc_end</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># The train size doesn&#39;t increase and doesn&#39;t move.</span>
            <span class="n">train_iloc_start</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">train_iloc_end</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span>
            <span class="n">test_iloc_start</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">last_window_iloc_start</span> <span class="o">=</span> <span class="n">test_iloc_start</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span>
        <span class="n">test_iloc_end</span> <span class="o">=</span> <span class="n">test_iloc_start</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">gap</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps</span>

        <span class="n">partitions</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">idx</span><span class="p">[</span><span class="n">train_iloc_start</span> <span class="p">:</span> <span class="n">train_iloc_end</span><span class="p">],</span>
            <span class="n">idx</span><span class="p">[</span><span class="n">last_window_iloc_start</span> <span class="p">:</span> <span class="n">test_iloc_start</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[],</span>
            <span class="n">idx</span><span class="p">[</span><span class="n">test_iloc_start</span> <span class="p">:</span> <span class="n">test_iloc_end</span><span class="p">],</span>
            <span class="n">idx</span><span class="p">[</span><span class="n">test_iloc_start</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">gap</span> <span class="p">:</span> <span class="n">test_iloc_end</span><span class="p">]</span>
        <span class="p">]</span>
        <span class="n">folds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">partitions</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_incomplete_fold</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="p">:</span>
        <span class="n">folds</span> <span class="o">=</span> <span class="n">folds</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">last_fold_excluded</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="c1"># Replace partitions inside folds with length 0 with `None`</span>
    <span class="n">folds</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="n">partition</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">partition</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">partition</span> <span class="ow">in</span> <span class="n">fold</span><span class="p">]</span> 
         <span class="k">for</span> <span class="n">fold</span> <span class="ow">in</span> <span class="n">folds</span>
    <span class="p">]</span>

    <span class="c1"># Create a flag to know whether to train the forecaster</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">refit</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refit</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">refit</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="n">fit_forecaster</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">refit</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">)</span>
        <span class="n">fit_forecaster</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fit_forecaster</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">fit_forecaster</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">refit</span><span class="p">):</span> 
            <span class="n">fit_forecaster</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">)):</span> 
        <span class="n">folds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fit_forecaster</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">fit_forecaster</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">folds</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">folds</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">index_to_skip</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_folds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">skip_folds</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">))</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_folds</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">index_to_keep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_folds</span><span class="p">)</span>
            <span class="n">index_to_skip</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">setdiff1d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">)),</span> <span class="n">index_to_keep</span><span class="p">,</span> <span class="n">assume_unique</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">index_to_skip</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">index_to_skip</span><span class="p">]</span>  <span class="c1"># Required since numpy 2.0</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">skip_folds</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">index_to_skip</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_folds</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">)]</span>        

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_print_info</span><span class="p">(</span>
            <span class="n">index</span>              <span class="o">=</span> <span class="n">index</span><span class="p">,</span>
            <span class="n">folds</span>              <span class="o">=</span> <span class="n">folds</span><span class="p">,</span>
            <span class="n">externally_fitted</span>  <span class="o">=</span> <span class="n">externally_fitted</span><span class="p">,</span>
            <span class="n">last_fold_excluded</span> <span class="o">=</span> <span class="n">last_fold_excluded</span><span class="p">,</span>
            <span class="n">index_to_skip</span>      <span class="o">=</span> <span class="n">index_to_skip</span>
        <span class="p">)</span>

    <span class="n">folds</span> <span class="o">=</span> <span class="p">[</span><span class="n">fold</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">fold</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">folds</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">index_to_skip</span><span class="p">]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_all_indexes</span><span class="p">:</span>
        <span class="c1"># +1 to prevent iloc pandas from deleting the last observation</span>
        <span class="n">folds</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">[[</span><span class="n">fold</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">fold</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> 
             <span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[],</span>
             <span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">fold</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span>
             <span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">fold</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span>
             <span class="n">fold</span><span class="p">[</span><span class="mi">4</span><span class="p">]]</span> 
            <span class="k">for</span> <span class="n">fold</span> <span class="ow">in</span> <span class="n">folds</span>
        <span class="p">]</span>

    <span class="k">if</span> <span class="n">externally_fitted</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">folds</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">if</span> <span class="n">as_pandas</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">fold</span> <span class="ow">in</span> <span class="n">folds</span><span class="p">:</span>
                <span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_all_indexes</span><span class="p">:</span>
            <span class="n">folds</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
                <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">fold</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span> <span class="o">+</span> <span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="k">for</span> <span class="n">fold</span> <span class="ow">in</span> <span class="n">folds</span><span class="p">],</span>
                <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="s1">&#39;train_start&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;train_end&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;last_window_start&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;last_window_end&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;test_start&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;test_end&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;test_start_with_gap&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;test_end_with_gap&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;fit_forecaster&#39;</span>
                <span class="p">],</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">folds</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">folds</span><span class="p">,</span>
                <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="s1">&#39;train_index&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;last_window_index&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;test_index&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;test_index_with_gap&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;fit_forecaster&#39;</span>
                <span class="p">],</span>
            <span class="p">)</span>
        <span class="n">folds</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;fold&#39;</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">)))</span>

    <span class="k">return</span> <span class="n">folds</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="skforecast.model_selection._split.TimeSeriesFold._print_info" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_print_info</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">folds</span><span class="p">,</span> <span class="n">externally_fitted</span><span class="p">,</span> <span class="n">last_fold_excluded</span><span class="p">,</span> <span class="n">index_to_skip</span><span class="p">)</span></code>

<a href="#skforecast.model_selection._split.TimeSeriesFold._print_info" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Print information about folds.</p>

            <details class="quote">
              <summary>Source code in <code>skforecast\model_selection\_split.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">_print_info</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">index</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span>
    <span class="n">folds</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
    <span class="n">externally_fitted</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">last_fold_excluded</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">index_to_skip</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Print information about folds.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Information of folds&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--------------------&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">externally_fitted</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;An already trained forecaster is to be used. Window size: &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Initial training size is 0. Window size: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Number of observations used for initial training: &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Number of observations used for initial training: &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    First </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span><span class="si">}</span><span class="s2"> observation/s in training sets &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;are used for differentiation&quot;</span>
            <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Number of observations used for backtesting: &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Number of folds: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;    Number skipped folds: &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">index_to_skip</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">index_to_skip</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">index_to_skip</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Number of steps per fold: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;    Number of steps to exclude from the end of each train set &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;before test (gap): </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">gap</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">last_fold_excluded</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    Last fold has been excluded because it was incomplete.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Last fold only includes </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span><span class="si">}</span><span class="s2"> observations.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">differentiation</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">differentiation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">fold</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">folds</span><span class="p">):</span>
        <span class="n">is_fold_skipped</span>   <span class="o">=</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">index_to_skip</span>
        <span class="n">has_training</span>      <span class="o">=</span> <span class="n">fold</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">True</span>
        <span class="n">training_start</span>    <span class="o">=</span> <span class="p">(</span>
            <span class="n">index</span><span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">differentiation</span><span class="p">]</span> <span class="k">if</span> <span class="n">fold</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="p">)</span>
        <span class="n">training_end</span>      <span class="o">=</span> <span class="n">index</span><span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="k">if</span> <span class="n">fold</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="n">training_length</span>   <span class="o">=</span> <span class="p">(</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">fold</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="n">differentiation</span> <span class="k">if</span> <span class="n">fold</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="p">)</span>
        <span class="n">validation_start</span>  <span class="o">=</span> <span class="n">index</span><span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>
        <span class="n">validation_end</span>    <span class="o">=</span> <span class="n">index</span><span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
        <span class="n">validation_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fold</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fold: </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">is_fold_skipped</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    Fold skipped&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">externally_fitted</span> <span class="ow">and</span> <span class="n">has_training</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;    Training:   </span><span class="si">{</span><span class="n">training_start</span><span class="si">}</span><span class="s2"> -- </span><span class="si">{</span><span class="n">training_end</span><span class="si">}</span><span class="s2">  &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;(n=</span><span class="si">{</span><span class="n">training_length</span><span class="si">}</span><span class="s2">)&quot;</span>
            <span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;    Validation: </span><span class="si">{</span><span class="n">validation_start</span><span class="si">}</span><span class="s2"> -- </span><span class="si">{</span><span class="n">validation_end</span><span class="si">}</span><span class="s2">  &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;(n=</span><span class="si">{</span><span class="n">validation_length</span><span class="si">}</span><span class="s2">)&quot;</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    Training:   No training in this fold&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;    Validation: </span><span class="si">{</span><span class="n">validation_start</span><span class="si">}</span><span class="s2"> -- </span><span class="si">{</span><span class="n">validation_end</span><span class="si">}</span><span class="s2">  &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;(n=</span><span class="si">{</span><span class="n">validation_length</span><span class="si">}</span><span class="s2">)&quot;</span>
            <span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="skforecast.model_selection._split.OneStepAheadFold" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">skforecast</span><span class="o">.</span><span class="n">model_selection</span><span class="o">.</span><span class="n">_split</span><span class="o">.</span><span class="n">OneStepAheadFold</span><span class="p">(</span><span class="n">initial_train_size</span><span class="p">,</span> <span class="n">window_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">differentiation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_all_indexes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#skforecast.model_selection._split.OneStepAheadFold" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="skforecast.model_selection._split.BaseFold" href="#skforecast.model_selection._split.BaseFold">BaseFold</a></code></p>


        <p>Class to split time series data into train and test folds for one-step-ahead
forecasting.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>initial_train_size</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations used for initial training.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>window_size</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations needed to generate the autoregressive predictors.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>differentiation</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations to use for differentiation. This is used to extend the
<code>last_window</code> as many observations as the differentiation order.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>return_all_indexes</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to return all indexes or only the start and end indexes of each fold.</p>
              </div>
            </td>
            <td>
                  <code>`False`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>verbose</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to print information about generated folds.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.model_selection._split.OneStepAheadFold.initial_train_size">initial_train_size</span></code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations used for initial training.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.model_selection._split.OneStepAheadFold.window_size">window_size</span></code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations needed to generate the autoregressive predictors.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.model_selection._split.OneStepAheadFold.differentiation">differentiation</span></code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations to use for differentiation. This is used to extend the
<code>last_window</code> as many observations as the differentiation order.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.model_selection._split.OneStepAheadFold.return_all_indexes">return_all_indexes</span></code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to return all indexes or only the start and end indexes of each fold.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.model_selection._split.OneStepAheadFold.verbose">verbose</span></code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to print information about generated folds.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.model_selection._split.OneStepAheadFold.steps">steps</span></code></td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>This attribute is not used in this class. It is included for API consistency.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.model_selection._split.OneStepAheadFold.fixed_train_size">fixed_train_size</span></code></td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>This attribute is not used in this class. It is included for API consistency.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.model_selection._split.OneStepAheadFold.gap">gap</span></code></td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>This attribute is not used in this class. It is included for API consistency.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.model_selection._split.OneStepAheadFold.skip_folds">skip_folds</span></code></td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>This attribute is not used in this class. It is included for API consistency.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.model_selection._split.OneStepAheadFold.allow_incomplete_fold">allow_incomplete_fold</span></code></td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>This attribute is not used in this class. It is included for API consistency.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.model_selection._split.OneStepAheadFold.refit">refit</span></code></td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>This attribute is not used in this class. It is included for API consistency.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

                  <details class="quote">
                    <summary>Source code in <code>skforecast\model_selection\_split.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">initial_train_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">window_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">differentiation</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">return_all_indexes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">initial_train_size</span> <span class="o">=</span> <span class="n">initial_train_size</span><span class="p">,</span>
        <span class="n">window_size</span>        <span class="o">=</span> <span class="n">window_size</span><span class="p">,</span>
        <span class="n">differentiation</span>    <span class="o">=</span> <span class="n">differentiation</span><span class="p">,</span>
        <span class="n">return_all_indexes</span> <span class="o">=</span> <span class="n">return_all_indexes</span><span class="p">,</span>
        <span class="n">verbose</span>            <span class="o">=</span> <span class="n">verbose</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="skforecast.model_selection._split.OneStepAheadFold.split" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">as_pandas</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">externally_fitted</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#skforecast.model_selection._split.OneStepAheadFold.split" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Split the time series data into train and test folds.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>X</code></td>
            <td>
                  <code>pandas Series, DataFrame, Index, or dictionary</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time series data or index to split.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>as_pandas</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, the folds are returned as a DataFrame. This is useful to visualize
the folds in a more interpretable way.</p>
              </div>
            </td>
            <td>
                  <code>`False`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>externally_fitted</code></td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>This argument is not used in this class. It is included for API consistency.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>fold</code></td>            <td>
                  <code>list, pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of lists containing the indices (position) for for each fold. Each list
contains 2 lists the following information:</p>
<ul>
<li>[train_start, train_end]: list with the start and end positions of the
training set.</li>
<li>[test_start, test_end]: list with the start and end positions of the test
set. These are the observations used to evaluate the forecaster.</li>
</ul>
<p>It is important to note that the returned values are the positions of the
observations and not the actual values of the index, so they can be used to
slice the data directly using iloc.</p>
<p>If <code>as_pandas</code> is <code>True</code>, the folds are returned as a DataFrame with the
following columns: 'fold', 'train_start', 'train_end', 'test_start', 'test_end'.</p>
<p>Following the python convention, the start index is inclusive and the end
index is exclusive. This means that the last index is not included in the
slice.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>skforecast\model_selection\_split.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">split</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">X</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span> <span class="nb">dict</span><span class="p">],</span>
    <span class="n">as_pandas</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">externally_fitted</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Split the time series data into train and test folds.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    X : pandas Series, DataFrame, Index, or dictionary</span>
<span class="sd">        Time series data or index to split.</span>
<span class="sd">    as_pandas : bool, default `False`</span>
<span class="sd">        If True, the folds are returned as a DataFrame. This is useful to visualize</span>
<span class="sd">        the folds in a more interpretable way.</span>
<span class="sd">    externally_fitted : Any</span>
<span class="sd">        This argument is not used in this class. It is included for API consistency.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fold : list, pandas DataFrame</span>
<span class="sd">        A list of lists containing the indices (position) for for each fold. Each list</span>
<span class="sd">        contains 2 lists the following information:</span>

<span class="sd">        - [train_start, train_end]: list with the start and end positions of the</span>
<span class="sd">        training set.</span>
<span class="sd">        - [test_start, test_end]: list with the start and end positions of the test</span>
<span class="sd">        set. These are the observations used to evaluate the forecaster.</span>

<span class="sd">        It is important to note that the returned values are the positions of the</span>
<span class="sd">        observations and not the actual values of the index, so they can be used to</span>
<span class="sd">        slice the data directly using iloc.</span>

<span class="sd">        If `as_pandas` is `True`, the folds are returned as a DataFrame with the</span>
<span class="sd">        following columns: &#39;fold&#39;, &#39;train_start&#39;, &#39;train_end&#39;, &#39;test_start&#39;, &#39;test_end&#39;.</span>

<span class="sd">        Following the python convention, the start index is inclusive and the end</span>
<span class="sd">        index is exclusive. This means that the last index is not included in the</span>
<span class="sd">        slice.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;X must be a pandas Series, DataFrame, Index or a dictionary. &quot;</span>
             <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extract_index</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">fold</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="p">],</span>
        <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)],</span>
        <span class="kc">True</span>
    <span class="p">]</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_print_info</span><span class="p">(</span>
            <span class="n">index</span> <span class="o">=</span> <span class="n">index</span><span class="p">,</span>
            <span class="n">fold</span> <span class="o">=</span> <span class="n">fold</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_all_indexes</span><span class="p">:</span>
        <span class="n">fold</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">[</span><span class="nb">range</span><span class="p">(</span><span class="n">fold</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">fold</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])],</span>
            <span class="p">[</span><span class="nb">range</span><span class="p">(</span><span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])],</span>
            <span class="n">fold</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="p">]</span>

    <span class="k">if</span> <span class="n">as_pandas</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_all_indexes</span><span class="p">:</span>
            <span class="n">fold</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
                <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">fold</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span> <span class="o">+</span> <span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]],</span>
                <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="s1">&#39;train_start&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;train_end&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;test_start&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;test_end&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;fit_forecaster&#39;</span>
                <span class="p">],</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fold</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
                <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">fold</span><span class="p">],</span>
                <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="s1">&#39;train_index&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;test_index&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;fit_forecaster&#39;</span>
                <span class="p">],</span>
            <span class="p">)</span>
        <span class="n">fold</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;fold&#39;</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fold</span><span class="p">)))</span>

    <span class="k">return</span> <span class="n">fold</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="skforecast.model_selection._split.OneStepAheadFold._print_info" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_print_info</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">fold</span><span class="p">)</span></code>

<a href="#skforecast.model_selection._split.OneStepAheadFold._print_info" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Print information about folds.</p>

            <details class="quote">
              <summary>Source code in <code>skforecast\model_selection\_split.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">_print_info</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">index</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span>
    <span class="n">fold</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Print information about folds.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">differentiation</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">differentiation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span>

    <span class="n">initial_train_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">-</span> <span class="n">differentiation</span>
    <span class="n">test_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">initial_train_size</span> <span class="o">+</span> <span class="n">differentiation</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Information of folds&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--------------------&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Number of observations in train: </span><span class="si">{</span><span class="n">initial_train_size</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;    First </span><span class="si">{</span><span class="n">differentiation</span><span class="si">}</span><span class="s2"> observation/s in training set &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;are used for differentiation&quot;</span>
        <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Number of observations in test: </span><span class="si">{</span><span class="n">test_length</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>

    <span class="n">training_start</span> <span class="o">=</span> <span class="n">index</span><span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">differentiation</span><span class="p">]</span>
    <span class="n">training_end</span> <span class="o">=</span> <span class="n">index</span><span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
    <span class="n">test_start</span>  <span class="o">=</span> <span class="n">index</span><span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>
    <span class="n">test_end</span>    <span class="o">=</span> <span class="n">index</span><span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>

    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Training : </span><span class="si">{</span><span class="n">training_start</span><span class="si">}</span><span class="s2"> -- </span><span class="si">{</span><span class="n">training_end</span><span class="si">}</span><span class="s2"> (n=</span><span class="si">{</span><span class="n">initial_train_size</span><span class="si">}</span><span class="s2">)&quot;</span>
    <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Test     : </span><span class="si">{</span><span class="n">test_start</span><span class="si">}</span><span class="s2"> -- </span><span class="si">{</span><span class="n">test_end</span><span class="si">}</span><span class="s2"> (n=</span><span class="si">{</span><span class="n">test_length</span><span class="si">}</span><span class="s2">)&quot;</span>
    <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="skforecast.model_selection._utils.initialize_lags_grid" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">skforecast</span><span class="o">.</span><span class="n">model_selection</span><span class="o">.</span><span class="n">_utils</span><span class="o">.</span><span class="n">initialize_lags_grid</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">lags_grid</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#skforecast.model_selection._utils.initialize_lags_grid" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">

        <p>Initialize lags grid and lags label for model selection. </p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>forecaster</code></td>
            <td>
                  <code>Forecaster</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Forecaster model. ForecasterRecursive, ForecasterDirect, 
ForecasterRecursiveMultiSeries, ForecasterDirectMultiVariate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>lags_grid</code></td>
            <td>
                  <code>(list, dict)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Lists of lags to try, containing int, lists, numpy ndarray, or range 
objects. If <code>dict</code>, the keys are used as labels in the <code>results</code> 
DataFrame, and the values are used as the lists of lags to try.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>lags_grid</code></td>            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary with lags configuration for each iteration.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>lags_label</code></td>            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Label for lags representation in the results object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>skforecast\model_selection\_utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">initialize_lags_grid</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span> 
    <span class="n">lags_grid</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">dict</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize lags grid and lags label for model selection. </span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    forecaster : Forecaster</span>
<span class="sd">        Forecaster model. ForecasterRecursive, ForecasterDirect, </span>
<span class="sd">        ForecasterRecursiveMultiSeries, ForecasterDirectMultiVariate.</span>
<span class="sd">    lags_grid : list, dict, default `None`</span>
<span class="sd">        Lists of lags to try, containing int, lists, numpy ndarray, or range </span>
<span class="sd">        objects. If `dict`, the keys are used as labels in the `results` </span>
<span class="sd">        DataFrame, and the values are used as the lists of lags to try.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    lags_grid : dict</span>
<span class="sd">        Dictionary with lags configuration for each iteration.</span>
<span class="sd">    lags_label : str</span>
<span class="sd">        Label for lags representation in the results object.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lags_grid</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`lags_grid` argument must be a list, dict or None. &quot;</span>
             <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">lags_grid</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="n">lags_label</span> <span class="o">=</span> <span class="s1">&#39;values&#39;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lags_grid</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">lags_grid</span> <span class="o">=</span> <span class="p">{</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">lags</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">:</span> <span class="n">lags</span> <span class="k">for</span> <span class="n">lags</span> <span class="ow">in</span> <span class="n">lags_grid</span><span class="p">}</span>
    <span class="k">elif</span> <span class="n">lags_grid</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">lags</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">lag</span><span class="p">)</span> <span class="k">for</span> <span class="n">lag</span> <span class="ow">in</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">lags</span><span class="p">]</span>  <span class="c1"># Required since numpy 2.0</span>
        <span class="n">lags_grid</span> <span class="o">=</span> <span class="p">{</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">lags</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">:</span> <span class="n">lags</span><span class="p">}</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">lags_label</span> <span class="o">=</span> <span class="s1">&#39;keys&#39;</span>

    <span class="k">return</span> <span class="n">lags_grid</span><span class="p">,</span> <span class="n">lags_label</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="skforecast.model_selection._utils.check_backtesting_input" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">skforecast</span><span class="o">.</span><span class="n">model_selection</span><span class="o">.</span><span class="n">_utils</span><span class="o">.</span><span class="n">check_backtesting_input</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">cv</span><span class="p">,</span> <span class="n">metric</span><span class="p">,</span> <span class="n">add_aggregated_metric</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">series</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_boot</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span> <span class="n">use_in_sample_residuals</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_binned_residuals</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">suppress_warnings</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">suppress_warnings_fit</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#skforecast.model_selection._utils.check_backtesting_input" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">

        <p>This is a helper function to check most inputs of backtesting functions in 
modules <code>model_selection</code>, <code>model_selection_multiseries</code> and 
<code>model_selection_sarimax</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>forecaster</code></td>
            <td>
                  <code>Forecaster</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Forecaster model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>cv</code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="skforecast.model_selection._split.TimeSeriesFold" href="#skforecast.model_selection._split.TimeSeriesFold">TimeSeriesFold</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>TimeSeriesFold object with the information needed to split the data into folds.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>metric</code></td>
            <td>
                  <code>(str, <span title="typing.Callable">Callable</span>, list)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Metric used to quantify the goodness of fit of the model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>add_aggregated_metric</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, the aggregated metrics (average, weighted average and pooling)
over all levels are also returned (only multiseries).</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>y</code></td>
            <td>
                  <code>pandas Series</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training time series for uni-series forecasters.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>series</code></td>
            <td>
                  <code>pandas DataFrame, dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training time series for multi-series forecasters.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>exog</code></td>
            <td>
                  <code>pandas Series, pandas DataFrame, dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variables.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>interval</code></td>
            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Confidence of the prediction interval estimated. Sequence of percentiles
to compute, which must be between 0 and 100 inclusive.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>alpha</code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The confidence intervals used in ForecasterSarimax are (1 - alpha) %.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>n_boot</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of bootstrapping iterations used to estimate prediction
intervals.</p>
              </div>
            </td>
            <td>
                  <code>`250`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>random_state</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sets a seed to the random generator, so that boot intervals are always 
deterministic.</p>
              </div>
            </td>
            <td>
                  <code>`123`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>use_in_sample_residuals</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, residuals from the training data are used as proxy of prediction 
error to create prediction intervals.  If <code>False</code>, out_sample_residuals 
are used if they are already stored inside the forecaster.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>use_binned_residuals</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, residuals used in each bootstrapping iteration are selected
conditioning on the predicted values. If <code>False</code>, residuals are selected
randomly without conditioning on the predicted values.</p>
              </div>
            </td>
            <td>
                  <code>`False`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>n_jobs</code></td>
            <td>
                  <code>(int, auto)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of jobs to run in parallel. If <code>-1</code>, then the number of jobs is 
set to the number of cores. If 'auto', <code>n_jobs</code> is set using the fuction
skforecast.utils.select_n_jobs_fit_forecaster.
<strong>New in version 0.9.0</strong></p>
              </div>
            </td>
            <td>
                  <code>`&#39;auto&#39;`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>show_progress</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to show a progress bar.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>suppress_warnings</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, skforecast warnings will be suppressed during the backtesting 
process. See skforecast.exceptions.warn_skforecast_categories for more
information.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>suppress_warnings_fit</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, warnings generated during fitting will be ignored. Only 
<code>ForecasterSarimax</code>.</p>
              </div>
            </td>
            <td>
                  <code>`False`</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>skforecast\model_selection\_utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">check_backtesting_input</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
    <span class="n">cv</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="nb">list</span><span class="p">],</span>
    <span class="n">add_aggregated_metric</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">series</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">interval</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">alpha</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">n_boot</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span>
    <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
    <span class="n">use_in_sample_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">use_binned_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
    <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">suppress_warnings</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">suppress_warnings_fit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This is a helper function to check most inputs of backtesting functions in </span>
<span class="sd">    modules `model_selection`, `model_selection_multiseries` and </span>
<span class="sd">    `model_selection_sarimax`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    forecaster : Forecaster</span>
<span class="sd">        Forecaster model.</span>
<span class="sd">    cv : TimeSeriesFold</span>
<span class="sd">        TimeSeriesFold object with the information needed to split the data into folds.</span>
<span class="sd">    metric : str, Callable, list</span>
<span class="sd">        Metric used to quantify the goodness of fit of the model.</span>
<span class="sd">    add_aggregated_metric : bool, default `True`</span>
<span class="sd">        If `True`, the aggregated metrics (average, weighted average and pooling)</span>
<span class="sd">        over all levels are also returned (only multiseries).</span>
<span class="sd">    y : pandas Series, default `None`</span>
<span class="sd">        Training time series for uni-series forecasters.</span>
<span class="sd">    series : pandas DataFrame, dict, default `None`</span>
<span class="sd">        Training time series for multi-series forecasters.</span>
<span class="sd">    exog : pandas Series, pandas DataFrame, dict, default `None`</span>
<span class="sd">        Exogenous variables.</span>
<span class="sd">    interval : list, default `None`</span>
<span class="sd">        Confidence of the prediction interval estimated. Sequence of percentiles</span>
<span class="sd">        to compute, which must be between 0 and 100 inclusive.</span>
<span class="sd">    alpha : float, default `None`</span>
<span class="sd">        The confidence intervals used in ForecasterSarimax are (1 - alpha) %. </span>
<span class="sd">    n_boot : int, default `250`</span>
<span class="sd">        Number of bootstrapping iterations used to estimate prediction</span>
<span class="sd">        intervals.</span>
<span class="sd">    random_state : int, default `123`</span>
<span class="sd">        Sets a seed to the random generator, so that boot intervals are always </span>
<span class="sd">        deterministic.</span>
<span class="sd">    use_in_sample_residuals : bool, default `True`</span>
<span class="sd">        If `True`, residuals from the training data are used as proxy of prediction </span>
<span class="sd">        error to create prediction intervals.  If `False`, out_sample_residuals </span>
<span class="sd">        are used if they are already stored inside the forecaster.</span>
<span class="sd">    use_binned_residuals : bool, default `False`</span>
<span class="sd">        If `True`, residuals used in each bootstrapping iteration are selected</span>
<span class="sd">        conditioning on the predicted values. If `False`, residuals are selected</span>
<span class="sd">        randomly without conditioning on the predicted values.</span>
<span class="sd">    n_jobs : int, &#39;auto&#39;, default `&#39;auto&#39;`</span>
<span class="sd">        The number of jobs to run in parallel. If `-1`, then the number of jobs is </span>
<span class="sd">        set to the number of cores. If &#39;auto&#39;, `n_jobs` is set using the fuction</span>
<span class="sd">        skforecast.utils.select_n_jobs_fit_forecaster.</span>
<span class="sd">        **New in version 0.9.0**</span>
<span class="sd">    show_progress : bool, default `True`</span>
<span class="sd">        Whether to show a progress bar.</span>
<span class="sd">    suppress_warnings: bool, default `False`</span>
<span class="sd">        If `True`, skforecast warnings will be suppressed during the backtesting </span>
<span class="sd">        process. See skforecast.exceptions.warn_skforecast_categories for more</span>
<span class="sd">        information.</span>
<span class="sd">    suppress_warnings_fit : bool, default `False`</span>
<span class="sd">        If `True`, warnings generated during fitting will be ignored. Only </span>
<span class="sd">        `ForecasterSarimax`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">forecaster_name</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">forecaster</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>
    <span class="n">cv_name</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">cv</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>

    <span class="k">if</span> <span class="n">cv_name</span> <span class="o">!=</span> <span class="s2">&quot;TimeSeriesFold&quot;</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`cv` must be a TimeSeriesFold object. Got </span><span class="si">{</span><span class="n">cv_name</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="n">steps</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">steps</span>
    <span class="n">initial_train_size</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">initial_train_size</span>
    <span class="n">gap</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">gap</span>
    <span class="n">allow_incomplete_fold</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">allow_incomplete_fold</span>
    <span class="n">refit</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">refit</span>

    <span class="n">forecasters_uni</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;ForecasterRecursive&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ForecasterDirect&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ForecasterSarimax&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ForecasterEquivalentDate&quot;</span><span class="p">,</span>
    <span class="p">]</span>
    <span class="n">forecasters_multi</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;ForecasterDirectMultiVariate&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ForecasterRnn&quot;</span><span class="p">,</span>
    <span class="p">]</span>
    <span class="n">forecasters_multi_dict</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;ForecasterRecursiveMultiSeries&quot;</span>
    <span class="p">]</span>

    <span class="k">if</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="n">forecasters_uni</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;`y` must be a pandas Series.&quot;</span><span class="p">)</span>
        <span class="n">data_name</span> <span class="o">=</span> <span class="s1">&#39;y&#39;</span>
        <span class="n">data_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="n">forecasters_multi</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;`series` must be a pandas DataFrame.&quot;</span><span class="p">)</span>
        <span class="n">data_name</span> <span class="o">=</span> <span class="s1">&#39;series&#39;</span>
        <span class="n">data_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">series</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="n">forecasters_multi_dict</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`series` must be a pandas DataFrame or a dict of DataFrames or Series. &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">series</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="n">data_name</span> <span class="o">=</span> <span class="s1">&#39;series&#39;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">not_valid_series</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">k</span> 
                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">series</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">))</span>
            <span class="p">]</span>
            <span class="k">if</span> <span class="n">not_valid_series</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;If `series` is a dictionary, all series must be a named &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;pandas Series or a pandas DataFrame with a single column. &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;Review series: </span><span class="si">{</span><span class="n">not_valid_series</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="n">not_valid_index</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">k</span> 
                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">series</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="k">if</span> <span class="n">not_valid_index</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;If `series` is a dictionary, all series must have a Pandas &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;DatetimeIndex as index with the same frequency. &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;Review series: </span><span class="si">{</span><span class="n">not_valid_index</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="p">)</span>

            <span class="n">indexes_freq</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">v</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">freq</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">series</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
            <span class="n">indexes_freq</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">indexes_freq</span><span class="p">))</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">indexes_freq</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;If `series` is a dictionary, all series must have a Pandas &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;DatetimeIndex as index with the same frequency. &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;Found frequencies: </span><span class="si">{</span><span class="n">indexes_freq</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="n">data_length</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">series</span><span class="p">[</span><span class="n">serie</span><span class="p">])</span> <span class="k">for</span> <span class="n">serie</span> <span class="ow">in</span> <span class="n">series</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">series</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="n">forecasters_multi_dict</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`exog` must be a pandas Series, DataFrame, dictionary of pandas &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;Series/DataFrames or None. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="n">not_valid_exog</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">k</span> 
                    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">exog</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)))</span>
                <span class="p">]</span>
                <span class="k">if</span> <span class="n">not_valid_exog</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                        <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;If `exog` is a dictionary, All exog must be a named pandas &quot;</span>
                         <span class="sa">f</span><span class="s2">&quot;Series, a pandas DataFrame or None. Review exog: </span><span class="si">{</span><span class="n">not_valid_exog</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`exog` must be a pandas Series, DataFrame or None. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
                <span class="p">)</span>

    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="s1">&#39;differentiation&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">differentiation</span> <span class="o">!=</span> <span class="n">cv</span><span class="o">.</span><span class="n">differentiation</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The differentiation included in the forecaster &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">forecaster</span><span class="o">.</span><span class="n">differentiation</span><span class="si">}</span><span class="s2">) differs from the differentiation &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;included in the cv (</span><span class="si">{</span><span class="n">cv</span><span class="o">.</span><span class="n">differentiation</span><span class="si">}</span><span class="s2">). Set the same value &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;for both.&quot;</span><span class="p">)</span>
            <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">metric</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`metric` must be a string, a callable function, or a list containing &quot;</span>
             <span class="sa">f</span><span class="s2">&quot;multiple strings and/or callables. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">metric</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">forecaster_name</span> <span class="o">==</span> <span class="s2">&quot;ForecasterEquivalentDate&quot;</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span>
        <span class="n">forecaster</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">tseries</span><span class="o">.</span><span class="n">offsets</span><span class="o">.</span><span class="n">DateOffset</span>
    <span class="p">):</span>
        <span class="k">if</span> <span class="n">initial_train_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`initial_train_size` must be an integer greater than &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;the `window_size` of the forecaster (</span><span class="si">{</span><span class="n">forecaster</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2">) &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;and smaller than the length of `</span><span class="si">{</span><span class="n">data_name</span><span class="si">}</span><span class="s2">` (</span><span class="si">{</span><span class="n">data_length</span><span class="si">}</span><span class="s2">).&quot;</span><span class="p">)</span>
            <span class="p">)</span>
    <span class="k">elif</span> <span class="n">initial_train_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">initial_train_size</span> <span class="o">&lt;</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">window_size</span> <span class="ow">or</span> <span class="n">initial_train_size</span> <span class="o">&gt;=</span> <span class="n">data_length</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;If used, `initial_train_size` must be an integer greater than &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;the `window_size` of the forecaster (</span><span class="si">{</span><span class="n">forecaster</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2">) &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;and smaller than the length of `</span><span class="si">{</span><span class="n">data_name</span><span class="si">}</span><span class="s2">` (</span><span class="si">{</span><span class="n">data_length</span><span class="si">}</span><span class="s2">).&quot;</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">initial_train_size</span> <span class="o">+</span> <span class="n">gap</span> <span class="o">&gt;=</span> <span class="n">data_length</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The combination of initial_train_size </span><span class="si">{</span><span class="n">initial_train_size</span><span class="si">}</span><span class="s2"> and &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;gap </span><span class="si">{</span><span class="n">gap</span><span class="si">}</span><span class="s2"> cannot be greater than the length of `</span><span class="si">{</span><span class="n">data_name</span><span class="si">}</span><span class="s2">` &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">data_length</span><span class="si">}</span><span class="s2">).&quot;</span><span class="p">)</span>
            <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ForecasterSarimax&#39;</span><span class="p">,</span> <span class="s1">&#39;ForecasterEquivalentDate&#39;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`initial_train_size` must be an integer smaller than the &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;length of `</span><span class="si">{</span><span class="n">data_name</span><span class="si">}</span><span class="s2">` (</span><span class="si">{</span><span class="n">data_length</span><span class="si">}</span><span class="s2">).&quot;</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">is_fitted</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">NotFittedError</span><span class="p">(</span>
                    <span class="p">(</span><span class="s2">&quot;`forecaster` must be already trained if no `initial_train_size` &quot;</span>
                     <span class="s2">&quot;is provided.&quot;</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="n">refit</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;`refit` is only allowed when `initial_train_size` is not `None`.&quot;</span>
                <span class="p">)</span>

    <span class="k">if</span> <span class="n">forecaster_name</span> <span class="o">==</span> <span class="s1">&#39;ForecasterSarimax&#39;</span> <span class="ow">and</span> <span class="n">cv</span><span class="o">.</span><span class="n">skip_folds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;`skip_folds` is not allowed for ForecasterSarimax. Set it to `None`.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">add_aggregated_metric</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;`add_aggregated_metric` must be a boolean: `True`, `False`.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n_boot</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">))</span> <span class="ow">or</span> <span class="n">n_boot</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`n_boot` must be an integer greater than 0. Got </span><span class="si">{</span><span class="n">n_boot</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">random_state</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">))</span> <span class="ow">or</span> <span class="n">random_state</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`random_state` must be an integer greater than 0. Got </span><span class="si">{</span><span class="n">random_state</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">use_in_sample_residuals</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;`use_in_sample_residuals` must be a boolean: `True`, `False`.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">use_binned_residuals</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;`use_binned_residuals` must be a boolean: `True`, `False`.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n_jobs</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="n">n_jobs</span> <span class="o">!=</span> <span class="s1">&#39;auto&#39;</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`n_jobs` must be an integer or `&#39;auto&#39;`. Got </span><span class="si">{</span><span class="n">n_jobs</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">show_progress</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;`show_progress` must be a boolean: `True`, `False`.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">suppress_warnings</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;`suppress_warnings` must be a boolean: `True`, `False`.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">suppress_warnings_fit</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;`suppress_warnings_fit` must be a boolean: `True`, `False`.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">interval</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">alpha</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">check_interval</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="n">interval</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">allow_incomplete_fold</span> <span class="ow">and</span> <span class="n">data_length</span> <span class="o">-</span> <span class="p">(</span><span class="n">initial_train_size</span> <span class="o">+</span> <span class="n">gap</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">steps</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;There is not enough data to evaluate </span><span class="si">{</span><span class="n">steps</span><span class="si">}</span><span class="s2"> steps in a single &quot;</span>
             <span class="sa">f</span><span class="s2">&quot;fold. Set `allow_incomplete_fold` to `True` to allow incomplete folds.</span><span class="se">\n</span><span class="s2">&quot;</span>
             <span class="sa">f</span><span class="s2">&quot;    Data available for test : </span><span class="si">{</span><span class="n">data_length</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">initial_train_size</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gap</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
             <span class="sa">f</span><span class="s2">&quot;    Steps                   : </span><span class="si">{</span><span class="n">steps</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="skforecast.model_selection._utils.select_n_jobs_backtesting" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">skforecast</span><span class="o">.</span><span class="n">model_selection</span><span class="o">.</span><span class="n">_utils</span><span class="o">.</span><span class="n">select_n_jobs_backtesting</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">refit</span><span class="p">)</span></code>

<a href="#skforecast.model_selection._utils.select_n_jobs_backtesting" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">

        <p>Select the optimal number of jobs to use in the backtesting process. This
selection is based on heuristics and is not guaranteed to be optimal.</p>
<p>The number of jobs is chosen as follows:</p>
<ul>
<li>If <code>refit</code> is an integer, then <code>n_jobs = 1</code>. This is because parallelization doesn't 
work with intermittent refit.</li>
<li>If forecaster is 'ForecasterRecursive' and regressor is a linear regressor, 
then <code>n_jobs = 1</code>.</li>
<li>If forecaster is 'ForecasterRecursive' and regressor is not a linear 
regressor and <code>refit = True</code>, then <code>n_jobs = cpu_count() - 1</code>.</li>
<li>If forecaster is 'ForecasterRecursive' and regressor is not a linear 
regressor and <code>refit = False</code>, then <code>n_jobs = 1</code>.</li>
<li>If forecaster is 'ForecasterDirect' or 'ForecasterDirectMultiVariate'
and <code>refit = True</code>, then <code>n_jobs = cpu_count() - 1</code>.</li>
<li>If forecaster is 'ForecasterDirect' or 'ForecasterDirectMultiVariate'
and <code>refit = False</code>, then <code>n_jobs = 1</code>.</li>
<li>If forecaster is 'ForecasterRecursiveMultiSeries', then <code>n_jobs = cpu_count() - 1</code>.</li>
<li>If forecaster is 'ForecasterSarimax' or 'ForecasterEquivalentDate', 
then <code>n_jobs = 1</code>.</li>
<li>If regressor is a <code>LGBMRegressor</code>, then <code>n_jobs = 1</code>. This is because <code>lightgbm</code> 
is highly optimized for gradient boosting and parallelizes operations at a very 
fine-grained level, making additional parallelization unnecessary and 
potentially harmful due to resource contention.</li>
</ul>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>forecaster</code></td>
            <td>
                  <code>Forecaster</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Forecaster model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>refit</code></td>
            <td>
                  <code>(bool, int)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the forecaster is refitted during the backtesting process.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>n_jobs</code></td>            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of jobs to run in parallel.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>skforecast\model_selection\_utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">select_n_jobs_backtesting</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
    <span class="n">refit</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Select the optimal number of jobs to use in the backtesting process. This</span>
<span class="sd">    selection is based on heuristics and is not guaranteed to be optimal.</span>

<span class="sd">    The number of jobs is chosen as follows:</span>

<span class="sd">    - If `refit` is an integer, then `n_jobs = 1`. This is because parallelization doesn&#39;t </span>
<span class="sd">    work with intermittent refit.</span>
<span class="sd">    - If forecaster is &#39;ForecasterRecursive&#39; and regressor is a linear regressor, </span>
<span class="sd">    then `n_jobs = 1`.</span>
<span class="sd">    - If forecaster is &#39;ForecasterRecursive&#39; and regressor is not a linear </span>
<span class="sd">    regressor and `refit = True`, then `n_jobs = cpu_count() - 1`.</span>
<span class="sd">    - If forecaster is &#39;ForecasterRecursive&#39; and regressor is not a linear </span>
<span class="sd">    regressor and `refit = False`, then `n_jobs = 1`.</span>
<span class="sd">    - If forecaster is &#39;ForecasterDirect&#39; or &#39;ForecasterDirectMultiVariate&#39;</span>
<span class="sd">    and `refit = True`, then `n_jobs = cpu_count() - 1`.</span>
<span class="sd">    - If forecaster is &#39;ForecasterDirect&#39; or &#39;ForecasterDirectMultiVariate&#39;</span>
<span class="sd">    and `refit = False`, then `n_jobs = 1`.</span>
<span class="sd">    - If forecaster is &#39;ForecasterRecursiveMultiSeries&#39;, then `n_jobs = cpu_count() - 1`.</span>
<span class="sd">    - If forecaster is &#39;ForecasterSarimax&#39; or &#39;ForecasterEquivalentDate&#39;, </span>
<span class="sd">    then `n_jobs = 1`.</span>
<span class="sd">    - If regressor is a `LGBMRegressor`, then `n_jobs = 1`. This is because `lightgbm` </span>
<span class="sd">    is highly optimized for gradient boosting and parallelizes operations at a very </span>
<span class="sd">    fine-grained level, making additional parallelization unnecessary and </span>
<span class="sd">    potentially harmful due to resource contention.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    forecaster : Forecaster</span>
<span class="sd">        Forecaster model.</span>
<span class="sd">    refit : bool, int</span>
<span class="sd">        If the forecaster is refitted during the backtesting process.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    n_jobs : int</span>
<span class="sd">        The number of jobs to run in parallel.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">forecaster_name</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">forecaster</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">forecaster</span><span class="o">.</span><span class="n">regressor</span><span class="p">,</span> <span class="n">Pipeline</span><span class="p">):</span>
        <span class="n">regressor_name</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">forecaster</span><span class="o">.</span><span class="n">regressor</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="vm">__name__</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">regressor_name</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">forecaster</span><span class="o">.</span><span class="n">regressor</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>

    <span class="n">linear_regressors</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">regressor_name</span>
        <span class="k">for</span> <span class="n">regressor_name</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">sklearn</span><span class="o">.</span><span class="n">linear_model</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">regressor_name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
    <span class="p">]</span>

    <span class="n">refit</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="n">refit</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">refit</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">refit</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="ow">and</span> <span class="n">refit</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">n_jobs</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ForecasterRecursive&#39;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">regressor_name</span> <span class="ow">in</span> <span class="n">linear_regressors</span> <span class="ow">or</span> <span class="n">regressor_name</span> <span class="o">==</span> <span class="s1">&#39;LGBMRegressor&#39;</span><span class="p">:</span>
                <span class="n">n_jobs</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">n_jobs</span> <span class="o">=</span> <span class="n">cpu_count</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">refit</span> <span class="k">else</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ForecasterDirect&#39;</span><span class="p">,</span> <span class="s1">&#39;ForecasterDirectMultiVariate&#39;</span><span class="p">]:</span>
            <span class="n">n_jobs</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ForecasterRecursiveMultiSeries&#39;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">regressor_name</span> <span class="o">==</span> <span class="s1">&#39;LGBMRegressor&#39;</span><span class="p">:</span>
                <span class="n">n_jobs</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">n_jobs</span> <span class="o">=</span> <span class="n">cpu_count</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ForecasterSarimax&#39;</span><span class="p">,</span> <span class="s1">&#39;ForecasterEquivalentDate&#39;</span><span class="p">]:</span>
            <span class="n">n_jobs</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">n_jobs</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">n_jobs</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>









  




                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2021 - 2024 Joaqun Amat Rodrigo, Javier Escobar Ortiz
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/company/skforecast/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            

  
    
  


  
    
  



  


<h4>Cookie consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
      
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="analytics" checked>
          <span class="task-list-indicator"></span>
          Google Analytics
        </label>
      </li>
    
      
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="github" checked>
          <span class="task-list-indicator"></span>
          GitHub
        </label>
      </li>
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.top", "toc.integrate", "navigation.breadcrumbs"], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.525ec568.min.js"></script>
      
    
  </body>
</html>